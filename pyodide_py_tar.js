pyodide_py_tar=Uint8Array.from(atob('cHlvZGlkZS8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA3NTUAMDAwMDAwMAAwMDAwMDAwADAwMDAwMDAwMDAwADE0MjA1MTY2NzUwADAxMTIxNwAgNQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABweW9kaWRlL19faW5pdF9fLnB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDAwMDY0NAAwMDAwMDAwADAwMDAwMDAAMDAwMDAwMDI3NTMAMTQyMDUxNjY3NTAAMDEzMzM3ACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMgV2hlbiB0aGUgcHlvZGlkZSBwYWNrYWdlIGlzIGltcG9ydGVkLCBib3RoIHRoZSBqcyBhbmQgdGhlIHB5b2RpZGVfanMgbW9kdWxlcwojIHdpbGwgYmUgYXZhaWxhYmxlIHRvIGltcG9ydCBmcm9tLiBOb3QgYWxsIGZ1bmN0aW9ucyBpbiBweW9kaWRlX2pzIHdpbGwgd29yawojIHVudGlsIGFmdGVyIHB5b2RpZGUgaXMgZmlyc3QgaW1wb3J0ZWQsIGltcG9ydGVkIGZ1bmN0aW9ucyBmcm9tIHB5b2RpZGVfanMKIyBzaG91bGQgbm90IGJlIHVzZWQgYXQgaW1wb3J0IHRpbWUuIEl0IGlzIGZpbmUgdG8gdXNlIGpzIGZ1bmN0aW9ucyBhdCBpbXBvcnQKIyB0aW1lLgojCiMgQWxsIHB1cmUgUHl0aG9uIGNvZGUgdGhhdCBkb2VzIG5vdCByZXF1aXJlIGpzIG9yIHB5b2RpZGVfanMgc2hvdWxkIGdvIGluCiMgdGhlIF9weW9kaWRlIHBhY2thZ2UuCiMKIyBUaGlzIHBhY2thZ2UgaXMgaW1wb3J0ZWQgYnkgdGhlIHRlc3Qgc3VpdGUgYXMgd2VsbCwgYW5kIGN1cnJlbnRseSB3ZSBkb24ndCB1c2UKIyBweXRlc3QgbW9ja3MgZm9yIGpzIG9yIHB5b2RpZGVfanMsIHNvIG1ha2Ugc3VyZSB0byB0ZXN0ICJpZiBJTl9CUk9XU0VSIiBiZWZvcmUKIyBpbXBvcnRpbmcgZnJvbSB0aGVzZS4KCmZyb20gLl9jb3JlIGltcG9ydCAoCiAgICBKc1Byb3h5LAogICAgSnNFeGNlcHRpb24sCiAgICBjcmVhdGVfb25jZV9jYWxsYWJsZSwKICAgIGNyZWF0ZV9wcm94eSwKICAgIHRvX2pzLAogICAgSU5fQlJPV1NFUiwKICAgIENvbnZlcnNpb25FcnJvciwKICAgIGRlc3Ryb3lfcHJveGllcywKKQpmcm9tIF9weW9kaWRlLl9iYXNlIGltcG9ydCAoCiAgICBldmFsX2NvZGUsCiAgICBldmFsX2NvZGVfYXN5bmMsCiAgICBmaW5kX2ltcG9ydHMsCiAgICBDb2RlUnVubmVyLAogICAgc2hvdWxkX3F1aWV0LAopCmZyb20gLmh0dHAgaW1wb3J0IG9wZW5fdXJsCmZyb20gLiBpbXBvcnQgX3N0YXRlICAjIG5vcWEKCmZyb20gX3B5b2RpZGUuX2ltcG9ydGhvb2sgaW1wb3J0IHJlZ2lzdGVyX2pzX21vZHVsZSwgdW5yZWdpc3Rlcl9qc19tb2R1bGUKCmlmIElOX0JST1dTRVI6CiAgICBpbXBvcnQgYXN5bmNpbwogICAgZnJvbSAud2VibG9vcCBpbXBvcnQgV2ViTG9vcFBvbGljeQoKICAgIGFzeW5jaW8uc2V0X2V2ZW50X2xvb3BfcG9saWN5KFdlYkxvb3BQb2xpY3koKSkKCgpfX3ZlcnNpb25fXyA9ICIwLjE5LjEiCgpfX2FsbF9fID0gWwogICAgIm9wZW5fdXJsIiwKICAgICJldmFsX2NvZGUiLAogICAgImV2YWxfY29kZV9hc3luYyIsCiAgICAiQ29kZVJ1bm5lciIsCiAgICAiZmluZF9pbXBvcnRzIiwKICAgICJKc1Byb3h5IiwKICAgICJKc0V4Y2VwdGlvbiIsCiAgICAidG9fanMiLAogICAgInJlZ2lzdGVyX2pzX21vZHVsZSIsCiAgICAidW5yZWdpc3Rlcl9qc19tb2R1bGUiLAogICAgImNyZWF0ZV9vbmNlX2NhbGxhYmxlIiwKICAgICJjcmVhdGVfcHJveHkiLAogICAgImNvbnNvbGUiLAogICAgInNob3VsZF9xdWlldCIsCiAgICAiQ29udmVyc2lvbkVycm9yIiwKICAgICJkZXN0cm95X3Byb3hpZXMiLApdCgAAAAAAAAAAAAAAAAAAAAAAAAAAAHB5b2RpZGUvX2NvcmUucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNjQ0ADAwMDAwMDAAMDAwMDAwMAAwMDAwMDAwMTE2MwAxNDIw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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaW1wb3J0IF9fbWFpbl9fCmltcG9ydCBzeXMKaW1wb3J0IGdjCgpmcm9tIC5fY29yZSBpbXBvcnQgSnNQcm94eQpmcm9tIF9weW9kaWRlLl9pbXBvcnRob29rIGltcG9ydCBqc2ZpbmRlcgoKCmRlZiBzYXZlX3N0YXRlKCkgLT4gZGljdDoKICAgICIiIlJlY29yZCB0aGUgY3VycmVudCBnbG9iYWwgc3RhdGUuCgogICAgVGhpcyBpbmNsdWRlcyB3aGljaCBKYXZhU2NyaXB0IHBhY2thZ2VzIGFyZSBsb2FkZWQgYW5kIHRoZSBnbG9iYWwgc2NvcGUgaW4KICAgIGBgX19tYWluX18uX19kaWN0X19gYC4gTWFueSBsb2FkZWQgbW9kdWxlcyBtaWdodCBoYXZlIGdsb2JhbCBzdGF0ZSwgYnV0CiAgICB0aGVyZSBpcyBubyBnZW5lcmFsIHdheSB0byB0cmFjayBpdCBhbmQgd2UgZG9uJ3QgdHJ5IHRvLgogICAgIiIiCiAgICBsb2FkZWRfanNfbW9kdWxlcyA9IHt9CiAgICBmb3IgW2tleSwgdmFsdWVdIGluIHN5cy5tb2R1bGVzLml0ZW1zKCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgSnNQcm94eSk6CiAgICAgICAgICAgIGxvYWRlZF9qc19tb2R1bGVzW2tleV0gPSB2YWx1ZQoKICAgIHJldHVybiBkaWN0KAogICAgICAgIGdsb2JhbHM9ZGljdChfX21haW5fXy5fX2RpY3RfXyksCiAgICAgICAganNfbW9kdWxlcz1kaWN0KGpzZmluZGVyLmpzcHJveGllcyksCiAgICAgICAgbG9hZGVkX2pzX21vZHVsZXM9bG9hZGVkX2pzX21vZHVsZXMsCiAgICApCgoKZGVmIHJlc3RvcmVfc3RhdGUoc3RhdGU6IGRpY3QpOgogICAgIiIiUmVzdG9yZSB0aGUgZ2xvYmFsIHN0YXRlIHRvIGEgc25hcHNob3QuIFRo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IG9mIDphbnk6YENvbnNvbGVgIHRoYXQgdXNlcyA6YW55OmBweW9kaWRlLmxvYWRQYWNrYWdlc0Zyb21JbXBvcnRzYCBiZWZvcmUgcnVubmluZyB0aGUgY29kZS4iIiIKCiAgICBhc3luYyBkZWYgcnVuY29kZShzZWxmLCBzb3VyY2U6IHN0ciwgY29kZTogQ29kZVJ1bm5lcikgLT4gQ29uc29sZUZ1dHVyZToKICAgICAgICAiIiJFeGVjdXRlIGEgY29kZSBvYmplY3QuCgogICAgICAgIEFsbCBleGNlcHRpb25zIGFyZSBjYXVnaHQgZXhjZXB0IFN5c3RlbUV4aXQsIHdoaWNoIGlzIHJlcmFpc2VkLgoKICAgICAgICBSZXR1cm5zCiAgICAgICAgLS0tLS0tLQogICAgICAgICAgICBUaGUgcmV0dXJuIHZhbHVlIGlzIGEgZGVwZW5kZW50IHN1bSB0eXBlIHdpdGggdGhlIGZvbGxvd2luZyBwb3NzaWJpbGl0aWVzOgogICAgICAgICAgICAqIGAoInN1Y2Nlc3MiLCByZXN1bHQgOiBBbnkpYCAtLSB0aGUgY29kZSBleGVjdXRlZCBzdWNjZXNzZnVsbHkKICAgICAgICAgICAgKiBgKCJleGNlcHRpb24iLCBtZXNzYWdlIDogc3RyKWAgLS0gQW4gZXhjZXB0aW9uIG9jY3VycmVkLiBgbWVzc2FnZWAgaXMgdGhlCiAgICAgICAgICAgIHJlc3VsdCBvZiBjYWxsaW5nIDphbnk6YENvbnNvbGUuZm9ybWF0dHJhY2ViYWNrYC4KICAgICAgICAiIiIKICAgICAgICBmcm9tIHB5b2RpZGVfanMgaW1wb3J0IGxvYWRQYWNrYWdlc0Zyb21JbXBvcnRzCgogICAgICAgIGF3YWl0IGxvYWRQYWNrYWdlc0Zyb21JbXBvcnRzKHNvdXJjZSkKICAgICAgICByZXR1cm4gYXdhaXQgc3VwZXIoKS5ydW5jb2RlKHNvdXJjZSwgY29kZSkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHB5b2RpZGUvaHR0cC5weQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNjQ0ADAwMDAwMDAAMDAwMDAwMAAwMDAwMDAxNjA1NgAxNDIwNTE2Njc1MAAwMTI1NjAAIDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdXN0YXIgIAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KZnJvbSAuX2NvcmUgaW1wb3J0IEpzUHJveHksIHRvX2pzCmZyb20gdHlwaW5nIGltcG9ydCBBbnkKaW1wb3J0IGpzb24KZnJvbSBpbyBpbXBvcnQgSU9CYXNlCgp0cnk6CiAgICBmcm9tIGpzIGltcG9ydCBYTUxIdHRwUmVxdWVzdApleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBwYXNzCgpmcm9tIC5fY29yZSBpbXBvcnQgSU5fQlJPV1NFUgpmcm9tIC5fdXRpbCBpbXBvcnQgdW5wYWNrX2J1ZmZlcl9hcmNoaXZlCgpfX2FsbF9fID0gWwogICAgIm9wZW5fdXJsIiwKICAgICJweWZldGNoIiwKICAgICJGZXRjaFJlc3BvbnNlIiwKXQoKCmRlZiBvcGVuX3VybCh1cmw6IHN0cikgLT4gU3RyaW5nSU86CiAgICAiIiJGZXRjaGVzIGEgZ2l2ZW4gVVJMIHN5bmNocm9ub3VzbHkuCgogICAgVGhlIGRvd25sb2FkIG9mIGJpbmFyeSBmaWxlcyBpcyBub3Qgc3VwcG9ydGVkLiBUbyBkb3dubG9hZCBiaW5hcnkKICAgIGZpbGVzIHVzZSA6ZnVuYzpgcHlvZGlkZS5odHRwLnB5ZmV0Y2hgIHdoaWNoIGlzIGFzeW5jaHJvbm91cy4KCiAgICBQYXJhbWV0ZXJzCiAgICAtLS0tLS0tLS0tCiAgICB1cmwgOiBzdHIKICAgICAgIFVSTCB0byBmZXRjaAoKICAgIFJldHVybnMKICAgIC0tLS0tLS0KICAgIGlvLlN0cmluZ0lPCiAgICAgICAgdGhlIGNvbnRlbnRzIG9mIHRoZSBVUkwuCiAgICAiIiIKCiAgICByZXEgPSBYTUxIdHRwUmVxdWVzdC5uZXcoKQogICAgcmVxLm9wZW4oIkdFVCIsIHVybCwgRmFsc2UpCiAgICByZXEuc2VuZChOb25lKQogICAgcmV0dXJuIFN0cmluZ0lPKHJlcS5yZXNwb25zZSkKCgpjbGFzcyBGZXRjaFJlc3BvbnNlOgogICAgIiIiQSB3cmFwcGVyIGZvciBhIEphdmFzY3JpcHQgZmV0Y2ggcmVzcG9uc2UuCgogICAgU2VlIGFsc28gdGhlIEphdmFzY3JpcHQgZmV0Y2gKICAgIGBSZXNwb25zZSA8aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1Jlc3BvbnNlPmBfIGFwaQogICAgZG9jcy4KCiAgICBQYXJhbWV0ZXJzCiAgICAtLS0tLS0tLS0tCiAgICB1cmwKICAgICAgICBVUkwgdG8gZmV0Y2gKICAgIGpzX3Jlc3BvbnNlCiAgICAgICAgQSBKc1Byb3h5IG9mIHRoZSBmZXRjaCByZXNwb25zZQogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHVybDogc3RyLCBqc19yZXNwb25zZTogSnNQcm94eSk6CiAgICAgICAgc2VsZi5fdXJsID0gdXJsCiAgICAgICAgc2VsZi5qc19yZXNwb25zZSA9IGpzX3Jlc3BvbnNlCgogICAgQHByb3BlcnR5CiAgICBkZWYgYm9keV91c2VkKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIiIiSGFzIHRoZSByZXNwb25zZSBiZWVuIHVzZWQgeWV0PwoKICAgICAgICAoSWYgc28sIGF0dGVtcHRpbmcgdG8gcmV0cmVpdmUgdGhlIGJvZHkgYWdhaW4gd2lsbCByYWlzZSBhbiBPU0Vycm9yLikKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZi5qc19yZXNwb25zZS5ib2R5VXNlZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIG9rKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIiIiV2FzIHRoZSByZXF1ZXN0IHN1Y2Nlc3NmdWw/IiIiCiAgICAgICAgcmV0dXJuIHNlbGYuanNfcmVzcG9uc2Uub2sKCiAgICBAcHJvcGVydHkKICAgIGRlZiByZWRpcmVjdGVkKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIiIiV2FzIHRoZSByZXF1ZXN0IHJlZGlyZWN0ZWQ/IiIiCiAgICAgICAgcmV0dXJuIHNlbGYuanNfcmVzcG9uc2UucmVkaXJlY3RlZAoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHN0YXR1cyhzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiUmVzcG9uc2Ugc3RhdHVzIGNvZGUiIiIKICAgICAgICByZXR1cm4gc2VsZi5qc19yZXNwb25zZS5zdGF0dXMKCiAgICBAcHJvcGVydHkKICAgIGRlZiBzdGF0dXNfdGV4dChzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiUmVzcG9uc2Ugc3RhdHVzIHRleHQiIiIKICAgICAgICByZXR1cm4gc2VsZi5qc19yZXNwb25zZS5zdGF0dXNUZXh0CgogICAgQHByb3BlcnR5CiAgICBkZWYgdHlwZShzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiVGhlIGB0eXBlIDxodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUmVzcG9uc2UvdHlwZT5gXyBvZiB0aGUgcmVzcG9uc2UuIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuanNfcmVzcG9uc2UudHlwZQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHVybChzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiVGhlIGB1cmwgPGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9SZXNwb25zZS91cmw+YF8gb2YgdGhlIHJlc3BvbnNlLgoKICAgICAgICBJdCBtYXkgYmUgZGlmZmVyZW50IHRoYW4gdGhlIHVybCBwYXNzZWQgdG8gZmV0Y2guCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuanNfcmVzcG9uc2UudXJsCgogICAgZGVmIF9yYWlzZV9pZl9mYWlsZWQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5qc19yZXNwb25zZS5zdGF0dXMgPj0gNDAwOgogICAgICAgICAgICByYWlzZSBPU0Vycm9yKAogICAgICAgICAgICAgICAgZiJSZXF1ZXN0IGZvciB7c2VsZi5fdXJsfSBmYWlsZWQgd2l0aCBzdGF0dXMge3NlbGYuc3RhdHVzfToge3NlbGYuc3RhdHVzX3RleHR9IgogICAgICAgICAgICApCiAgICAgICAgaWYgc2VsZi5qc19yZXNwb25zZS5ib2R5VXNlZDoKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigiUmVzcG9uc2UgYm9keSBpcyBhbHJlYWR5IHVzZWQiKQoKICAgIGRlZiBjbG9uZShzZWxmKSAtPiAiRmV0Y2hSZXNwb25zZSI6CiAgICAgICAgIiIiUmV0dXJuIGFuIGlkZW50aWNhbCBjb3B5IG9mIHRoZSBGZXRjaFJlc3BvbnNlLgoKICAgICAgICBUaGlzIG1ldGhvZCBleGlzdHMgdG8gYWxsb3cgbXVsdGlwbGUgdXNlcyBvZiByZXNwb25zZSBvYmplY3RzLiBTZWUKICAgICAgICBgUmVzcG9uc2UuY2xvbmUgPGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9SZXNwb25zZS9jbG9uZT5gXwogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuanNfcmVzcG9uc2UuYm9keVVzZWQ6CiAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoIlJlc3BvbnNlIGJvZHkgaXMgYWxyZWFkeSB1c2VkIikKICAgICAgICByZXR1cm4gRmV0Y2hSZXNwb25zZShzZWxmLl91cmwsIHNlbGYuanNfcmVzcG9uc2UuY2xvbmUoKSkKCiAgICBhc3luYyBkZWYgYnVmZmVyKHNlbGYpIC0+IEpzUHJveHk6CiAgICAgICAgIiIiUmV0dXJuIHRoZSByZXNwb25zZSBib2R5IGFzIGEgSmF2YXNjcmlwdCBBcnJheUJ1ZmZlciIiIgogICAgICAgIHNlbGYuX3JhaXNlX2lmX2ZhaWxlZCgpCiAgICAgICAgcmV0dXJuIGF3YWl0IHNlbGYuanNfcmVzcG9uc2UuYXJyYXlCdWZmZXIoKQoKICAgIGFzeW5jIGRlZiBzdHJpbmcoc2VsZikgLT4gc3RyOgogICAgICAgICIiIlJldHVybiB0aGUgcmVzcG9uc2UgYm9keSBhcyBhIHN0cmluZyIiIgogICAgICAgIHNlbGYuX3JhaXNlX2lmX2ZhaWxlZCgpCiAgICAgICAgcmV0dXJuIGF3YWl0IHNlbGYuanNfcmVzcG9uc2UudGV4dCgpCgogICAgYXN5bmMgZGVmIGpzb24oc2VsZiwgKiprd2FyZ3MpIC0+IEFueToKICAgICAgICAiIiJSZXR1cm4gdGhlIHJlc3BvbnNlIGJvZHkgYXMgYSBKYXZhc2NyaXB0IEpTT04gb2JqZWN0LgoKICAgICAgICBBbnkga2V5d29yZCBhcmd1bWVudHMgYXJlIHBhc3NlZCB0byBganNvbi5sb2FkcwogICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zLjgvbGlicmFyeS9qc29uLmh0bWwjanNvbi5sb2Fkcz5gXy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9yYWlzZV9pZl9mYWlsZWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGF3YWl0IHNlbGYuc3RyaW5nKCksICoqa3dhcmdzKQoKICAgIGFzeW5jIGRlZiBtZW1vcnl2aWV3KHNlbGYpIC0+IG1lbW9yeXZpZXc6CiAgICAgICAgIiIiUmV0dXJuIHRoZSByZXNwb25zZSBib2R5IGFzIGEgbWVtb3J5dmlldyBvYmplY3QiIiIKICAgICAgICBzZWxmLl9yYWlzZV9pZl9mYWlsZWQoKQogICAgICAgIHJldHVybiAoYXdhaXQgc2VsZi5idWZmZXIoKSkudG9fbWVtb3J5dmlldygpCgogICAgYXN5bmMgZGVmIGJ5dGVzKHNlbGYpIC0+IGJ5dGVzOgogICAgICAgICIiIlJldHVybiB0aGUgcmVzcG9uc2UgYm9keSBhcyBhIGJ5dGVzIG9iamVjdCIiIgogICAgICAgIHNlbGYuX3JhaXNlX2lmX2ZhaWxlZCgpCiAgICAgICAgcmV0dXJuIChhd2FpdCBzZWxmLmJ1ZmZlcigpKS50b19ieXRlcygpCgogICAgYXN5bmMgZGVmIF9pbnRvX2ZpbGUoc2VsZiwgZjogSU9CYXNlKToKICAgICAgICAiIiJXcml0ZSB0aGUgZGF0YSBpbnRvIGFuIGVtcHR5IGZpbGUgd2l0aCBubyBjb3B5LgoKICAgICAgICBXYXJuaW5nOiBzaG91bGQgb25seSBiZSB1c2VkIHdoZW4gZiBpcyBhbiBlbXB0eSBmaWxlLCBvdGhlcndpc2UgaXQgbWF5CiAgICAgICAgb3ZlcndyaXRlIHRoZSBkYXRhIG9mIGYuCiAgICAgICAgIiIiCiAgICAgICAgYnVmID0gYXdhaXQgc2VsZi5idWZmZXIoKQogICAgICAgIGJ1Zi5faW50b19maWxlKGYpCgogICAgYXN5bmMgZGVmIF9jcmVhdGVfZmlsZShzZWxmLCBwYXRoOiBzdHIpOgogICAgICAgICIiIlVzZXMgdGhlIGRhdGEgdG8gYmFjayBhIG5ldyBmaWxlIHdpdGhvdXQgY29weWluZyBpdC4KCiAgICAgICAgVGhpcyBtZXRob2QgYXZvaWRzIGNvcHlpbmcgdGhlIGRhdGEgd2hlbiBjcmVhdGluZyBhIG5ldyBmaWxlLiBJZiB5b3UKICAgICAgICB3YW50IHRvIHdyaXRlIHRoZSBkYXRhIGludG8gYW4gZXhpc3RpbmcgZmlsZSwgdXNlCgogICAgICAgIC4uIGNvZGUtYmxvY2s6OiBweXRob24KCiAgICAgICAgICAgIGJ1ZiA9IGF3YWl0IHJlc3AuYnVmZmVyKCkKICAgICAgICAgICAgYnVmLnRvX2ZpbGUoZmlsZSkKCiAgICAgICAgUGFyYW1ldGVycwogICAgICAgIC0tLS0tLS0tLS0KICAgICAgICBwYXRoIDogc3RyCgogICAgICAgICAgICBUaGUgcGF0aCB0byB0aGUgZmlsZSB0byBjcmVhdGUuIFRoZSBmaWxlIHNob3VsZCBub3QgZXhpc3QgYnV0CiAgICAgICAgICAgIGl0IHNob3VsZCBiZSBpbiBhIGRpcmVjdG9yeSB0aGF0IGV4aXN0cy4gT3RoZXJ3aXNlLCB3aWxsIHJhaXNlCiAgICAgICAgICAgIGFuIGBgT1NFcnJvcmBgCiAgICAgICAgIiIiCiAgICAgICAgd2l0aCBvcGVuKHBhdGgsICJ4IikgYXMgZjoKICAgICAgICAgICAgYXdhaXQgc2VsZi5faW50b19maWxlKGYpICAjIHR5cGU6IGlnbm9yZQoKICAgIGFzeW5jIGRlZiB1bnBhY2tfYXJjaGl2ZShzZWxmLCAqLCBleHRyYWN0X2Rpcj1Ob25lLCBmb3JtYXQ9Tm9uZSk6CiAgICAgICAgIiIiVHJlYXQgdGhlIGRhdGEgYXMgYW4gYXJjaGl2ZSBhbmQgdW5wYWNrIGl0IGludG8gdGFyZ2V0IGRpcmVjdG9yeS4KCiAgICAgICAgQXNzdW1lcyB0aGF0IHRoZSBmaWxlIGlzIGFuIGFyY2hpdmUgaW4gYSBmb3JtYXQgdGhhdCBzaHV0aWwgaGFzIGFuCiAgICAgICAgdW5wYWNrZXIgZm9yLiBUaGUgYXJndW1lbnRzIGV4dHJhY3RfZGlyIGFuZCBmb3JtYXQgYXJlIHBhc3NlZCBkaXJlY3RseQogICAgICAgIG9uIHRvIGBgc2h1dGlsLnVucGFja19hcmNoaXZlYGAuCgogICAgICAgIFBhcmFtZXRlcnMKICAgICAgICAtLS0tLS0tLS0tCiAgICAgICAgZXh0cmFjdF9kaXIgOiBzdHIKICAgICAgICAgICAgRGlyZWN0b3J5IHRvIGV4dHJhY3QgdGhlIGFyY2hpdmUgaW50by4gSWYgbm90CiAgICAgICAgICAgIHByb3ZpZGVkLCB0aGUgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSBpcyB1c2VkLgoKICAgICAgICBmb3JtYXQgOiBzdHIKICAgICAgICAgICAgVGhlIGFyY2hpdmUgZm9ybWF0OiBvbmUgb2Yg4oCcemlw4oCdLCDigJx0YXLigJ0sIOKAnGd6dGFy4oCdLCDigJxienRhcuKAnS4KICAgICAgICAgICAgT3IgYW55IG90aGVyIGZvcm1hdCByZWdpc3RlcmVkIHdpdGggYGBzaHV0aWwucmVnaXN0ZXJfdW5wYWNrX2Zvcm1hdCgpYGAuIElmIG5vdAogICAgICAgICAgICBwcm92aWRlZCwgYGB1bnBhY2tfYXJjaGl2ZSgpYGAgd2lsbCB1c2UgdGhlIGFyY2hpdmUgZmlsZSBuYW1lIGV4dGVuc2lvbgogICAgICAgICAgICBhbmQgc2VlIGlmIGFuIHVucGFja2VyIHdhcyByZWdpc3RlcmVkIGZvciB0aGF0IGV4dGVuc2lvbi4gSW4gY2FzZQogICAgICAgICAgICBub25lIGlzIGZvdW5kLCBhIGBgVmFsdWVFcnJvcmBgIGlzIHJhaXNlZC4KICAgICAgICAiIiIKICAgICAgICBidWYgPSBhd2FpdCBzZWxmLmJ1ZmZlcigpCiAgICAgICAgZmlsZW5hbWUgPSBzZWxmLl91cmwucnNwbGl0KCIvIiwgLTEpWy0xXQogICAgICAgIHVucGFja19idWZmZXJfYXJjaGl2ZSgKICAgICAgICAgICAgYnVmLCBmaWxlbmFtZT1maWxlbmFtZSwgZm9ybWF0PWZvcm1hdCwgZXh0cmFjdF9kaXI9ZXh0cmFjdF9kaXIKICAgICAgICApCgoKYXN5bmMgZGVmIHB5ZmV0Y2godXJsOiBzdHIsICoqa3dhcmdzKSAtPiBGZXRjaFJlc3BvbnNlOgogICAgIiIiRmV0Y2ggdGhlIHVybCBhbmQgcmV0dXJuIHRoZSByZXNwb25zZS4KCiAgICBUaGlzIGZ1bmN0aW9ucyBwcm92aWRlcyBhIHNpbWlsYXIgQVBJIHRvIHRoZSBKYXZhU2NyaXB0IGBmZXRjaCBmdW5jdGlvbgogICAgPGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9mZXRjaD5gXyBob3dldmVyIGl0IGlzCiAgICBkZXNpZ25lZCB0byBiZSBjb252ZW5pZW50IHRvIHVzZSBmcm9tIFB5dGhvbi4gVGhlCiAgICA6Y2xhc3M6YHB5b2RpZGUuaHR0cC5GZXRjaFJlc3BvbnNlYCBoYXMgbWV0aG9kcyB3aXRoIHRoZSBvdXRwdXQgdHlwZXMKICAgIGFscmVhZHkgY29udmVydGVkIHRvIFB5dGhvbiBvYmplY3RzLgoKICAgIFBhcmFtZXRlcnMKICAgIC0tLS0tLS0tLS0KICAgIHVybCA6IHN0cgogICAgICAgIFVSTCB0byBmZXRjaC4KCiAgICBcKlwqa3dhcmdzIDogQW55CiAgICAgICAga2V5d29yZCBhcmd1bWVudHMgYXJlIHBhc3NlZCBhbG9uZyBhcyBgb3B0aW9uYWwgcGFyYW1ldGVycyB0byB0aGUgZmV0Y2ggQVBJCiAgICAgICAgPGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9mZXRjaCNwYXJhbWV0ZXJzPmBfLgogICAgIiIiCiAgICBpZiBJTl9CUk9XU0VSOgogICAgICAgIGZyb20ganMgaW1wb3J0IGZldGNoIGFzIF9qc2ZldGNoLCBPYmplY3QKCiAgICByZXR1cm4gRmV0Y2hSZXNwb25zZSgKICAgICAgICB1cmwsIGF3YWl0IF9qc2ZldGNoKHVybCwgdG9fanMoa3dhcmdzLCBkaWN0X2NvbnZlcnRlcj1PYmplY3QuZnJvbUVudHJpZXMpKQogICAgKQoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcHlvZGlkZS93ZWJsb29wLnB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA2NDQAMDAwMDAwMAAwMDAwMDAwADAwMDAwMDM0MTMwADE0MjA1MTY2NzUwADAxMzI0MQAgMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABpbXBvcnQgYXN5bmNpbwppbXBvcnQgY29udGV4dHZhcnMKaW1wb3J0IHN5cwppbXBvcnQgdGltZQppbXBvcnQgdHJhY2ViYWNrCmZyb20gdHlwaW5nIGltcG9ydCBDYWxsYWJsZQoKCmZyb20gLl9jb3JlIGltcG9ydCBjcmVhdGVfb25jZV9jYWxsYWJsZSwgSU5fQlJPV1NFUgoKaWYgSU5fQlJPV1NFUjoKICAgIGZyb20ganMgaW1wb3J0IHNldFRpbWVvdXQKCgpjbGFzcyBXZWJMb29wKGFzeW5jaW8uQWJzdHJhY3RFdmVudExvb3ApOgogICAgIiIiQSBjdXN0b20gZXZlbnQgbG9vcCBmb3IgdXNlIGluIFB5b2RpZGUuCgogICAgU2NoZWR1bGVzIHRhc2tzIG9uIHRoZSBicm93c2VyIGV2ZW50IGxvb3AuIERvZXMgbm8gbGlmZWN5Y2xlIG1hbmFnZW1lbnQgYW5kIHJ1bnMKICAgIGZvcmV2ZXIuCgogICAgYGBydW5fZm9yZXZlcmBgIGFuZCBgYHJ1bl91bnRpbF9jb21wbGV0ZWBgIGNhbm5vdCBibG9jayBsaWtlIGEgbm9ybWFsIGV2ZW50IGxvb3Agd291bGQKICAgIGJlY2F1c2Ugd2Ugb25seSBoYXZlIG9uZSB0aHJlYWQgc28gYmxvY2tpbmcgd291bGQgc3RhbGwgdGhlIGJyb3dzZXIgZXZlbnQgbG9vcAogICAgYW5kIHByZXZlbnQgYW55dGhpbmcgZnJvbSBldmVyIGhhcHBlbmluZy4KCiAgICBXZSBkZWZlciBhbGwgd29yayB0byB0aGUgYnJvd3NlciBldmVudCBsb29wIHVzaW5nIHRoZSBzZXRUaW1lb3V0IGZ1bmN0aW9uLgogICAgVG8gZW5zdXJlIHRoYXQgdGhpcyBldmVudCBsb29wIGRvZXNuJ3Qgc3RhbGwgb3V0IFVJIGFuZCBvdGhlciBicm93c2VyIGhhbmRsaW5nLAogICAgd2Ugd2FudCB0byBtYWtlIHN1cmUgdGhhdCBlYWNoIHRhc2sgaXMgc2NoZWR1bGVkIG9uIHRoZSBicm93c2VyIGV2ZW50IGxvb3AgYXMgYQogICAgdGFzayBub3QgYXMgYSBtaWNyb3Rhc2suIGBgc2V0VGltZW91dChjYWxsYmFjaywgMClgYCBlbnF1ZXVlcyB0aGUgY2FsbGJhY2sgYXMgYQogICAgdGFzayBzbyBpdCB3b3JrcyB3ZWxsIGZvciBvdXIgcHVycG9zZXMuCgogICAgU2VlIGBFdmVudCBMb29wIE1ldGhvZHMgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9hc3luY2lvLWV2ZW50bG9vcC5odG1sI2FzeW5jaW8tZXZlbnQtbG9vcD5gXy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLl90YXNrX2ZhY3RvcnkgPSBOb25lCiAgICAgICAgYXN5bmNpby5fc2V0X3J1bm5pbmdfbG9vcChzZWxmKQogICAgICAgIHNlbGYuX2V4Y2VwdGlvbl9oYW5kbGVyID0gTm9uZQogICAgICAgIHNlbGYuX2N1cnJlbnRfaGFuZGxlID0gTm9uZQoKICAgIGRlZiBnZXRfZGVidWcoc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgIwogICAgIyBMaWZlY3ljbGUgbWV0aG9kczogV2UgaWdub3JlIGFsbCBsaWZlY3ljbGUgbWFuYWdlbWVudAogICAgIwoKICAgIGRlZiBpc19ydW5uaW5nKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIiIiUmV0dXJucyBgYFRydWVgYCBpZiB0aGUgZXZlbnQgbG9vcCBpcyBydW5uaW5nLgoKICAgICAgICBBbHdheXMgcmV0dXJucyBgYFRydWVgYCBiZWNhdXNlIFdlYkxvb3AgaGFzIG5vIGxpZmVjeWNsZSBtYW5hZ2VtZW50LgogICAgICAgICIiIgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGlzX2Nsb3NlZChzZWxmKSAtPiBib29sOgogICAgICAgICIiIlJldHVybnMgYGBUcnVlYGAgaWYgdGhlIGV2ZW50IGxvb3Agd2FzIGNsb3NlZC4KCiAgICAgICAgQWx3YXlzIHJldHVybnMgYGBGYWxzZWBgIGJlY2F1c2UgV2ViTG9vcCBoYXMgbm8gbGlmZWN5Y2xlIG1hbmFnZW1lbnQuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9jaGVja19jbG9zZWQoc2VsZik6CiAgICAgICAgIiIiVXNlZCBpbiBjcmVhdGVfdGFzay4KCiAgICAgICAgV291bGQgcmFpc2UgYW4gZXJyb3IgaWYgYGBzZWxmLmlzX2Nsb3NlZCgpYGAsIGJ1dCB3ZSBhcmUgc2tpcHBpbmcgYWxsIGxpZmVjeWNsZSBzdHVmZi4KICAgICAgICAiIiIKICAgICAgICBwYXNzCgogICAgZGVmIHJ1bl9mb3JldmVyKHNlbGYpOgogICAgICAgICIiIlJ1biB0aGUgZXZlbnQgbG9vcCBmb3JldmVyLiBEb2VzIG5vdGhpbmcgaW4gdGhpcyBpbXBsZW1lbnRhdGlvbi4KCiAgICAgICAgV2UgY2Fubm90IGJsb2NrIGxpa2UgYSBub3JtYWwgZXZlbnQgbG9vcCB3b3VsZAogICAgICAgIGJlY2F1c2Ugd2Ugb25seSBoYXZlIG9uZSB0aHJlYWQgc28gYmxvY2tpbmcgd291bGQgc3RhbGwgdGhlIGJyb3dzZXIgZXZlbnQgbG9vcAogICAgICAgIGFuZCBwcmV2ZW50IGFueXRoaW5nIGZyb20gZXZlciBoYXBwZW5pbmcuCiAgICAgICAgIiIiCiAgICAgICAgcGFzcwoKICAgIGRlZiBydW5fdW50aWxfY29tcGxldGUoc2VsZiwgZnV0dXJlKToKICAgICAgICAiIiJSdW4gdW50aWwgZnV0dXJlIGlzIGRvbmUuCgogICAgICAgIElmIHRoZSBhcmd1bWVudCBpcyBhIGNvcm91dGluZSwgaXQgaXMgd3JhcHBlZCBpbiBhIFRhc2suCgogICAgICAgIFRoZSBuYXRpdmUgZXZlbnQgbG9vcCBgcnVuX3VudGlsX2NvbXBsZXRlYCBibG9ja3MgdW50aWwgZXZhbHVhdGlvbiBvZiB0aGUKICAgICAgICBmdXR1cmUgaXMgY29tcGxldGUgYW5kIHRoZW4gcmV0dXJucyB0aGUgcmVzdWx0IG9mIHRoZSBmdXR1cmUuCiAgICAgICAgU2luY2Ugd2UgY2Fubm90IGJsb2NrLCB3ZSBqdXN0IGVuc3VyZSB0aGF0IHRoZSBmdXR1cmUgaXMgc2NoZWR1bGVkIGFuZAogICAgICAgIHJldHVybiB0aGUgZnV0dXJlLiBUaGlzIG1ha2VzIHRoaXMgbWV0aG9kIGEgYml0IHVzZWxlc3MuIEluc3RlYWQsIHVzZQogICAgICAgIGBmdXR1cmUuYWRkX2RvbmVfY2FsbGJhY2soZG9fc29tZXRoaW5nX3dpdGhfcmVzdWx0KWAgb3I6CiAgICAgICAgYGBgcHl0aG9uCiAgICAgICAgYXN5bmMgZGVmIHdyYXBwZXIoKToKICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgZnV0dXJlCiAgICAgICAgICAgIGRvX3NvbWV0aGluZ193aXRoX3Jlc3VsdChyZXN1bHQpCiAgICAgICAgYGBgCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIGFzeW5jaW8uZW5zdXJlX2Z1dHVyZShmdXR1cmUpCgogICAgIwogICAgIyBTY2hlZHVsaW5nIG1ldGhvZHM6IHVzZSBicm93c2VyLnNldFRpbWVvdXQgdG8gc2NoZWR1bGUgdGFza3Mgb24gdGhlIGJyb3dzZXIgZXZlbnQgbG9vcC4KICAgICMKCiAgICBkZWYgY2FsbF9zb29uKHNlbGYsIGNhbGxiYWNrOiBDYWxsYWJsZSwgKmFyZ3MsIGNvbnRleHQ6IGNvbnRleHR2YXJzLkNvbnRleHQgPSBOb25lKToKICAgICAgICAiIiJBcnJhbmdlIGZvciBhIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCBhcyBzb29uIGFzIHBvc3NpYmxlLgoKICAgICAgICBBbnkgcG9zaXRpb25hbCBhcmd1bWVudHMgYWZ0ZXIgdGhlIGNhbGxiYWNrIHdpbGwgYmUgcGFzc2VkIHRvCiAgICAgICAgdGhlIGNhbGxiYWNrIHdoZW4gaXQgaXMgY2FsbGVkLgoKICAgICAgICBUaGlzIHNjaGVkdWxlcyB0aGUgY2FsbGJhY2sgb24gdGhlIGJyb3dzZXIgZXZlbnQgbG9vcCB1c2luZyBgYHNldFRpbWVvdXQoY2FsbGJhY2ssIDApYGAuCiAgICAgICAgIiIiCiAgICAgICAgZGVsYXkgPSAwCiAgICAgICAgcmV0dXJuIHNlbGYuY2FsbF9sYXRlcihkZWxheSwgY2FsbGJhY2ssICphcmdzLCBjb250ZXh0PWNvbnRleHQpCgogICAgZGVmIGNhbGxfc29vbl90aHJlYWRzYWZlKAogICAgICAgIHNlbGYsIGNhbGxiYWNrOiBDYWxsYWJsZSwgKmFyZ3MsIGNvbnRleHQ6IGNvbnRleHR2YXJzLkNvbnRleHQgPSBOb25lCiAgICApOgogICAgICAgICIiIkxpa2UgYGBjYWxsX3Nvb24oKWBgLCBidXQgdGhyZWFkLXNhZmUuCgogICAgICAgIFdlIGhhdmUgbm8gdGhyZWFkcyBzbyBldmVyeXRoaW5nIGlzICJ0aHJlYWQgc2FmZSIsIGFuZCB3ZSBqdXN0IHVzZSBgYGNhbGxfc29vbmBgLgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLmNhbGxfc29vbihjYWxsYmFjaywgKmFyZ3MsIGNvbnRleHQ9Y29udGV4dCkKCiAgICBkZWYgY2FsbF9sYXRlcigKICAgICAgICBzZWxmLAogICAgICAgIGRlbGF5OiBmbG9hdCwKICAgICAgICBjYWxsYmFjazogQ2FsbGFibGUsCiAgICAgICAgKmFyZ3MsCiAgICAgICAgY29udGV4dDogY29udGV4dHZhcnMuQ29udGV4dCA9IE5vbmUsCiAgICApOgogICAgICAgICIiIkFycmFuZ2UgZm9yIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIGF0IGEgZ2l2ZW4gdGltZS4KCiAgICAgICAgUmV0dXJuIGEgSGFuZGxlOiBhbiBvcGFxdWUgb2JqZWN0IHdpdGggYSBjYW5jZWwoKSBtZXRob2QgdGhhdAogICAgICAgIGNhbiBiZSB1c2VkIHRvIGNhbmNlbCB0aGUgY2FsbC4KCiAgICAgICAgVGhlIGRlbGF5IGNhbiBiZSBhbiBpbnQgb3IgZmxvYXQsIGV4cHJlc3NlZCBpbiBzZWNvbmRzLiAgSXQgaXMKICAgICAgICBhbHdheXMgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgdGltZS4KCiAgICAgICAgRWFjaCBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBleGFjdGx5IG9uY2UuICBJZiB0d28gY2FsbGJhY2tzCiAgICAgICAgYXJlIHNjaGVkdWxlZCBmb3IgZXhhY3RseSB0aGUgc2FtZSB0aW1lLCBpdCB1bmRlZmluZWQgd2hpY2gKICAgICAgICB3aWxsIGJlIGNhbGxlZCBmaXJzdC4KCiAgICAgICAgQW55IHBvc2l0aW9uYWwgYXJndW1lbnRzIGFmdGVyIHRoZSBjYWxsYmFjayB3aWxsIGJlIHBhc3NlZCB0bwogICAgICAgIHRoZSBjYWxsYmFjayB3aGVuIGl0IGlzIGNhbGxlZC4KCiAgICAgICAgVGhpcyB1c2VzIGBzZXRUaW1lb3V0KGNhbGxiYWNrLCBkZWxheSlgCiAgICAgICAgIiIiCiAgICAgICAgaWYgZGVsYXkgPCAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJDYW4ndCBzY2hlZHVsZSBpbiB0aGUgcGFzdCIpCiAgICAgICAgaCA9IGFzeW5jaW8uSGFuZGxlKGNhbGxiYWNrLCBhcmdzLCBzZWxmLCBjb250ZXh0PWNvbnRleHQpCgogICAgICAgIGRlZiBydW5faGFuZGxlKCk6CiAgICAgICAgICAgIGlmIGguY2FuY2VsbGVkKCk6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaC5fcnVuKCkKCiAgICAgICAgc2V0VGltZW91dChjcmVhdGVfb25jZV9jYWxsYWJsZShydW5faGFuZGxlKSwgZGVsYXkgKiAxMDAwKQogICAgICAgIHJldHVybiBoCgogICAgZGVmIGNhbGxfYXQoCiAgICAgICAgc2VsZiwKICAgICAgICB3aGVuOiBmbG9hdCwKICAgICAgICBjYWxsYmFjazogQ2FsbGFibGUsCiAgICAgICAgKmFyZ3MsCiAgICAgICAgY29udGV4dDogY29udGV4dHZhcnMuQ29udGV4dCA9IE5vbmUsCiAgICApOgogICAgICAgICIiIkxpa2UgYGBjYWxsX2xhdGVyKClgYCwgYnV0IHVzZXMgYW4gYWJzb2x1dGUgdGltZS4KCiAgICAgICAgQWJzb2x1dGUgdGltZSBjb3JyZXNwb25kcyB0byB0aGUgZXZlbnQgbG9vcCdzIGBgdGltZSgpYGAgbWV0aG9kLgoKICAgICAgICBUaGlzIHVzZXMgYGBzZXRUaW1lb3V0KGNhbGxiYWNrLCB3aGVuIC0gY3VyX3RpbWUpYGAKICAgICAgICAiIiIKICAgICAgICBjdXJfdGltZSA9IHNlbGYudGltZSgpCiAgICAgICAgZGVsYXkgPSB3aGVuIC0gY3VyX3RpbWUKICAgICAgICByZXR1cm4gc2VsZi5jYWxsX2xhdGVyKGRlbGF5LCBjYWxsYmFjaywgKmFyZ3MsIGNvbnRleHQ9Y29udGV4dCkKCiAgICBkZWYgcnVuX2luX2V4ZWN1dG9yKHNlbGYsIGV4ZWN1dG9yLCBmdW5jLCAqYXJncyk6CiAgICAgICAgIiIiQXJyYW5nZSBmb3IgZnVuYyB0byBiZSBjYWxsZWQgaW4gdGhlIHNwZWNpZmllZCBleGVjdXRvci4KCiAgICAgICAgVGhpcyBpcyBub3JtYWxseSBzdXBwb3NlZCB0byBydW4gZnVuYygqYXJncykgaW4gYSBzZXBhcmF0ZSBwcm9jZXNzIG9yCiAgICAgICAgdGhyZWFkIGFuZCBzaWduYWwgYmFjayB0byBvdXIgZXZlbnQgbG9vcCB3aGVuIGl0IGlzIGRvbmUuIEl0J3MgcG9zc2libGUKICAgICAgICB0byBtYWtlIHRoZSBleGVjdXRvciwgYnV0IGlmIHdlIGFjdHVhbGx5IHRyeSB0byBzdWJtaXQgYW55IGZ1bmN0aW9ucyB0bwogICAgICAgIGl0LCBpdCB3aWxsIHRyeSB0byBjcmVhdGUgYSB0aHJlYWQgYW5kIHRocm93IGFuIGVycm9yLiBCZXN0IHdlIGNhbiBkbyBpcwogICAgICAgIHRvIHJ1biBmdW5jKGFyZ3MpIGluIHRoaXMgdGhyZWFkIGFuZCBzdGljayB0aGUgcmVzdWx0IGludG8gYSBmdXR1cmUuCiAgICAgICAgIiIiCiAgICAgICAgZnV0ID0gc2VsZi5jcmVhdGVfZnV0dXJlKCkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZ1dC5zZXRfcmVzdWx0KGZ1bmMoKmFyZ3MpKQogICAgICAgIGV4Y2VwdCBCYXNlRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGZ1dC5zZXRfZXhjZXB0aW9uKGUpCiAgICAgICAgcmV0dXJuIGZ1dAoKICAgICMKICAgICMgVGhlIHJlbWFpbmluZyBtZXRob2RzIGFyZSBjb3BpZWQgZGlyZWN0bHkgZnJvbSBCYXNlRXZlbnRMb29wCiAgICAjCgogICAgZGVmIHRpbWUoc2VsZik6CiAgICAgICAgIiIiUmV0dXJuIHRoZSB0aW1lIGFjY29yZGluZyB0byB0aGUgZXZlbnQgbG9vcCdzIGNsb2NrLgoKICAgICAgICBUaGlzIGlzIGEgZmxvYXQgZXhwcmVzc2VkIGluIHNlY29uZHMgc2luY2UgYW4gZXBvY2gsIGJ1dCB0aGUKICAgICAgICBlcG9jaCwgcHJlY2lzaW9uLCBhY2N1cmFjeSBhbmQgZHJpZnQgYXJlIHVuc3BlY2lmaWVkIGFuZCBtYXkKICAgICAgICBkaWZmZXIgcGVyIGV2ZW50IGxvb3AuCgogICAgICAgIENvcGllZCBmcm9tIGBgQmFzZUV2ZW50TG9vcC50aW1lYGAKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gdGltZS5tb25vdG9uaWMoKQoKICAgIGRlZiBjcmVhdGVfZnV0dXJlKHNlbGYpOgogICAgICAgICIiIkNyZWF0ZSBhIEZ1dHVyZSBvYmplY3QgYXR0YWNoZWQgdG8gdGhlIGxvb3AuCgogICAgICAgIENvcGllZCBmcm9tIGBgQmFzZUV2ZW50TG9vcC5jcmVhdGVfZnV0dXJlYGAKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gYXN5bmNpby5mdXR1cmVzLkZ1dHVyZShsb29wPXNlbGYpCgogICAgZGVmIGNyZWF0ZV90YXNrKHNlbGYsIGNvcm8sICosIG5hbWU9Tm9uZSk6CiAgICAgICAgIiIiU2NoZWR1bGUgYSBjb3JvdXRpbmUgb2JqZWN0LgoKICAgICAgICBSZXR1cm4gYSB0YXNrIG9iamVjdC4KCiAgICAgICAgQ29waWVkIGZyb20gYGBCYXNlRXZlbnRMb29wLmNyZWF0ZV90YXNrYGAKICAgICAgICAiIiIKICAgICAgICBzZWxmLl9jaGVja19jbG9zZWQoKQogICAgICAgIGlmIHNlbGYuX3Rhc2tfZmFjdG9yeSBpcyBOb25lOgogICAgICAgICAgICB0YXNrID0gYXN5bmNpby50YXNrcy5UYXNrKGNvcm8sIGxvb3A9c2VsZiwgbmFtZT1uYW1lKQogICAgICAgICAgICBpZiB0YXNrLl9zb3VyY2VfdHJhY2ViYWNrOgogICAgICAgICAgICAgICAgIyBBZGRlZCBjb21tZW50OgogICAgICAgICAgICAgICAgIyB0aGlzIG9ubHkgaGFwcGVucyBpZiBnZXRfZGVidWcoKSByZXR1cm5zIFRydWUuCiAgICAgICAgICAgICAgICAjIEluIHRoYXQgY2FzZSwgcmVtb3ZlIGNyZWF0ZV90YXNrIGZyb20gX3NvdXJjZV90cmFjZWJhY2suCiAgICAgICAgICAgICAgICBkZWwgdGFzay5fc291cmNlX3RyYWNlYmFja1stMV0KICAgICAgICBlbHNlOgogICAgICAgICAgICB0YXNrID0gc2VsZi5fdGFza19mYWN0b3J5KHNlbGYsIGNvcm8pCiAgICAgICAgICAgIGFzeW5jaW8udGFza3MuX3NldF90YXNrX25hbWUodGFzaywgbmFtZSkKCiAgICAgICAgcmV0dXJuIHRhc2sKCiAgICBkZWYgc2V0X3Rhc2tfZmFjdG9yeShzZWxmLCBmYWN0b3J5KToKICAgICAgICAiIiJTZXQgYSB0YXNrIGZhY3RvcnkgdGhhdCB3aWxsIGJlIHVzZWQgYnkgbG9vcC5jcmVhdGVfdGFzaygpLgoKICAgICAgICBJZiBmYWN0b3J5IGlzIE5vbmUgdGhlIGRlZmF1bHQgdGFzayBmYWN0b3J5IHdpbGwgYmUgc2V0LgoKICAgICAgICBJZiBmYWN0b3J5IGlzIGEgY2FsbGFibGUsIGl0IHNob3VsZCBoYXZlIGEgc2lnbmF0dXJlIG1hdGNoaW5nCiAgICAgICAgJyhsb29wLCBjb3JvKScsIHdoZXJlICdsb29wJyB3aWxsIGJlIGEgcmVmZXJlbmNlIHRvIHRoZSBhY3RpdmUKICAgICAgICBldmVudCBsb29wLCAnY29ybycgd2lsbCBiZSBhIGNvcm91dGluZSBvYmplY3QuICBUaGUgY2FsbGFibGUKICAgICAgICBtdXN0IHJldHVybiBhIEZ1dHVyZS4KCiAgICAgICAgQ29waWVkIGZyb20gYGBCYXNlRXZlbnRMb29wLnNldF90YXNrX2ZhY3RvcnlgYAogICAgICAgICIiIgogICAgICAgIGlmIGZhY3RvcnkgaXMgbm90IE5vbmUgYW5kIG5vdCBjYWxsYWJsZShmYWN0b3J5KToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCJ0YXNrIGZhY3RvcnkgbXVzdCBiZSBhIGNhbGxhYmxlIG9yIE5vbmUiKQogICAgICAgIHNlbGYuX3Rhc2tfZmFjdG9yeSA9IGZhY3RvcnkKCiAgICBkZWYgZ2V0X3Rhc2tfZmFjdG9yeShzZWxmKToKICAgICAgICAiIiJSZXR1cm4gYSB0YXNrIGZhY3RvcnksIG9yIE5vbmUgaWYgdGhlIGRlZmF1bHQgb25lIGlzIGluIHVzZS4KCiAgICAgICAgQ29waWVkIGZyb20gYGBCYXNlRXZlbnRMb29wLmdldF90YXNrX2ZhY3RvcnlgYAogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl90YXNrX2ZhY3RvcnkKCiAgICBkZWYgZ2V0X2V4Y2VwdGlvbl9oYW5kbGVyKHNlbGYpOgogICAgICAgICIiIlJldHVybiBhbiBleGNlcHRpb24gaGFuZGxlciwgb3IgTm9uZSBpZiB0aGUgZGVmYXVsdCBvbmUgaXMgaW4gdXNlLiIiIgogICAgICAgIHJldHVybiBzZWxmLl9leGNlcHRpb25faGFuZGxlcgoKICAgIGRlZiBzZXRfZXhjZXB0aW9uX2hhbmRsZXIoc2VsZiwgaGFuZGxlcik6CiAgICAgICAgIiIiU2V0IGhhbmRsZXIgYXMgdGhlIG5ldyBldmVudCBsb29wIGV4Y2VwdGlvbiBoYW5kbGVyLgoKICAgICAgICBJZiBoYW5kbGVyIGlzIE5vbmUsIHRoZSBkZWZhdWx0IGV4Y2VwdGlvbiBoYW5kbGVyIHdpbGwgYmUgc2V0LgoKICAgICAgICBJZiBoYW5kbGVyIGlzIGEgY2FsbGFibGUgb2JqZWN0LCBpdCBzaG91bGQgaGF2ZSBhIHNpZ25hdHVyZSBtYXRjaGluZwogICAgICAgICcobG9vcCwgY29udGV4dCknLCB3aGVyZSAnbG9vcCcgd2lsbCBiZSBhIHJlZmVyZW5jZSB0byB0aGUgYWN0aXZlIGV2ZW50CiAgICAgICAgbG9vcCwgJ2NvbnRleHQnIHdpbGwgYmUgYSBkaWN0IG9iamVjdCAoc2VlIGBjYWxsX2V4Y2VwdGlvbl9oYW5kbGVyKClgCiAgICAgICAgZG9jdW1lbnRhdGlvbiBmb3IgZGV0YWlscyBhYm91dCBjb250ZXh0KS4KICAgICAgICAiIiIKICAgICAgICBpZiBoYW5kbGVyIGlzIG5vdCBOb25lIGFuZCBub3QgY2FsbGFibGUoaGFuZGxlcik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIGYiQSBjYWxsYWJsZSBvYmplY3Qgb3IgTm9uZSBpcyBleHBlY3RlZCwgIiBmImdvdCB7aGFuZGxlciFyfSIKICAgICAgICAgICAgKQogICAgICAgIHNlbGYuX2V4Y2VwdGlvbl9oYW5kbGVyID0gaGFuZGxlcgoKICAgIGRlZiBkZWZhdWx0X2V4Y2VwdGlvbl9oYW5kbGVyKHNlbGYsIGNvbnRleHQpOgogICAgICAgICIiIkRlZmF1bHQgZXhjZXB0aW9uIGhhbmRsZXIuCgogICAgICAgIFRoaXMgaXMgY2FsbGVkIHdoZW4gYW4gZXhjZXB0aW9uIG9jY3VycyBhbmQgbm8gZXhjZXB0aW9uIGhhbmRsZXIgaXMgc2V0LAogICAgICAgIGFuZCBjYW4gYmUgY2FsbGVkIGJ5IGEgY3VzdG9tIGV4Y2VwdGlvbiBoYW5kbGVyIHRoYXQgd2FudHMgdG8gZGVmZXIgdG8KICAgICAgICB0aGUgZGVmYXVsdCBiZWhhdmlvci4gVGhpcyBkZWZhdWx0IGhhbmRsZXIgbG9ncyB0aGUgZXJyb3IgbWVzc2FnZSBhbmQKICAgICAgICBvdGhlciBjb250ZXh0LWRlcGVuZGVudCBpbmZvcm1hdGlvbi4KCgogICAgICAgIEluIGRlYnVnIG1vZGUsIGEgdHJ1bmNhdGVkIHN0YWNrIHRyYWNlIGlzIGFsc28gYXBwZW5kZWQgc2hvd2luZyB3aGVyZQogICAgICAgIHRoZSBnaXZlbiBvYmplY3QgKGUuZy4gYSBoYW5kbGUgb3IgZnV0dXJlIG9yIHRhc2spIHdhcyBjcmVhdGVkLCBpZiBhbnkuCiAgICAgICAgVGhlIGNvbnRleHQgcGFyYW1ldGVyIGhhcyB0aGUgc2FtZSBtZWFuaW5nIGFzIGluCiAgICAgICAgYGNhbGxfZXhjZXB0aW9uX2hhbmRsZXIoKWAuCiAgICAgICAgIiIiCiAgICAgICAgbWVzc2FnZSA9IGNvbnRleHQuZ2V0KCJtZXNzYWdlIikKICAgICAgICBpZiBub3QgbWVzc2FnZToKICAgICAgICAgICAgbWVzc2FnZSA9ICJVbmhhbmRsZWQgZXhjZXB0aW9uIGluIGV2ZW50IGxvb3AiCgogICAgICAgIGlmICgKICAgICAgICAgICAgInNvdXJjZV90cmFjZWJhY2siIG5vdCBpbiBjb250ZXh0CiAgICAgICAgICAgIGFuZCBzZWxmLl9jdXJyZW50X2hhbmRsZSBpcyBub3QgTm9uZQogICAgICAgICAgICBhbmQgc2VsZi5fY3VycmVudF9oYW5kbGUuX3NvdXJjZV90cmFjZWJhY2sKICAgICAgICApOgogICAgICAgICAgICBjb250ZXh0WyJoYW5kbGVfdHJhY2ViYWNrIl0gPSBzZWxmLl9jdXJyZW50X2hhbmRsZS5fc291cmNlX3RyYWNlYmFjawoKICAgICAgICBsb2dfbGluZXMgPSBbbWVzc2FnZV0KICAgICAgICBmb3Iga2V5IGluIHNvcnRlZChjb250ZXh0KToKICAgICAgICAgICAgaWYga2V5IGluIHsibWVzc2FnZSIsICJleGNlcHRpb24ifToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIHZhbHVlID0gY29udGV4dFtrZXldCiAgICAgICAgICAgIGlmIGtleSA9PSAic291cmNlX3RyYWNlYmFjayI6CiAgICAgICAgICAgICAgICB0YiA9ICIiLmpvaW4odHJhY2ViYWNrLmZvcm1hdF9saXN0KHZhbHVlKSkKICAgICAgICAgICAgICAgIHZhbHVlID0gIk9iamVjdCBjcmVhdGVkIGF0IChtb3N0IHJlY2VudCBjYWxsIGxhc3QpOlxuIgogICAgICAgICAgICAgICAgdmFsdWUgKz0gdGIucnN0cmlwKCkKICAgICAgICAgICAgZWxpZiBrZXkgPT0gImhhbmRsZV90cmFjZWJhY2siOgogICAgICAgICAgICAgICAgdGIgPSAiIi5qb2luKHRyYWNlYmFjay5mb3JtYXRfbGlzdCh2YWx1ZSkpCiAgICAgICAgICAgICAgICB2YWx1ZSA9ICJIYW5kbGUgY3JlYXRlZCBhdCAobW9zdCByZWNlbnQgY2FsbCBsYXN0KTpcbiIKICAgICAgICAgICAgICAgIHZhbHVlICs9IHRiLnJzdHJpcCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHJlcHIodmFsdWUpCiAgICAgICAgICAgIGxvZ19saW5lcy5hcHBlbmQoZiJ7a2V5fToge3ZhbHVlfSIpCgogICAgICAgIHByaW50KCJcbiIuam9pbihsb2dfbGluZXMpLCBmaWxlPXN5cy5zdGRlcnIpCgogICAgZGVmIGNhbGxfZXhjZXB0aW9uX2hhbmRsZXIoc2VsZiwgY29udGV4dCk6CiAgICAgICAgIiIiQ2FsbCB0aGUgY3VycmVudCBldmVudCBsb29wJ3MgZXhjZXB0aW9uIGhhbmRsZXIuCiAgICAgICAgVGhlIGNvbnRleHQgYXJndW1lbnQgaXMgYSBkaWN0IGNvbnRhaW5pbmcgdGhlIGZvbGxvd2luZyBrZXlzOgogICAgICAgIC0gJ21lc3NhZ2UnOiBFcnJvciBtZXNzYWdlOwogICAgICAgIC0gJ2V4Y2VwdGlvbicgKG9wdGlvbmFsKTogRXhjZXB0aW9uIG9iamVjdDsKICAgICAgICAtICdmdXR1cmUnIChvcHRpb25hbCk6IEZ1dHVyZSBpbnN0YW5jZTsKICAgICAgICAtICd0YXNrJyAob3B0aW9uYWwpOiBUYXNrIGluc3RhbmNlOwogICAgICAgIC0gJ2hhbmRsZScgKG9wdGlvbmFsKTogSGFuZGxlIGluc3RhbmNlOwogICAgICAgIC0gJ3Byb3RvY29sJyAob3B0aW9uYWwpOiBQcm90b2NvbCBpbnN0YW5jZTsKICAgICAgICAtICd0cmFuc3BvcnQnIChvcHRpb25hbCk6IFRyYW5zcG9ydCBpbnN0YW5jZTsKICAgICAgICAtICdzb2NrZXQnIChvcHRpb25hbCk6IFNvY2tldCBpbnN0YW5jZTsKICAgICAgICAtICdhc3luY2dlbicgKG9wdGlvbmFsKTogQXN5bmNocm9ub3VzIGdlbmVyYXRvciB0aGF0IGNhdXNlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgZXhjZXB0aW9uLgogICAgICAgIE5ldyBrZXlzIG1heWJlIGludHJvZHVjZWQgaW4gdGhlIGZ1dHVyZS4KICAgICAgICBOb3RlOiBkbyBub3Qgb3ZlcmxvYWQgdGhpcyBtZXRob2QgaW4gYW4gZXZlbnQgbG9vcCBzdWJjbGFzcy4KICAgICAgICBGb3IgY3VzdG9tIGV4Y2VwdGlvbiBoYW5kbGluZywgdXNlIHRoZQogICAgICAgIGBzZXRfZXhjZXB0aW9uX2hhbmRsZXIoKWAgbWV0aG9kLgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYuX2V4Y2VwdGlvbl9oYW5kbGVyIGlzIE5vbmU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuZGVmYXVsdF9leGNlcHRpb25faGFuZGxlcihjb250ZXh0KQogICAgICAgICAgICBleGNlcHQgKFN5c3RlbUV4aXQsIEtleWJvYXJkSW50ZXJydXB0KToKICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgIGV4Y2VwdCBCYXNlRXhjZXB0aW9uOgogICAgICAgICAgICAgICAgIyBTZWNvbmQgcHJvdGVjdGlvbiBsYXllciBmb3IgdW5leHBlY3RlZCBlcnJvcnMKICAgICAgICAgICAgICAgICMgaW4gdGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24sIGFzIHdlbGwgYXMgZm9yIHN1YmNsYXNzZWQKICAgICAgICAgICAgICAgICMgZXZlbnQgbG9vcHMgd2l0aCBvdmVybG9hZGVkICJkZWZhdWx0X2V4Y2VwdGlvbl9oYW5kbGVyIi4KICAgICAgICAgICAgICAgIHByaW50KCJFeGNlcHRpb24gaW4gZGVmYXVsdCBleGNlcHRpb24gaGFuZGxlciIsIGZpbGU9c3lzLnN0ZGVycikKICAgICAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuX2V4Y2VwdGlvbl9oYW5kbGVyKHNlbGYsIGNvbnRleHQpCiAgICAgICAgICAgIGV4Y2VwdCAoU3lzdGVtRXhpdCwgS2V5Ym9hcmRJbnRlcnJ1cHQpOgogICAgICAgICAgICAgICAgcmFpc2UKICAgICAgICAgICAgZXhjZXB0IEJhc2VFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICAgICAgIyBFeGNlcHRpb24gaW4gdGhlIHVzZXIgc2V0IGN1c3RvbSBleGNlcHRpb24gaGFuZGxlci4KICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAjIExldCdzIHRyeSBkZWZhdWx0IGhhbmRsZXIuCiAgICAgICAgICAgICAgICAgICAgc2VsZi5kZWZhdWx0X2V4Y2VwdGlvbl9oYW5kbGVyKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWVzc2FnZSI6ICJVbmhhbmRsZWQgZXJyb3IgaW4gZXhjZXB0aW9uIGhhbmRsZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImV4Y2VwdGlvbiI6IGV4YywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZXh0IjogY29udGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGV4Y2VwdCAoU3lzdGVtRXhpdCwgS2V5Ym9hcmRJbnRlcnJ1cHQpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlCiAgICAgICAgICAgICAgICBleGNlcHQgQmFzZUV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgICAgICAjIEd1YXJkICdkZWZhdWx0X2V4Y2VwdGlvbl9oYW5kbGVyJyBpbiBjYXNlIGl0IGlzCiAgICAgICAgICAgICAgICAgICAgIyBvdmVybG9hZGVkLgogICAgICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAiRXhjZXB0aW9uIGluIGRlZmF1bHQgZXhjZXB0aW9uIGhhbmRsZXIgIgogICAgICAgICAgICAgICAgICAgICAgICAid2hpbGUgaGFuZGxpbmcgYW4gdW5leHBlY3RlZCBlcnJvciAiCiAgICAgICAgICAgICAgICAgICAgICAgICJpbiBjdXN0b20gZXhjZXB0aW9uIGhhbmRsZXIiLAogICAgICAgICAgICAgICAgICAgICAgICBmaWxlPXN5cy5zdGRlcnIsCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHRyYWNlYmFjay5wcmludF9leGMoKQoKCmNsYXNzIFdlYkxvb3BQb2xpY3koYXN5bmNpby5EZWZhdWx0RXZlbnRMb29wUG9saWN5KTogICMgdHlwZTogaWdub3JlCiAgICAiIiIKICAgIEEgc2ltcGxlIGV2ZW50IGxvb3AgcG9saWN5IGZvciBtYW5hZ2luZyBXZWJMb29wIGJhc2VkIGV2ZW50IGxvb3BzLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuX2RlZmF1bHRfbG9vcCA9IE5vbmUKCiAgICBkZWYgZ2V0X2V2ZW50X2xvb3Aoc2VsZik6CiAgICAgICAgIiIiR2V0IHRoZSBjdXJyZW50IGV2ZW50IGxvb3AiIiIKICAgICAgICBpZiBzZWxmLl9kZWZhdWx0X2xvb3A6CiAgICAgICAgICAgIHJldHVybiBzZWxmLl9kZWZhdWx0X2xvb3AKICAgICAgICByZXR1cm4gc2VsZi5uZXdfZXZlbnRfbG9vcCgpCgogICAgZGVmIG5ld19ldmVudF9sb29wKHNlbGYpOgogICAgICAgICIiIkNyZWF0ZSBhIG5ldyBldmVudCBsb29wIiIiCiAgICAgICAgc2VsZi5fZGVmYXVsdF9sb29wID0gV2ViTG9vcCgpCiAgICAgICAgcmV0dXJuIHNlbGYuX2RlZmF1bHRfbG9vcAoKICAgIGRlZiBzZXRfZXZlbnRfbG9vcChzZWxmLCBsb29wOiBhc3luY2lvLkFic3RyYWN0RXZlbnRMb29wKToKICAgICAgICAiIiJTZXQgdGhlIGN1cnJlbnQgZXZlbnQgbG9vcCIiIgogICAgICAg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aWV0KCcxICsgMScpCiAgICBGYWxzZQogICAgPj4+IHNob3VsZF9xdWlldCgnMSArIDEgOycpCiAgICBUcnVlCiAgICA+Pj4gc2hvdWxkX3F1aWV0KCcxICsgMSAjIGNvbW1lbnQgOycpCiAgICBGYWxzZQogICAgIiIiCiAgICAjIGxhcmdlbHkgaW5zcGlyZWQgZnJvbSBJUHl0aG9uOgogICAgIyBodHRwczovL2dpdGh1Yi5jb20vaXB5dGhvbi9pcHl0aG9uL2Jsb2IvODZkMjQ3NDExODhiMGNlZGQ3OGFiMDgwZDQ5OGU3NzVlZDBlNTI3Mi9JUHl0aG9uL2NvcmUvZGlzcGxheWhvb2sucHkjTDg0CgogICAgIyBXZSBuZWVkIHRvIHdyYXAgdG9rZW5zIGluIGEgYnVmZmVyIGJlY2F1c2U6CiAgICAjICJUb2tlbml6ZSByZXF1aXJlcyBvbmUgYXJndW1lbnQsIHJlYWRsaW5lLCB3aGljaCBtdXN0IGJlCiAgICAjIGEgY2FsbGFibGUgb2JqZWN0IHdoaWNoIHByb3ZpZGVzIHRoZSBzYW1lIGludGVyZmFjZSBhcyB0aGUKICAgICMgaW8uSU9CYXNlLnJlYWRsaW5lKCkgbWV0aG9kIG9mIGZpbGUgb2JqZWN0cyIKICAgIHNvdXJjZV9pbyA9IFN0cmluZ0lPKHNvdXJjZSkKICAgIHRva2VucyA9IGxpc3QodG9rZW5pemUuZ2VuZXJhdGVfdG9rZW5zKHNvdXJjZV9pby5yZWFkbGluZSkpCgogICAgZm9yIHRva2VuIGluIHJldmVyc2VkKHRva2Vucyk6CiAgICAgICAgaWYgdG9rZW4udHlwZSBpbiAoCiAgICAgICAgICAgIHRva2VuaXplLkVORE1BUktFUiwKICAgICAgICAgICAgdG9rZW5pemUuTkwsICAjIGlnbm9yaW5nIGVtcHR5IGxpbmVzIChcblxuKQogICAgICAgICAgICB0b2tlbml6ZS5ORVdMSU5FLAogICAgICAgICAgICB0b2tlbml6ZS5DT01NRU5ULAogICAgICAgICk6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmV0dXJuICh0b2tlbi50eXBlID09IHRva2VuaXplLk9QKSBhbmQgKHRva2VuLnN0cmluZyA9PSAiOyIpCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgX2xhc3RfYXNzaWduX3RvX2V4cHIobW9kOiBhc3QuTW9kdWxlKToKICAgICIiIgogICAgSW1wbGVtZW50YXRpb24gb2YgJ2xhc3RfZXhwcl9vcl9hc3NpZ24nIHJldHVybl9tb2RlLgogICAgSXQgbW9kaWZpZXMgdGhlIHN1cHBseWllZCBBU1QgbW9kdWxlIHNvIHRoYXQgdGhlIGxhc3QKICAgIHN0YXRlbWVudCdzIHZhbHVlIGNhbiBiZSByZXR1cm5lZCBpbiAnbGFzdF9leHByJyByZXR1cm5fbW9kZS4KICAgICIiIgogICAgIyBMYXJnZWx5IGluc3BpcmVkIGZyb20gSVB5dGhvbjoKICAgICMgaHR0cHM6Ly9naXRodWIuY29tL2lweXRob24vaXB5dGhvbi9ibG9iLzM1ODdmNWJiNmM4NTcwZTdiYmIwNmNmNWY3ZTNiYzliOTQ2NzM1NWEvSVB5dGhvbi9jb3JlL2ludGVyYWN0aXZlc2hlbGwucHkjTDMyMjkKCiAgICBpZiBub3QgbW9kLmJvZHk6CiAgICAgICAgcmV0dXJuCiAgICBsYXN0X25vZGUgPSBtb2QuYm9keVstMV0KCiAgICBpZiBpc2luc3RhbmNlKGxhc3Rfbm9kZSwgYXN0LkFzc2lnbik6CiAgICAgICAgIyBJbiB0aGlzIGNhc2UgdGhlcmUgY2FuIGJlIG11bHRpcGxlIHRhcmdldHMgYXMgaW4gYGEgPSBiID0gMWAuCiAgICAgICAgIyBXZSBqdXN0IHRha2UgdGhlIGZpcnN0IG9uZS4KICAgICAgICB0YXJnZXQgPSBsYXN0X25vZGUudGFyZ2V0c1swXQogICAgZWxpZiBpc2luc3RhbmNlKGxhc3Rfbm9kZSwgKGFzdC5BdWdBc3NpZ24sIGFzdC5Bbm5Bc3NpZ24pKToKICAgICAgICB0YXJnZXQgPSBsYXN0X25vZGUudGFyZ2V0CiAgICBlbHNlOgogICAgICAgIHJldHVybgogICAgaWYgaXNpbnN0YW5jZSh0YXJnZXQsIGFzdC5OYW1lKToKICAgICAgICBsYXN0X25vZGUgPSBhc3QuRXhwcihhc3QuTmFtZSh0YXJnZXQuaWQsIGFzdC5Mb2FkKCkpKQogICAgICAgIG1vZC5ib2R5LmFwcGVuZChsYXN0X25vZGUpCiAgICAgICAgIyBVcGRhdGUgdGhlIGxpbmUgbnVtYmVycyBzaG93biBpbiBlcnJvciBtZXNzYWdlcy4KICAgICAgICBhc3QuZml4X21pc3NpbmdfbG9jYXRpb25zKG1vZCkKCgpjbGFzcyBFdmFsQ29kZVJlc3VsdEV4Y2VwdGlvbihFeGNlcHRpb24pOgogICAgIiIiV2Ugd2lsbCB0aHJvdyB0aGlzIHRvIHJldHVybiBhIHJlc3VsdCBmcm9tIG91ciBjb2RlLgoKICAgIFRoaXMgYWxsb3dzIHVzIHRvIGRpc3Rpbmd1aXNoIGJldHdlZW4gImNvZGUgdXNlZCB0b3AgbGV2ZWwgYXdhaXQiIGFuZCAiY29kZQogICAgcmV0dXJuZWQgYSBnZW5lcmF0b3Igb3IgY29yb3V0aW5lIi4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2KToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHYpCiAgICAgICAgc2VsZi52YWx1ZSA9IHYKCgojIFdlIG5lZWQgRXZhbENvZGVSZXN1bHRFeGNlcHRpb24gYXZhaWxhYmxlIGluc2lkZSB0aGUgcnVubmluZyBjb2RlLiBJIHN1cHBvc2UKIyB3ZSBjb3VsZCBpbXBvcnQgaXQsIHdyYXAgYWxsIG9mIHRoZSBjb2RlIGluIGEgdHJ5L2ZpbmFsbHkgYmxvY2ssIGFuZCBkZWxldGUgaXQKIyBhZ2FpbiBpbiB0aGUgZmluYWxseSBibG9jayBidXQgSSB0aGluayB0aGlzIGlzIHRoZSBiZXN0IHdheS4KIwojIFB1dCBpdCBpbnRvIGEgbGlzdCB0byBhdm9pZCBicmVha2luZyBDUHl0aG9uIHRlc3QgdGVzdF9pbmhlcml0YW5jZQojICh0ZXN0LnRlc3RfYmFzZWV4Y2VwdGlvbi5FeGNlcHRpb25DbGFzc1Rlc3RzKSB3aGljaCBleGFtaW5lcyBhbGwgRXhjZXB0aW9ucyBpbgojIGJ1aWx0aW5zLgpidWlsdGlucy5fX19FdmFsQ29kZVJlc3VsdEV4Y2VwdGlvbiA9IFtFdmFsQ29kZVJlc3VsdEV4Y2VwdGlvbl0gICMgdHlwZTogaWdub3JlCgojIFdlIHdpbGwgc3Vic3RpdHV0ZSBpbiB0aGUgdmFsdWUgb2YgeCB3ZSBhcmUgdHJ5aW5nIHRvIHJldHVybi4KX3JhaXNlX3RlbXBsYXRlX2FzdCA9IGFzdC5wYXJzZSgicmFpc2UgX19fRXZhbENvZGVSZXN1bHRFeGNlcHRpb25bMF0oeCkiKS5ib2R5WzBdCgoKZGVmIF9sYXN0X2V4cHJfdG9fcmFpc2UobW9kOiBhc3QuTW9kdWxlKToKICAgICIiIklmIHRoZSBmaW5hbCBhc3Qgbm9kZSBpcyBhIHN0YXRlbWVudCwgcmFpc2UgYW4gRXZhbENvZGVSZXN1bHRFeGNlcHRpb24KICAgIHdpdGggdGhlIHZhbHVlIG9mIHRoZSBzdGF0ZW1lbnQuCiAgICAiIiIKICAgIGlmIG5vdCBtb2QuYm9keToKICAgICAgICByZXR1cm4KICAgIGxhc3Rfbm9kZSA9IG1vZC5ib2R5Wy0xXQogICAgaWYgbm90IGlzaW5zdGFuY2UobW9kLmJvZHlbLTFdLCAoYXN0LkV4cHIsIGFzdC5Bd2FpdCkpOgogICAgICAgIHJldHVybgogICAgcmFpc2VfZXhwciA9IGRlZXBjb3B5KF9yYWlzZV90ZW1wbGF0ZV9hc3QpCiAgICAjIFJlcGxhY2UgeCB3aXRoIG91ciB2YWx1ZSBpbiBfcmFpc2VfdGVtcGxhdGVfYXN0LgogICAgcmFpc2VfZXhwci5leGMuYXJnc1swXSA9IGxhc3Rfbm9kZS52YWx1ZSAgIyB0eXBlOiBpZ25vcmUKICAgIG1vZC5ib2R5Wy0xXSA9IHJhaXNlX2V4cHIKCgpkZWYgX3BhcnNlX2FuZF9jb21waWxlX2dlbigKICAgIHNvdXJjZTogc3RyLAogICAgKiwKICAgIHJldHVybl9tb2RlOiBzdHIgPSAibGFzdF9leHByIiwKICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbjogYm9vbCA9IFRydWUsCiAgICBtb2RlPSJleGVjIiwKICAgIGZpbGVuYW1lOiBzdHIgPSAiPGV4ZWM+IiwKICAgIGZsYWdzOiBpbnQgPSAweDAsCikgLT4gR2VuZXJhdG9yW2FzdC5Nb2R1bGUsIGFzdC5Nb2R1bGUsIENvZGVUeXBlXToKICAgICIiIlBhcnNlIGBgc291cmNlYGAsIHRoZW4geWllbGQgdGhlIEFTVCwgdGhlbiBjb21waWxlIHRoZSBBU1QgYW5kIHJldHVybiB0aGUKICAgIGNvZGUgb2JqZWN0LgoKICAgIEJ5IHlpZWxkaW5nIHRoZSBhc3QsIHdlIGdpdmUgY2FsbGVycyB0aGUgb3Bwb3J0dW5pdHkgdG8gZG8gZnVydGhlciBhc3QKICAgIG1hbmlwdWxhdGlvbnMuIEJlY2F1c2UgZ2VuZXJhdG9ycyBhcmUgYW5ub3lpbmcgdG8gY2FsbCwgdGhpcyBpcyB3cmFwcGVkIGluCiAgICB0aGUgRXhlY3V0b3IgY2xhc3MuCiAgICAiIiIKICAgICMgaGFuZGxlIG1pcy1pbmRlbnRlZCBpbnB1dCBmcm9tIG11bHRpLWxpbmUgc3RyaW5ncwogICAgc291cmNlID0gZGVkZW50KHNvdXJjZSkKCiAgICBtb2QgPSBjb21waWxlKHNvdXJjZSwgZmlsZW5hbWUsIG1vZGUsIGZsYWdzIHwgYXN0LlB5Q0ZfT05MWV9BU1QpCgogICAgIyBQYXVzZSBoZXJlLCBhbGxvdyBjYWxsZXIgdG8gdHJhbnNmb3JtIGFzdCBpZiB0aGV5IGxpa2UuCiAgICBtb2QgPSB5aWVsZCBtb2QKCiAgICBpZiBxdWlldF90cmFpbGluZ19zZW1pY29sb24gYW5kIHNob3VsZF9xdWlldChzb3VyY2UpOgogICAgICAgIHJldHVybl9tb2RlID0gIm5vbmUiCgogICAgaWYgcmV0dXJuX21vZGUgPT0gImxhc3RfZXhwcl9vcl9hc3NpZ24iOgogICAgICAgICMgYWRkIGV4dHJhIGV4cHJlc3Npb24gd2l0aCBqdXN0IHRoZSBMLXZhbHVlIHNvIHRoYXQgd2UgY2FuIGhhbmRsZSBpdAogICAgICAgICMgd2l0aCB0aGUgbGFzdF9leHByIGNvZGUuCiAgICAgICAgX2xhc3RfYXNzaWduX3RvX2V4cHIobW9kKQoKICAgIGlmIHJldHVybl9tb2RlLnN0YXJ0c3dpdGgoImxhc3RfZXhwciIpOiAgIyBsYXN0X2V4cHIgb3IgbGFzdF9leHByX29yX2Fzc2lnbgogICAgICAgIF9sYXN0X2V4cHJfdG9fcmFpc2UobW9kKQoKICAgIGFzdC5maXhfbWlzc2luZ19sb2NhdGlvbnMobW9kKQogICAgcmV0dXJuIGNvbXBpbGUobW9kLCBmaWxlbmFtZSwgbW9kZSwgZmxhZ3M9ZmxhZ3MpCgoKY2xhc3MgQ29kZVJ1bm5lcjoKICAgICIiIlRoaXMgY2xhc3MgYWxsb3dzIGZpbmUgY29udHJvbCBvdmVyIHRoZSBleGVjdXRpb24gb2YgYSBjb2RlIGJsb2NrLgoKICAgIEl0IGlzIHByaW1hcmlseSBpbnRlbmRlZCBmb3IgUkVQTHMgYW5kIG90aGVyIHNvcGhpc3RpY2F0ZWQgY29uc3VtZXJzIHRoYXQKICAgIG1heSB3aXNoIHRvIGFkZCB0aGVpciBvd24gQVNUIHRyYW5zZm9ybWF0aW9ucywgc2VwYXJhdGVseSBzaWduYWwgdG8gdGhlIHVzZXIKICAgIHdoZW4gcGFyc2luZyBpcyBjb21wbGV0ZSwgZXRjLiBUaGUgc2ltcGxlciA6YW55OmBldmFsX2NvZGVgIGFuZAogICAgOmFueTpgZXZhbF9jb2RlX2FzeW5jYCBhcGlzIHNob3VsZCBiZSBwcmVmZXJlZCB3aGVuIHRoZWlyIGZsZXhpYmlsaXR5CiAgICBzdWZmaWNlcy4KCiAgICBQYXJhbWV0ZXJzCiAgICAtLS0tLS0tLS0tCiAgICBzb3VyY2UgOiBgYHN0cmBgCgogICAgICAgIFRoZSBQeXRob24gc291cmNlIGNvZGUgdG8gcnVuLgoKICAgIHJldHVybl9tb2RlIDogYGBzdHJgYAoKICAgICAgICBTcGVjaWZpZXMgd2hhdCBzaG91bGQgYmUgcmV0dXJuZWQsIG11c3QgYmUgb25lIG9mIGBgJ2xhc3RfZXhwcidgYCwKICAgICAgICBgYCdsYXN0X2V4cHJfb3JfYXNzaWduJ2BgIG9yIGBgJ25vbmUnYGAuIE9uIG90aGVyIHZhbHVlcyBhbiBleGNlcHRpb24gaXMKICAgICAgICByYWlzZWQuIGBgJ2xhc3RfZXhwcidgYCBieSBkZWZhdWx0LgoKICAgICAgICAqIGBgJ2xhc3RfZXhwcidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbgogICAgICAgICogYGAnbGFzdF9leHByX29yX2Fzc2lnbidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbiBvciB0aGUgbGFzdCBhc3NpZ25tZW50LgogICAgICAgICogYGAnbm9uZSdgYCAtLSBhbHdheXMgcmV0dXJuIGBgTm9uZWBgLgoKICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbiA6IGBgYm9vbGBgCgogICAgICAgIFNwZWNpZmllcyB3aGV0aGVyIGEgdHJhaWxpbmcgc2VtaWNvbG9uIHNob3VsZCBzdXBwcmVzcyB0aGUgcmVzdWx0IG9yIG5vdC4KICAgICAgICBXaGVuIHRoaXMgaXMgYGBUcnVlYGAgZXhlY3V0aW5nIGBgIjErMSA7ImBgIHJldHVybnMgYGBOb25lYGAsIHdoZW4KICAgICAgICBpdCBpcyBgYEZhbHNlYGAsIGV4ZWN1dGluZyBgYCIxKzEgOyJgYCByZXR1cm4gYGAyYGAuIGBgVHJ1ZWBgIGJ5IGRlZmF1bHQuCgogICAgZmlsZW5hbWUgOiBgYHN0cmBgCgogICAgICAgIFRoZSBmaWxlIG5hbWUgdG8gdXNlIGluIGVycm9yIG1lc3NhZ2VzIGFuZCBzdGFjayB0cmFjZXMuIGBgJzxleGVjPidgYCBieSBkZWZhdWx0LgoKICAgIG1vZGUgOiBgYHN0cmBgCgogICAgICAgIFRoZSAibW9kZSIgdG8gY29tcGlsZSBpbi4gT25lIG9mIGBgImV4ZWMiYGAsIGBgInNpbmdsZSJgYCwgb3IgYGAiZXZhbCJgYC4gRGVmYXVsdHMKICAgICAgICB0byBgYCJleGVjImBgLiBGb3IgbW9zdCBwdXJwb3NlcyBpdCdzIHVubmVjZXNzYXJ5IHRvIHVzZSB0aGlzIGFyZ3VtZW50LgogICAgICAgIFNlZSB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIGJ1aWx0LWluCiAgICAgICAgYGNvbXBpbGUgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNjb21waWxlPmAgZnVuY3Rpb24uCgogICAgZmxhZ3MgOiBgYGludGBgCgogICAgICAgIFRoZSBmbGFncyB0byBjb21waWxlIHdpdGguIFNlZSB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIGJ1aWx0LWluCiAgICAgICAgYGNvbXBpbGUgPGh0dHBzOi8vZG9jcy5weXRob24ub3JnLzMvbGlicmFyeS9mdW5jdGlvbnMuaHRtbCNjb21waWxlPmAgZnVuY3Rpb24uCgogICAgQXR0cmlidXRlczoKCiAgICAgICAgYXN0IDogVGhlIGFzdCBmcm9tIHBhcnNpbmcgYGBzb3VyY2VgYC4gSWYgeW91IHdpc2ggdG8gZG8gYW4gYXN0IHRyYW5zZm9ybSwKICAgICAgICAgICAgICBtb2RpZnkgdGhpcyB2YXJpYWJsZSBiZWZvcmUgY2FsbGluZyA6YW55OmBDb2RlUnVubmVyLmNvbXBpbGVgLgoKICAgICAgICBjb2RlIDogT25jZSB5b3UgY2FsbCA6YW55OmBDb2RlUnVubmVyLmNvbXBpbGVgIHRoZSBjb21waWxlZCBjb2RlIHdpbGwKICAgICAgICAgICAgICAgYmUgYXZhaWJsZSBpbiB0aGUgY29kZSBmaWVsZC4gWW91IGNhbiBtb2RpZnkgdGhpcyB2YXJpYWJsZQogICAgICAgICAgICAgICBiZWZvcmUgY2FsbGluZyA6YW55OmBDb2RlUnVubmVyLnJ1bmAgdG8gZG8gYSBjb2RlIHRyYW5zZm9ybS4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIHNvdXJjZTogc3RyLAogICAgICAgICosCiAgICAgICAgcmV0dXJuX21vZGU6IHN0ciA9ICJsYXN0X2V4cHIiLAogICAgICAgIG1vZGU9ImV4ZWMiLAogICAgICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbjogYm9vbCA9IFRydWUsCiAgICAgICAgZmlsZW5hbWU6IHN0ciA9ICI8ZXhlYz4iLAogICAgICAgIGZsYWdzOiBpbnQgPSAweDAsCiAgICApOgogICAgICAgIHNlbGYuX2NvbXBpbGVkID0gRmFsc2UKICAgICAgICBzZWxmLl9nZW4gPSBfcGFyc2VfYW5kX2NvbXBpbGVfZ2VuKAogICAgICAgICAgICBzb3VyY2UsCiAgICAgICAgICAgIHJldHVybl9tb2RlPXJldHVybl9tb2RlLAogICAgICAgICAgICBtb2RlPW1vZGUsCiAgICAgICAgICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbj1xdWlldF90cmFpbGluZ19zZW1pY29sb24sCiAgICAgICAgICAgIGZpbGVuYW1lPWZpbGVuYW1lLAogICAgICAgICAgICBmbGFncz1mbGFncywKICAgICAgICApCiAgICAgICAgc2VsZi5hc3QgPSBuZXh0KHNlbGYuX2dlbikKCiAgICBkZWYgY29tcGlsZShzZWxmKToKICAgICAgICAiIiJDb21waWxlIHRoZSBjdXJyZW50IHZhbHVlIG9mIGBgc2VsZi5hc3RgYCBhbmQgc3RvcmUgdGhlIHJlc3VsdCBpbiBgYHNlbGYuY29kZWBgLgoKICAgICAgICBDYW4gb25seSBiZSB1c2VkIG9uY2UuIFJldHVybnMgYGBzZWxmYGAgKGNoYWluYWJsZSkuCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5fY29tcGlsZWQ6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiQWxyZWFkeSBjb21waWxlZCIpCiAgICAgICAgc2VsZi5fY29tcGlsZWQgPSBUcnVlCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIFRyaWdnZXJzIGNvbXBpbGF0aW9uCiAgICAgICAgICAgIHNlbGYuX2dlbi5zZW5kKHNlbGYuYXN0KQogICAgICAgIGV4Y2VwdCBTdG9wSXRlcmF0aW9uIGFzIGU6CiAgICAgICAgICAgICMgZ2VuZXJhdG9yIG11c3QgcmV0dXJuLCB3aGljaCByYWlzZXMgU3RvcEl0ZXJhdGlvbgogICAgICAgICAgICBzZWxmLmNvZGUgPSBlLnZhbHVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXNzZXJ0IEZhbHNlCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgcnVuKHNlbGYsIGdsb2JhbHM6IERpY3Rbc3RyLCBBbnldID0gTm9uZSwgbG9jYWxzOiBEaWN0W3N0ciwgQW55XSA9IE5vbmUpOgogICAgICAgICIiIkV4ZWN1dGVzIGBgc2VsZi5jb2RlYGAuCgogICAgICAgIENhbiBvbmx5IGJlIHVzZWQgYWZ0ZXIgY2FsbGluZyBjb21waWxlLiBUaGUgY29kZSBtYXkgbm90IHVzZSB0b3AgbGV2ZWwKICAgICAgICBhd2FpdCwgdXNlIDphbnk6YENvZGVSdW5uZXIucnVuX2FzeW5jYCBmb3IgY29kZSB0aGF0IHVzZXMgdG9wIGxldmVsCiAgICAgICAgYXdhaXQuCgogICAgICAgIFBhcmFtZXRlcnMKICAgICAgICAtLS0tLS0tLS0tCiAgICAgICAgZ2xvYmFscyA6IGBgZGljdGBgCgogICAgICAgICAgICBUaGUgZ2xvYmFsIHNjb3BlIGluIHdoaWNoIHRvIGV4ZWN1dGUgY29kZS4gVGhpcyBpcyB1c2VkIGFzIHRoZSBgYGdsb2JhbHNgYAogICAgICAgICAgICBwYXJhbWV0ZXIgZm9yIGBgZXhlY2BgLiBJZiBgYGdsb2JhbHNgYCBpcyBhYnNlbnQsIGEgbmV3IGVtcHR5IGRpY3Rpb25hcnkgaXMgdXNlZC4KICAgICAgICAgICAgU2VlIGB0aGUgZXhlYyBkb2N1bWVudGF0aW9uCiAgICAgICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgICAgICBsb2NhbHMgOiBgYGRpY3RgYAoKICAgICAgICAgICAgVGhlIGxvY2FsIHNjb3BlIGluIHdoaWNoIHRvIGV4ZWN1dGUgY29kZS4gVGhpcyBpcyB1c2VkIGFzIHRoZSBgYGxvY2Fsc2BgCiAgICAgICAgICAgIHBhcmFtZXRlciBmb3IgYGBleGVjYGAuIElmIGBgbG9jYWxzYGAgaXMgYWJzZW50LCB0aGUgdmFsdWUgb2YgYGBnbG9iYWxzYGAgaXMKICAgICAgICAgICAgdXNlZC4KICAgICAgICAgICAgU2VlIGB0aGUgZXhlYyBkb2N1bWVudGF0aW9uCiAgICAgICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgICAgICBSZXR1cm5zCiAgICAgICAgLS0tLS0tLQogICAgICAgIEFueQoKICAgICAgICAgICAgSWYgdGhlIGxhc3Qgbm9ud2hpdGVzcGFjZSBjaGFyYWN0ZXIgb2YgYGBzb3VyY2VgYCBpcyBhIHNlbWljb2xvbiwKICAgICAgICAgICAgcmV0dXJuIGBgTm9uZWBgLiBJZiB0aGUgbGFzdCBzdGF0ZW1lbnQgaXMgYW4gZXhwcmVzc2lvbiwgcmV0dXJuIHRoZQogICAgICAgICAgICByZXN1bHQgb2YgdGhlIGV4cHJlc3Npb24uIFVzZSB0aGUgYGByZXR1cm5fbW9kZWBgIGFuZAogICAgICAgICAgICBgYHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbmBgIHBhcmFtZXRlcnMgdG8gbW9kaWZ5IHRoaXMgZGVmYXVsdAogICAgICAgICAgICBiZWhhdmlvci4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5fY29tcGlsZWQ6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiTm90IHlldCBjb21waWxlZCIpCiAgICAgICAgaWYgc2VsZi5jb2RlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgY29yb3V0aW5lID0gZXZhbChzZWxmLmNvZGUsIGdsb2JhbHMsIGxvY2FscykKICAgICAgICAgICAgaWYgY29yb3V0aW5lOgogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKAogICAgICAgICAgICAgICAgICAgICJVc2VkIGV2YWxfY29kZSB3aXRoIFRPUF9MRVZFTF9BV0FJVC4gVXNlIHJ1bl9hc3luYyBmb3IgdGhpcyBpbnN0ZWFkLiIKICAgICAgICAgICAgICAgICkKICAgICAgICBleGNlcHQgRXZhbENvZGVSZXN1bHRFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgIyBGaW5hbCBleHByZXNzaW9uIGZyb20gY29kZSByZXR1cm5zIGhlcmUKICAgICAgICAgICAgcmV0dXJuIGUudmFsdWUKCiAgICBhc3luYyBkZWYgcnVuX2FzeW5jKAogICAgICAgIHNlbGYsIGdsb2JhbHM6IERpY3Rbc3RyLCBBbnldID0gTm9uZSwgbG9jYWxzOiBEaWN0W3N0ciwgQW55XSA9IE5vbmUKICAgICk6CiAgICAgICAgIiIiUnVucyBgYHNlbGYuY29kZWBgIHdoaWNoIG1heSB1c2UgdG9wIGxldmVsIGF3YWl0LgoKICAgICAgICBDYW4gb25seSBiZSB1c2VkIGFmdGVyIGNhbGxpbmcgOmFueTpgQ29kZVJ1bm5lci5jb21waWxlYC4gSWYKICAgICAgICBgYHNlbGYuY29kZWBgIHVzZXMgdG9wIGxldmVsIGF3YWl0LCBhdXRvbWF0aWNhbGx5IGF3YWl0cyB0aGUgcmVzdWx0aW5nCiAgICAgICAgY29yb3V0aW5lLgoKICAgICAgICBQYXJhbWV0ZXJzCiAgICAgICAgLS0tLS0tLS0tLQogICAgICAgIGdsb2JhbHMgOiBgYGRpY3RgYAoKICAgICAgICAgICAgVGhlIGdsb2JhbCBzY29wZSBpbiB3aGljaCB0byBleGVjdXRlIGNvZGUuIFRoaXMgaXMgdXNlZCBhcyB0aGUgYGBnbG9iYWxzYGAKICAgICAgICAgICAgcGFyYW1ldGVyIGZvciBgYGV4ZWNgYC4gSWYgYGBnbG9iYWxzYGAgaXMgYWJzZW50LCBhIG5ldyBlbXB0eSBkaWN0aW9uYXJ5IGlzIHVzZWQuCiAgICAgICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgICAgICA8aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI2V4ZWM+YF8gZm9yIG1vcmUgaW5mby4KCiAgICAgICAgbG9jYWxzIDogYGBkaWN0YGAKCiAgICAgICAgICAgIFRoZSBsb2NhbCBzY29wZSBpbiB3aGljaCB0byBleGVjdXRlIGNvZGUuIFRoaXMgaXMgdXNlZCBhcyB0aGUgYGBsb2NhbHNgYAogICAgICAgICAgICBwYXJhbWV0ZXIgZm9yIGBgZXhlY2BgLiBJZiBgYGxvY2Fsc2BgIGlzIGFic2VudCwgdGhlIHZhbHVlIG9mIGBgZ2xvYmFsc2BgIGlzCiAgICAgICAgICAgIHVzZWQuCiAgICAgICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgICAgICA8aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI2V4ZWM+YF8gZm9yIG1vcmUgaW5mby4KCiAgICAgICAgUmV0dXJucwogICAgICAgIC0tLS0tLS0KICAgICAgICBBbnkKICAgICAgICAgICAgSWYgdGhlIGxhc3Qgbm9ud2hpdGVzcGFjZSBjaGFyYWN0ZXIgb2YgYGBzb3VyY2VgYCBpcyBhIHNlbWljb2xvbiwKICAgICAgICAgICAgcmV0dXJuIGBgTm9uZWBgLiBJZiB0aGUgbGFzdCBzdGF0ZW1lbnQgaXMgYW4gZXhwcmVzc2lvbiwgcmV0dXJuIHRoZQogICAgICAgICAgICByZXN1bHQgb2YgdGhlIGV4cHJlc3Npb24uIFVzZSB0aGUgYGByZXR1cm5fbW9kZWBgIGFuZAogICAgICAgICAgICBgYHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbmBgIHBhcmFtZXRlcnMgdG8gbW9kaWZ5IHRoaXMgZGVmYXVsdAogICAgICAgICAgICBiZWhhdmlvci4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5fY29tcGlsZWQ6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiTm90IHlldCBjb21waWxlZCIpCiAgICAgICAgaWYgc2VsZi5jb2RlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRyeToKICAgICAgICAgICAgY29yb3V0aW5lID0gZXZhbChzZWxmLmNvZGUsIGdsb2JhbHMsIGxvY2FscykKICAgICAgICAgICAgaWYgY29yb3V0aW5lOgogICAgICAgICAgICAgICAgYXdhaXQgY29yb3V0aW5lCiAgICAgICAgZXhjZXB0IEV2YWxDb2RlUmVzdWx0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJldHVybiBlLnZhbHVlCgoKZGVmIGV2YWxfY29kZSgKICAgIHNvdXJjZTogc3RyLAogICAgZ2xvYmFsczogT3B0aW9uYWxbRGljdFtzdHIsIEFueV1dID0gTm9uZSwKICAgIGxvY2FsczogT3B0aW9uYWxbRGljdFtzdHIsIEFueV1dID0gTm9uZSwKICAgICosCiAgICByZXR1cm5fbW9kZTogc3RyID0gImxhc3RfZXhwciIsCiAgICBxdWlldF90cmFpbGluZ19zZW1pY29sb246IGJvb2wgPSBUcnVlLAogICAgZmlsZW5hbWU6IHN0ciA9ICI8ZXhlYz4iLAogICAgZmxhZ3M6IGludCA9IDB4MCwKKSAtPiBBbnk6CiAgICAiIiJSdW5zIGEgc3RyaW5nIGFzIFB5dGhvbiBzb3VyY2UgY29kZS4KCiAgICBQYXJhbWV0ZXJzCiAgICAtLS0tLS0tLS0tCiAgICBzb3VyY2UgOiBgYHN0cmBgCgogICAgICAgIFRoZSBQeXRob24gc291cmNlIGNvZGUgdG8gcnVuLgoKICAgIGdsb2JhbHMgOiBgYGRpY3RgYAoKICAgICAgICBUaGUgZ2xvYmFsIHNjb3BlIGluIHdoaWNoIHRvIGV4ZWN1dGUgY29kZS4gVGhpcyBpcyB1c2VkIGFzIHRoZSBgYGdsb2JhbHNgYAogICAgICAgIHBhcmFtZXRlciBmb3IgYGBleGVjYGAuIElmIGBgZ2xvYmFsc2BgIGlzIGFic2VudCwgYSBuZXcgZW1wdHkgZGljdGlvbmFyeSBpcyB1c2VkLgogICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgIGxvY2FscyA6IGBgZGljdGBgCgogICAgICAgIFRoZSBsb2NhbCBzY29wZSBpbiB3aGljaCB0byBleGVjdXRlIGNvZGUuIFRoaXMgaXMgdXNlZCBhcyB0aGUgYGBsb2NhbHNgYAogICAgICAgIHBhcmFtZXRlciBmb3IgYGBleGVjYGAuIElmIGBgbG9jYWxzYGAgaXMgYWJzZW50LCB0aGUgdmFsdWUgb2YgYGBnbG9iYWxzYGAgaXMKICAgICAgICB1c2VkLgogICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgIHJldHVybl9tb2RlIDogYGBzdHJgYAoKICAgICAgICBTcGVjaWZpZXMgd2hhdCBzaG91bGQgYmUgcmV0dXJuZWQsIG11c3QgYmUgb25lIG9mIGBgJ2xhc3RfZXhwcidgYCwKICAgICAgICBgYCdsYXN0X2V4cHJfb3JfYXNzaWduJ2BgIG9yIGBgJ25vbmUnYGAuIE9uIG90aGVyIHZhbHVlcyBhbiBleGNlcHRpb24gaXMKICAgICAgICByYWlzZWQuIGBgJ2xhc3RfZXhwcidgYCBieSBkZWZhdWx0LgoKICAgICAgICAqIGBgJ2xhc3RfZXhwcidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbgogICAgICAgICogYGAnbGFzdF9leHByX29yX2Fzc2lnbidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbiBvciB0aGUgbGFzdCBhc3NpZ25tZW50LgogICAgICAgICogYGAnbm9uZSdgYCAtLSBhbHdheXMgcmV0dXJuIGBgTm9uZWBgLgoKICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbiA6IGBgYm9vbGBgCgogICAgICAgIFNwZWNpZmllcyB3aGV0aGVyIGEgdHJhaWxpbmcgc2VtaWNvbG9uIHNob3VsZCBzdXBwcmVzcyB0aGUgcmVzdWx0IG9yIG5vdC4KICAgICAgICBXaGVuIHRoaXMgaXMgYGBUcnVlYGAgZXhlY3V0aW5nIGBgIjErMSA7ImBgIHJldHVybnMgYGBOb25lYGAsIHdoZW4KICAgICAgICBpdCBpcyBgYEZhbHNlYGAsIGV4ZWN1dGluZyBgYCIxKzEgOyJgYCByZXR1cm4gYGAyYGAuIGBgVHJ1ZWBgIGJ5IGRlZmF1bHQuCgogICAgZmlsZW5hbWUgOiBgYHN0cmBgCgogICAgICAgIFRoZSBmaWxlIG5hbWUgdG8gdXNlIGluIGVycm9yIG1lc3NhZ2VzIGFuZCBzdGFjayB0cmFjZXMuIGBgJzxleGVjPidgYCBieSBkZWZhdWx0LgoKICAgIFJldHVybnMKICAgIC0tLS0tLS0KICAgIEFueQoKICAgICAgICBJZiB0aGUgbGFzdCBub253aGl0ZXNwYWNlIGNoYXJhY3RlciBvZiBgYHNvdXJjZWBgIGlzIGEgc2VtaWNvbG9uLCByZXR1cm4KICAgICAgICBgYE5vbmVgYC4gSWYgdGhlIGxhc3Qgc3RhdGVtZW50IGlzIGFuIGV4cHJlc3Npb24sIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZQogICAgICAgIGV4cHJlc3Npb24uIFVzZSB0aGUgYGByZXR1cm5fbW9kZWBgIGFuZCBgYHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbmBgCiAgICAgICAgcGFyYW1ldGVycyB0byBtb2RpZnkgdGhpcyBkZWZhdWx0IGJlaGF2aW9yLgogICAgIiIiCiAgICByZXR1cm4gKAogICAgICAgIENvZGVSdW5uZXIoCiAgICAgICAgICAgIHNvdXJjZSwKICAgICAgICAgICAgcmV0dXJuX21vZGU9cmV0dXJuX21vZGUsCiAgICAgICAgICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbj1xdWlldF90cmFpbGluZ19zZW1pY29sb24sCiAgICAgICAgICAgIGZpbGVuYW1lPWZpbGVuYW1lLAogICAgICAgICAgICBmbGFncz1mbGFncywKICAgICAgICApCiAgICAgICAgLmNvbXBpbGUoKQogICAgICAgIC5ydW4oZ2xvYmFscywgbG9jYWxzKQogICAgKQoKCmFzeW5jIGRlZiBldmFsX2NvZGVfYXN5bmMoCiAgICBzb3VyY2U6IHN0ciwKICAgIGdsb2JhbHM6IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXSA9IE5vbmUsCiAgICBsb2NhbHM6IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXSA9IE5vbmUsCiAgICAqLAogICAgcmV0dXJuX21vZGU6IHN0ciA9ICJsYXN0X2V4cHIiLAogICAgcXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uOiBib29sID0gVHJ1ZSwKICAgIGZpbGVuYW1lOiBzdHIgPSAiPGV4ZWM+IiwKICAgIGZsYWdzOiBpbnQgPSAweDAsCikgLT4gQW55OgogICAgIiIiUnVucyBhIGNvZGUgc3RyaW5nIGFzeW5jaHJvbm91c2x5LgoKICAgIFVzZXMgYFB5Q0ZfQUxMT1dfVE9QX0xFVkVMX0FXQUlUCiAgICA8aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy9saWJyYXJ5L2FzdC5odG1sI2FzdC5QeUNGX0FMTE9XX1RPUF9MRVZFTF9BV0FJVD5gXwogICAgdG8gY29tcGlsZSB0aGUgY29kZS4KCiAgICBQYXJhbWV0ZXJzCiAgICAtLS0tLS0tLS0tCiAgICBzb3VyY2UgOiBgYHN0cmBgCgogICAgICAgIFRoZSBQeXRob24gc291cmNlIGNvZGUgdG8gcnVuLgoKICAgIGdsb2JhbHMgOiBgYGRpY3RgYAoKICAgICAgICBUaGUgZ2xvYmFsIHNjb3BlIGluIHdoaWNoIHRvIGV4ZWN1dGUgY29kZS4gVGhpcyBpcyB1c2VkIGFzIHRoZSBgYGdsb2JhbHNgYAogICAgICAgIHBhcmFtZXRlciBmb3IgYGBleGVjYGAuIElmIGBgZ2xvYmFsc2BgIGlzIGFic2VudCwgYSBuZXcgZW1wdHkgZGljdGlvbmFyeSBpcyB1c2VkLgogICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgIGxvY2FscyA6IGBgZGljdGBgCgogICAgICAgIFRoZSBsb2NhbCBzY29wZSBpbiB3aGljaCB0byBleGVjdXRlIGNvZGUuIFRoaXMgaXMgdXNlZCBhcyB0aGUgYGBsb2NhbHNgYAogICAgICAgIHBhcmFtZXRlciBmb3IgYGBleGVjYGAuIElmIGBgbG9jYWxzYGAgaXMgYWJzZW50LCB0aGUgdmFsdWUgb2YgYGBnbG9iYWxzYGAgaXMKICAgICAgICB1c2VkLgogICAgICAgIFNlZSBgdGhlIGV4ZWMgZG9jdW1lbnRhdGlvbgogICAgICAgIDxodHRwczovL2RvY3MucHl0aG9uLm9yZy8zL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjZXhlYz5gXyBmb3IgbW9yZSBpbmZvLgoKICAgIHJldHVybl9tb2RlIDogYGBzdHJgYAoKICAgICAgICBTcGVjaWZpZXMgd2hhdCBzaG91bGQgYmUgcmV0dXJuZWQsIG11c3QgYmUgb25lIG9mIGBgJ2xhc3RfZXhwcidgYCwKICAgICAgICBgYCdsYXN0X2V4cHJfb3JfYXNzaWduJ2BgIG9yIGBgJ25vbmUnYGAuIE9uIG90aGVyIHZhbHVlcyBhbiBleGNlcHRpb24gaXMKICAgICAgICByYWlzZWQuIGBgJ2xhc3RfZXhwcidgYCBieSBkZWZhdWx0LgoKICAgICAgICAqIGBgJ2xhc3RfZXhwcidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbgogICAgICAgICogYGAnbGFzdF9leHByX29yX2Fzc2lnbidgYCAtLSByZXR1cm4gdGhlIGxhc3QgZXhwcmVzc2lvbiBvciB0aGUgbGFzdCBhc3NpZ25tZW50LgogICAgICAgICogYGAnbm9uZSdgYCAtLSBhbHdheXMgcmV0dXJuIGBgTm9uZWBgLgoKICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbiA6IGBgYm9vbGBgCgogICAgICAgIFNwZWNpZmllcyB3aGV0aGVyIGEgdHJhaWxpbmcgc2VtaWNvbG9uIHNob3VsZCBzdXBwcmVzcyB0aGUgcmVzdWx0IG9yIG5vdC4KICAgICAgICBXaGVuIHRoaXMgaXMgYGBUcnVlYGAgZXhlY3V0aW5nIGBgIjErMSA7ImBgIHJldHVybnMgYGBOb25lYGAsIHdoZW4KICAgICAgICBpdCBpcyBgYEZhbHNlYGAsIGV4ZWN1dGluZyBgYCIxKzEgOyJgYCByZXR1cm4gYGAyYGAuIGBgVHJ1ZWBgIGJ5IGRlZmF1bHQuCgogICAgZmlsZW5hbWUgOiBgYHN0cmBgCgogICAgICAgIFRoZSBmaWxlIG5hbWUgdG8gdXNlIGluIGVycm9yIG1lc3NhZ2VzIGFuZCBzdGFjayB0cmFjZXMuIGBgJzxleGVjPidgYCBieSBkZWZhdWx0LgoKICAgIFJldHVybnMKICAgIC0tLS0tLS0KICAgIEFueQogICAgICAgIElmIHRoZSBsYXN0IG5vbndoaXRlc3BhY2UgY2hhcmFjdGVyIG9mIGBgc291cmNlYGAgaXMgYSBzZW1pY29sb24sIHJldHVybgogICAgICAgIGBgTm9uZWBgLiBJZiB0aGUgbGFzdCBzdGF0ZW1lbnQgaXMgYW4gZXhwcmVzc2lvbiwgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlCiAgICAgICAgZXhwcmVzc2lvbi4gVXNlIHRoZSBgYHJldHVybl9tb2RlYGAgYW5kIGBgcXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uYGAKICAgICAgICBwYXJhbWV0ZXJzIHRvIG1vZGlmeSB0aGlzIGRlZmF1bHQgYmVoYXZpb3IuCiAgICAiIiIKICAgIGZsYWdzID0gZmxhZ3Mgb3IgYXN0LlB5Q0ZfQUxMT1dfVE9QX0xFVkVMX0FXQUlUICAjIHR5cGU6IGlnbm9yZQogICAgcmV0dXJuICgKICAgICAgICBhd2FpdCBDb2RlUnVubmVyKAogICAgICAgICAgICBzb3VyY2UsCiAgICAgICAgICAgIHJldHVybl9tb2RlPXJldHVybl9tb2RlLAogICAgICAgICAgICBxdWlldF90cmFpbGluZ19zZW1pY29sb249cXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uLAogICAgICAgICAgICBmaWxlbmFtZT1maWxlbmFtZSwKICAgICAgICAgICAgZmxhZ3M9ZmxhZ3MsCiAgICAgICAgKQogICAgICAgIC5jb21waWxlKCkKICAgICAgICAucnVuX2FzeW5jKGdsb2JhbHMsIGxvY2FscykKICAgICkKCgpkZWYgZmluZF9pbXBvcnRzKHNvdXJjZTogc3RyKSAtPiBMaXN0W3N0cl06CiAgICAiIiIKICAgIEZpbmRzIHRoZSBpbXBvcnRzIGluIGEgUHl0aG9uIHNvdXJjZSBjb2RlIHN0cmluZwoKICAgIFBhcmFtZXRlcnMKICAgIC0tLS0tLS0tLS0KICAgIHNvdXJjZSA6IHN0cgogICAgICAgVGhlIFB5dGhvbiBzb3VyY2UgY29kZSB0byBpbnNwZWN0IGZvciBpbXBvcnRzLgoKICAgIFJldHVybnMKICAgIC0tLS0tLS0KICAgIGBgTGlzdFtzdHJdYGAKICAgICAgICBBIGxpc3Qgb2YgbW9kdWxlIG5hbWVzIHRoYXQgYXJlIGltcG9ydGVkIGluIGBgc291cmNlYGAuIElmIGBgc291cmNlYGAgaXMgbm90CiAgICAgICAgc3ludGFjdGljYWxseSBjb3JyZWN0IFB5dGhvbiBjb2RlIChhZnRlciBkZWRlbnRpbmcpLCByZXR1cm5zIGFuIGVtcHR5IGxpc3QuCgogICAgRXhhbXBsZXMKICAgIC0tLS0tLS0tCiAgICA+Pj4gZnJvbSBweW9kaWRlIGltcG9ydCBmaW5kX2ltcG9ydHMKICAgID4+PiBzb3VyY2UgPSAiaW1wb3J0IG51bXB5IGFzIG5wOyBpbXBvcnQgc2NpcHkuc3RhdHMiCiAgICA+Pj4gZmluZF9pbXBvcnRzKHNvdXJjZSkKICAgIFsnbnVtcHknLCAnc2NpcHknXQogICAgIiIiCiAgICAjIGhhbmRsZSBtaXMtaW5kZW50ZWQgaW5wdXQgZnJvbSBtdWx0aS1saW5lIHN0cmluZ3MKICAgIHNvdXJjZSA9IGRlZGVudChzb3VyY2UpCgogICAgdHJ5OgogICAgICAgIG1vZCA9IGFzdC5wYXJzZShzb3VyY2UpCiAgICBleGNlcHQgU3ludGF4RXJyb3I6CiAgICAgICAgcmV0dXJuIFtdCiAgICBpbXBvcnRzID0gc2V0KCkKICAgIGZvciBub2RlIGluIGFzdC53YWxrKG1vZCk6CiAgICAgICAgaWYgaXNpbnN0YW5jZShub2RlLCBhc3QuSW1wb3J0KToKICAgICAgICAgICAgZm9yIG5hbWUgaW4gbm9kZS5uYW1lczoKICAgICAgICAgICAgICAgIG5vZGVfbmFtZSA9IG5hbWUubmFtZQogICAgICAgICAgICAgICAgaW1wb3J0cy5hZGQobm9kZV9uYW1lLnNwbGl0KCIuIilbMF0pCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG5vZGUsIGFzdC5JbXBvcnRGcm9tKToKICAgICAgICAgICAgbW9kdWxlX25hbWUgPSBub2RlLm1vZHVsZQogICAgICAgICAgICBpZiBtb2R1bGVfbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaW1wb3J0cy5hZGQobW9kdWxlX25hbWUuc3BsaXQoIi4iKVswXSkKICAgIHJldHVybiBsaXN0KHNvcnRlZChpbXBvcnRzKSkKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAX3B5b2RpZGUvX2NvcmVfZG9jcy5weQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA2NDQAMDAwMDAwMAAwMDAwMDAwADAwMDAwMDI0NzIxADE0MjA1MTY2NzUwADAxNDAzNQAgMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmcm9tIHR5cGluZyBpbXBvcnQgQW55LCBDYWxsYWJsZSwgSXRlcmFibGUKZnJvbSBpbyBpbXBvcnQgSU9CYXNlCgojIEFsbCBkb2NzdHJpbmdzIGZvciBwdWJsaWMgYGNvcmVgIEFQSXMgc2hvdWxkIGJlIGV4dHJhY3RlZCBmcm9tIGhlcmUuIFdlIHVzZQojIHRoZSB1dGlsaXRpZXMgaW4gYGRvY3N0cmluZy5weWAgYW5kIGBkb2NzdHJpbmcuY2AgdG8gZm9ybWF0IHRoZW0KIyBhcHByb3ByaWF0ZWx5LgoKIyBTcGhpbnggdXNlcyBfX25hbWVfXyB0byBkZXRlcm1pbmUgdGhlIHBhdGhzIGFuZCBzdWNoLiBJdCBsb29rcyBiZXR0ZXIgZm9yIGl0CiMgdG8gcmVmZXIgdG8gZS5nLiwgYHB5b2RpZGUuSnNQcm94eWAgdGhhbiBgX3B5b2RpZGUuX2NvcmVfZG9jcy5Kc1Byb3h5YC4KX3NhdmVfbmFtZSA9IF9fbmFtZV9fCl9fbmFtZV9fID0gInB5b2RpZGUiCgojIEZyb20ganNwcm94eS5jCmNsYXNzIEpzRXhjZXB0aW9uKEV4Y2VwdGlvbik6CiAgICAiIiIKICAgIEEgd3JhcHBlciBhcm91bmQgYSBKYXZhU2NyaXB0IEVycm9yIHRvIGFsbG93IGl0IHRvIGJlIHRocm93biBpbiBQeXRob24uCiAgICBTZWUgOnJlZjpgdHlwZS10cmFuc2xhdGlvbnMtZXJyb3JzYC4KICAgICIiIgoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGpzX2Vycm9yKHNlbGYpIC0+ICJKc1Byb3h5IjoKICAgICAgICAiIiJUaGUgb3JpZ2luYWwgSmF2YVNjcmlwdCBlcnJvciIiIgogICAgICAgIHJldHVybiBKc1Byb3h5KCkKCgpjbGFzcyBDb252ZXJzaW9uRXJyb3IoRXhjZXB0aW9uKToKICAgICIiIkFuIGVycm9yIHRocm93biB3aGVuIGNvbnZlcnNpb24gYmV0d2VlbiBKYXZhU2NyaXB0IGFuZCBQeXRob24gZmFpbHMuIiIiCgoKY2xhc3MgSnNQcm94eToKICAgICIiIkEgcHJveHkgdG8gbWFrZSBhIEphdmFTY3JpcHQgb2JqZWN0IGJlaGF2ZSBsaWtlIGEgUHl0aG9uIG9iamVjdAoKICAgIEZvciBtb3JlIGluZm9ybWF0aW9uIHNlZSB0aGUgOnJlZjpgdHlwZS10cmFuc2xhdGlvbnNgIGRvY3VtZW50YXRpb24uIEluCiAgICBwYXJ0aWN1bGFyLCBzZWUKICAgIDpyZWY6YHRoZSBsaXN0IG9mIF9fZHVuZGVyX18gbWV0aG9kcyA8dHlwZS10cmFuc2xhdGlvbnMtanNwcm94eT5gCiAgICB0aGF0IGFyZSAoY29uZGl0aW9uYWxseSkgaW1wbGVtZW50ZWQgb24gOmFueTpgSnNQcm94eWAuCiAgICAiIiIKCiAgICBkZWYgb2JqZWN0X2VudHJpZXMoc2VsZikgLT4gIkpzUHJveHkiOgogICAgICAgICJUaGUgSmF2YVNjcmlwdCBBUEkgYGBPYmplY3QuZW50cmllcyhvYmplY3QpYGAiCgogICAgZGVmIG9iamVjdF9rZXlzKHNlbGYpIC0+ICJKc1Byb3h5IjoKICAgICAgICAiVGhlIEphdmFTY3JpcHQgQVBJIGBgT2JqZWN0LmtleXMob2JqZWN0KWBgIgoKICAgIGRlZiBvYmplY3RfdmFsdWVzKHNlbGYpIC0+ICJKc1Byb3h5IjoKICAgICAgICAiVGhlIEphdmFTY3JpcHQgQVBJIGBgT2JqZWN0LnZhbHVlcyhvYmplY3QpYGAiCgogICAgZGVmIG5ldyhzZWxmLCAqYXJncywgKiprd2FyZ3MpIC0+ICJKc1Byb3h5IjoKICAgICAgICAiIiJDb25zdHJ1Y3QgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIEphdmFTY3JpcHQgb2JqZWN0IiIiCgogICAgZGVmIHRvX3B5KHNlbGYsICosIGRlcHRoOiBpbnQgPSAtMSkgLT4gQW55OgogICAgICAgICIiIkNvbnZlcnQgdGhlIDpjbGFzczpgSnNQcm94eWAgdG8gYSBuYXRpdmUgUHl0aG9uIG9iamVjdCBhcyBiZXN0IGFzCiAgICAgICAgcG9zc2libGUuCgogICAgICAgIEJ5IGRlZmF1bHQsIGRvZXMgYSBkZWVwIGNvbnZlcnNpb24sIGlmIGEgc2hhbGxvdyBjb252ZXJzaW9uIGlzCiAgICAgICAgZGVzaXJlZCwgeW91IGNhbiB1c2UgYGBwcm94eS50b19weShkZXB0aD0xKWBgLiBTZWUKICAgICAgICA6cmVmOmB0eXBlLXRyYW5zbGF0aW9ucy1qc3Byb3h5LXRvLXB5YCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KICAgICAgICAiIiIKICAgICAgICBwYXNzCgogICAgZGVmIHRoZW4oc2VsZiwgb25mdWxmaWxsZWQ6IENhbGxhYmxlLCBvbnJlamVjdGVkOiBDYWxsYWJsZSkgLT4gIlByb21pc2UiOgogICAgICAgICIiIlRoZSBgYFByb21pc2UudGhlbmBgIEFQSSwgd3JhcHBlZCB0byBtYW5hZ2UgdGhlIGxpZmV0aW1lcyBvZiB0aGUKICAgICAgICBoYW5kbGVycy4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFTY3JpcHQgb2JqZWN0IGhhcyBhICJ0aGVuIiBtZXRob2QuCiAgICAgICAgUHlvZGlkZSB3aWxsIGF1dG9tYXRpY2FsbHkgcmVsZWFzZSB0aGUgcmVmZXJlbmNlcyB0byB0aGUgaGFuZGxlcnMKICAgICAgICB3aGVuIHRoZSBwcm9taXNlIHJlc29sdmVzLgogICAgICAgICIiIgoKICAgIGRlZiBjYXRjaChzZWxmLCBvbnJlamVjdGVkOiBDYWxsYWJsZSkgLT4gIlByb21pc2UiOgogICAgICAgICIiIlRoZSBgYFByb21pc2UuY2F0Y2hgYCBBUEksIHdyYXBwZWQgdG8gbWFuYWdlIHRoZSBsaWZldGltZXMgb2YgdGhlCiAgICAgICAgaGFuZGxlci4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFTY3JpcHQgb2JqZWN0IGhhcyBhICJ0aGVuIiBtZXRob2QuCiAgICAgICAgUHlvZGlkZSB3aWxsIGF1dG9tYXRpY2FsbHkgcmVsZWFzZSB0aGUgcmVmZXJlbmNlcyB0byB0aGUgaGFuZGxlcgogICAgICAgIHdoZW4gdGhlIHByb21pc2UgcmVzb2x2ZXMuCiAgICAgICAgIiIiCgogICAgZGVmIGZpbmFsbHlfKHNlbGYsIG9uZmluYWxseTogQ2FsbGFibGUpIC0+ICJQcm9taXNlIjoKICAgICAgICAiIiJUaGUgYGBQcm9taXNlLmZpbmFsbHlgYCBBUEksIHdyYXBwZWQgdG8gbWFuYWdlIHRoZSBsaWZldGltZXMgb2YKICAgICAgICB0aGUgaGFuZGxlci4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFTY3JpcHQgb2JqZWN0IGhhcyBhICJ0aGVuIiBtZXRob2QuCiAgICAgICAgUHlvZGlkZSB3aWxsIGF1dG9tYXRpY2FsbHkgcmVsZWFzZSB0aGUgcmVmZXJlbmNlcyB0byB0aGUgaGFuZGxlcgogICAgICAgIHdoZW4gdGhlIHByb21pc2UgcmVzb2x2ZXMuIE5vdGUgdGhlIHRyYWlsaW5nIHVuZGVyc2NvcmUgaW4gdGhlIG5hbWU7CiAgICAgICAgdGhpcyBpcyBuZWVkZWQgYmVjYXVzZSBgYGZpbmFsbHlgYCBpcyBhIHJlc2VydmVkIGtleXdvcmQgaW4gUHl0aG9uLgogICAgICAgICIiIgoKICAgICMgVGhlcmUgYXJlIG5vIHR5cGVzIGZvciBidWZmZXJzOgogICAgIyBodHRwczovL2dpdGh1Yi5jb20vcHl0aG9uL3R5cGluZy9pc3N1ZXMvNTkzCiAgICAjIGh0dHBzOi8vYnVncy5weXRob24ub3JnL2lzc3VlMjc1MDEKICAgICMgVGhpcyBpcyBqdXN0IGZvciBkb2NzIHNvIGxldHMganVzdCBtYWtlIHNvbWV0aGluZyB1cD8KCiAgICAjIEFyZ3VtZW50IHNob3VsZCBiZSBhIGJ1ZmZlci4KICAgICMgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9weXRob24vdHlwaW5nL2lzc3Vlcy81OTMKICAgIGRlZiBhc3NpZ24oc2VsZiwgcmhzOiBBbnkpOgogICAgICAgICIiIkFzc2lnbiBmcm9tIGEgUHl0aG9uIGJ1ZmZlciBpbnRvIHRoZSBKYXZhU2NyaXB0IGJ1ZmZlci4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFTY3JpcHQgb2JqZWN0IGlzIGFuIEFycmF5QnVmZmVyIG9yCiAgICAgICAgYW4gQXJyYXlCdWZmZXIgdmlldy4KICAgICAgICAiIiIKCiAgICAjIEFyZ3VtZW50IHNob3VsZCBiZSBhIGJ1ZmZlci4KICAgICMgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9weXRob24vdHlwaW5nL2lzc3Vlcy81OTMKICAgIGRlZiBhc3NpZ25fdG8oc2VsZiwgdG86IEFueSk6CiAgICAgICAgIiIiQXNzaWduIHRvIGEgUHl0aG9uIGJ1ZmZlciBmcm9tIHRoZSBKYXZhU2NyaXB0IGJ1ZmZlci4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFTY3JpcHQgb2JqZWN0IGlzIGFuIEFycmF5QnVmZmVyIG9yCiAgICAgICAgYW4gQXJyYXlCdWZmZXIgdmlldy4KICAgICAgICAiIiIKCiAgICBkZWYgdG9fbWVtb3J5dmlldyhzZWxmKSAtPiBtZW1vcnl2aWV3OgogICAgICAgICIiIkNvbnZlcnQgdGhlIGJ1ZmZlciB0byBhIG1lbW9yeXZpZXcuCgogICAgICAgIENvcGllcyB0aGUgZGF0YSBvbmNlLiBUaGlzIGN1cnJlbnRseSBoYXMgdGhlIHNhbWUgZWZmZWN0IGFzIDphbnk6YHRvX3B5YC4KICAgICAgICBQcmVzZW50IG9ubHkgaWYgdGhlIHdyYXBwZWQgSmF2YXNjcmlwdCBvYmplY3QgaXMgYW4gQXJyYXlCdWZmZXIgb3IKICAgICAgICBhbiBBcnJheUJ1ZmZlciB2aWV3LgogICAgICAgICIiIgoKICAgIGRlZiB0b19ieXRlcyhzZWxmKSAtPiBieXRlczoKICAgICAgICAiIiJDb252ZXJ0IHRoZSBidWZmZXIgdG8gYSBieXRlcyBvYmplY3QuCgogICAgICAgIENvcGllcyB0aGUgZGF0YSBvbmNlLgogICAgICAgIFByZXNlbnQgb25seSBpZiB0aGUgd3JhcHBlZCBKYXZhc2NyaXB0IG9iamVjdCBpcyBhbiBBcnJheUJ1ZmZlciBvcgogICAgICAgIGFuIEFycmF5QnVmZmVyIHZpZXcuCiAgICAgICAgIiIiCgogICAgZGVmIHRvX2ZpbGUoc2VsZiwgZmlsZTogSU9CYXNlKToKICAgICAgICAiIiJXcml0ZXMgdGhlIGVudGlyZSBidWZmZXIgdG8gYSBmaWxlLgoKICAgICAgICBXaWxsIHdyaXRlIHRoZSBlbnRpcmUgY29udGVudHMgb2YgdGhlIGJ1ZmZlciB0byB0aGUgY3VycmVudCBwb3NpdGlvbiBvZgogICAgICAgIHRoZSBmaWxlLgoKICAgICAgICBQcmVzZW50IG9ubHkgaWYgdGhlIHdyYXBwZWQgSmF2YXNjcmlwdCBvYmplY3QgaXMgYW4gQXJyYXlCdWZmZXIgb3IgYW4KICAgICAgICBBcnJheUJ1ZmZlciB2aWV3LgoKICAgICAgICBFeGFtcGxlCiAgICAgICAgLS0tLS0tLS0tLS0tCiAgICAgICAgPj4+IGltcG9ydCBweXRlc3Q7IHB5dGVzdC5za2lwKCkKICAgICAgICA+Pj4gZnJvbSBqcyBpbXBvcnQgVWludDhBcnJheQogICAgICAgID4+PiB4ID0gVWludDhBcnJheS5uZXcocmFuZ2UoMTApKQogICAgICAgID4+PiB3aXRoIG9wZW4oJ2ZpbGUuYmluJywgJ3diJykgYXMgZmg6CiAgICAgICAgLi4uICAgIHgudG9fZmlsZShmaCkKICAgICAgICB3aGljaCBpcyBlcXVpdmFsZW50IHRvLAogICAgICAgID4+PiB3aXRoIG9wZW4oJ2ZpbGUuYmluJywgJ3diJykgYXMgZmg6CiAgICAgICAgLi4uICAgIGRhdGEgPSB4LnRvX2J5dGVzKCkKICAgICAgICAuLi4gICAgZmgud3JpdGUoZGF0YSkKICAgICAgICBidXQgdGhlIGxhdHRlciBjb3BpZXMgdGhlIGRhdGEgdHdpY2Ugd2hlcmVhcyB0aGUgZm9ybWVyIG9ubHkgY29waWVzIHRoZQogICAgICAgIGRhdGEgb25jZS4KICAgICAgICAiIiIKCiAgICBkZWYgZnJvbV9maWxlKHNlbGYsIGZpbGU6IElPQmFzZSk6CiAgICAgICAgIiIiUmVhZHMgZnJvbSBhIGZpbGUgaW50byB0aGUgYnVmZmVyLgoKICAgICAgICBXaWxsIHRyeSB0byByZWFkIGEgY2h1bmsgb2YgZGF0YSB0aGUgc2FtZSBzaXplIGFzIHRoZSBidWZmZXIgZnJvbQogICAgICAgIHRoZSBjdXJyZW50IHBvc2l0aW9uIG9mIHRoZSBmaWxlLgoKICAgICAgICBQcmVzZW50IG9ubHkgaWYgdGhlIHdyYXBwZWQgSmF2YXNjcmlwdCBvYmplY3QgaXMgYW4gQXJyYXlCdWZmZXIgb3IgYW4KICAgICAgICBBcnJheUJ1ZmZlciB2aWV3LgoKICAgICAgICBFeGFtcGxlCiAgICAgICAgLS0tLS0tLS0tLS0tCiAgICAgICAgPj4+IGltcG9ydCBweXRlc3Q7IHB5dGVzdC5za2lwKCkKICAgICAgICA+Pj4gZnJvbSBqcyBpbXBvcnQgVWludDhBcnJheQogICAgICAgID4+PiAjIHRoZSBKc1Byb3h5IG5lZWQgdG8gYmUgcHJlLWFsbG9jYXRlZAogICAgICAgID4+PiB4ID0gVWludDhBcnJheS5uZXcocmFuZ2UoMTApKQogICAgICAgID4+PiB3aXRoIG9wZW4oJ2ZpbGUuYmluJywgJ3JiJykgYXMgZmg6CiAgICAgICAgLi4uICAgIHgucmVhZF9maWxlKGZoKQogICAgICAgIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8KICAgICAgICA+Pj4geCA9IFVpbnQ4QXJyYXkubmV3KHJhbmdlKDEwKSkKICAgICAgICA+Pj4gd2l0aCBvcGVuKCdmaWxlLmJpbicsICdyYicpIGFzIGZoOgogICAgICAgIC4uLiAgICBjaHVuayA9IGZoLnJlYWQoc2l6ZT14LmJ5dGVMZW5ndGgpCiAgICAgICAgLi4uICAgIHguYXNzaWduKGNodW5rKQogICAgICAgIGJ1dCB0aGUgbGF0dGVyIGNvcGllcyB0aGUgZGF0YSB0d2ljZSB3aGVyZWFzIHRoZSBmb3JtZXIgb25seSBjb3BpZXMgdGhlCiAgICAgICAgZGF0YSBvbmNlLgogICAgICAgICIiIgoKICAgIGRlZiBfaW50b19maWxlKHNlbGYsIGZpbGU6IElPQmFzZSk6CiAgICAgICAgIiIiV2lsbCB3cml0ZSB0aGUgZW50aXJlIGNvbnRlbnRzIG9mIHRoZSBidWZmZXIgaW50byBhIGZpbGUgdXNpbmcKICAgICAgICBgYGNhbk93biA6IHRydWVgYCB3aXRob3V0IGFueSBjb3B5LiBBZnRlciB0aGlzLCB0aGUgYnVmZmVyIGNhbm5vdCBiZQogICAgICAgIHVzZWQgYWdhaW4uCgogICAgICAgIElmIGBgZmlsZWBgIGlzIG5vdCBlbXB0eSwgaXRzIGNvbnRlbnRzIHdpbGwgYmUgb3ZlcndyaXR0ZW4hCgogICAgICAgIE9ubHkgYGBNRU1GU2BgIGNhcmVzIGFib3V0IHRoZSBgYGNhbk93bmBgIGZsYWcsIG90aGVyIGZpbGUgc3lzdGVtcyB3aWxsCiAgICAgICAganVzdCBpZ25vcmUgaXQuCgogICAgICAgIFByZXNlbnQgb25seSBpZiB0aGUgd3JhcHBlZCBKYXZhc2NyaXB0IG9iamVjdCBpcyBhbiBBcnJheUJ1ZmZlciBvciBhbgogICAgICAgIEFycmF5QnVmZmVyIHZpZXcuCgogICAgICAgIEV4YW1wbGUKICAgICAgICAtLS0tLS0tLS0tLS0KICAgICAgICA+Pj4gaW1wb3J0IHB5dGVzdDsgcHl0ZXN0LnNraXAoKQogICAgICAgID4+PiBmcm9tIGpzIGltcG9ydCBVaW50OEFycmF5CiAgICAgICAgPj4+IHggPSBVaW50OEFycmF5Lm5ldyhyYW5nZSgxMCkpCiAgICAgICAgPj4+IHdpdGggb3BlbignZmlsZS5iaW4nLCAnd2InKSBhcyBmaDoKICAgICAgICAuLi4gICAgeC5faW50b19maWxlKGZoKQogICAgICAgIHdoaWNoIGlzIHNpbWlsYXIgdG8KICAgICAgICA+Pj4gd2l0aCBvcGVuKCdmaWxlLmJpbicsICd3YicpIGFzIGZoOgogICAgICAgIC4uLiAgICBkYXRhID0geC50b19ieXRlcygpCiAgICAgICAgLi4uICAgIGZoLndyaXRlKGRhdGEpCiAgICAgICAgYnV0IHRoZSBsYXR0ZXIgY29waWVzIHRoZSBkYXRhIG9uY2Ugd2hlcmVhcyB0aGUgZm9ybWVyIGRvZXNuJ3QgY29weSB0aGUKICAgICAgICBkYXRhLgogICAgICAgICIiIgoKICAgIGRlZiB0b19zdHJpbmcoc2VsZiwgZW5jb2Rpbmc9Tm9uZSkgLT4gc3RyOgogICAgICAgICIiIkNvbnZlcnQgdGhlIGJ1ZmZlciB0byBhIHN0cmluZyBvYmplY3QuCgogICAgICAgIENvcGllcyB0aGUgZGF0YSB0d2ljZS4KCiAgICAgICAgVGhlIGVuY29kaW5nIGFyZ3VtZW50IHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBKYXZhc2NyaXB0CiAgICAgICAgW2BgVGV4dERlY29kZXJgYF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1RleHREZWNvZGVyKQogICAgICAgIGNvbnN0cnVjdG9yLiBJdCBzaG91bGQgYmUgb25lIG9mIHRoZSBlbmNvZGluZ3MgbGlzdGVkIGluIHRoZSB0YWJsZSBoZXJlOgogICAgICAgIGBodHRwczovL2VuY29kaW5nLnNwZWMud2hhdHdnLm9yZy8jbmFtZXMtYW5kLWxhYmVsc2AuIFRoZSBkZWZhdWx0CiAgICAgICAgZW5jb2RpbmcgaXMgdXRmOC4KCiAgICAgICAgUHJlc2VudCBvbmx5IGlmIHRoZSB3cmFwcGVkIEphdmFzY3JpcHQgb2JqZWN0IGlzIGFuIEFycmF5QnVmZmVyIG9yCiAgICAgICAgYW4gQXJyYXlCdWZmZXIgdmlldy4KICAgICAgICAiIiIKCgojIGZyb20gcHlwcm94eS5jCgoKZGVmIGNyZWF0ZV9vbmNlX2NhbGxhYmxlKG9iajogQ2FsbGFibGUpIC0+IEpzUHJveHk6CiAgICAiIiJXcmFwIGEgUHl0aG9uIGNhbGxhYmxlIGluIGEgSmF2YVNjcmlwdCBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgb25jZS4KCiAgICBBZnRlciBiZWluZyBjYWxsZWQgdGhlIHByb3h5IHdpbGwgZGVjcmVtZW50IHRoZSByZWZlcmVuY2UgY291bnQKICAgIG9mIHRoZSBDYWxsYWJsZS4gVGhlIEphdmFTY3JpcHQgZnVuY3Rpb24gYWxzbyBoYXMgYSBgYGRlc3Ryb3lgYCBBUEkgdGhhdAogICAgY2FuIGJlIHVzZWQgdG8gcmVsZWFzZSB0aGUgcHJveHkgd2l0aG91dCBjYWxsaW5nIGl0LgogICAgIiIiCiAgICByZXR1cm4gb2JqICAjIHR5cGU6IGlnbm9yZQoKCmRlZiBjcmVhdGVfcHJveHkob2JqOiBBbnkpIC0+IEpzUHJveHk6CiAgICAiIiJDcmVhdGUgYSBgYEpzUHJveHlgYCBvZiBhIGBgUHlQcm94eWBgLgoKICAgIFRoaXMgYWxsb3dzIGV4cGxpY2l0IGNvbnRyb2wgb3ZlciB0aGUgbGlmZXRpbWUgb2YgdGhlIGBgUHlQcm94eWBgIGZyb20KICAgIFB5dGhvbjogY2FsbCB0aGUgYGBkZXN0cm95YGAgQVBJIHdoZW4gZG9uZS4KICAgICIiIgogICAgcmV0dXJuIG9iagoKCiMgZnJvbSBweXRob24yanMKCgpkZWYgdG9fanMoCiAgICBvYmo6IEFueSwKICAgICosCiAgICBkZXB0aDogaW50ID0gLTEsCiAgICBweXByb3hpZXM6IEpzUHJveHkgPSBOb25lLAogICAgY3JlYXRlX3B5cHJveGllczogYm9vbCA9IFRydWUsCiAgICBkaWN0X2NvbnZlcnRlcjogQ2FsbGFibGVbW0l0ZXJhYmxlW0pzUHJveHldXSwgSnNQcm94eV0gPSBOb25lLAopIC0+IEpzUHJveHk6CiAgICAiIiJDb252ZXJ0IHRoZSBvYmplY3QgdG8gSmF2YVNjcmlwdC4KCiAgICBUaGlzIGlzIHNpbWlsYXIgdG8gOmFueTpgUHlQcm94eS50b0pzYCwgYnV0IGZvciB1c2UgZnJvbSBQeXRob24uIElmIHRoZQogICAgb2JqZWN0IGNhbiBiZSBpbXBsaWNpdGx5IHRyYW5zbGF0ZWQgdG8gSmF2YVNjcmlwdCwgaXQgd2lsbCBiZSByZXR1cm5lZAogICAgdW5jaGFuZ2VkLiBJZiB0aGUgb2JqZWN0IGNhbm5vdCBiZSBjb252ZXJ0ZWQgaW50byBKYXZhU2NyaXB0LCB0aGlzCiAgICBtZXRob2Qgd2lsbCByZXR1cm4gYSA6YW55OmBKc1Byb3h5YCBvZiBhIDphbnk6YFB5UHJveHlgLCBhcyBpZiB5b3UgaGFkCiAgICB1c2VkIDphbnk6YHB5b2RpZGUuY3JlYXRlX3Byb3h5YC4KCiAgICBTZWUgOnJlZjpgdHlwZS10cmFuc2xhdGlvbnMtcHlwcm94eS10by1qc2AgZm9yIG1vcmUgaW5mb3JtYXRpb24uCgogICAgUGFyYW1ldGVycwogICAgLS0tLS0tLS0tLQogICAgb2JqIDogQW55CiAgICAgICAgVGhlIFB5dGhvbiBvYmplY3QgdG8gY29udmVydAoKICAgIGRlcHRoIDogaW50LCBkZWZhdWx0PS0xCiAgICAgICAgVGhlIG1heGltdW0gZGVwdGggdG8gZG8gdGhlIGNvbnZlcnNpb24uIE5lZ2F0aXZlIG51bWJlcnMgYXJlIHRyZWF0ZWQKICAgICAgICBhcyBpbmZpbml0ZS4gU2V0IHRoaXMgdG8gMSB0byBkbyBhIHNoYWxsb3cgY29udmVyc2lvbi4KCiAgICBweXByb3hpZXM6IEpzUHJveHksIGRlZmF1bHQgPSBOb25lCiAgICAgICAgU2hvdWxkIGJlIGEgSmF2YVNjcmlwdCBgYEFycmF5YGAuIElmIHByb3ZpZGVkLCBhbnkgYGBQeVByb3hpZXNgYCBnZW5lcmF0ZWQKICAgICAgICB3aWxsIGJlIHN0b3JlZCBoZXJlLiBZb3UgY2FuIGxhdGVyIHVzZSA6YW55OmBkZXN0cm95X3Byb3hpZXNgIGlmIHlvdSB3YW50CiAgICAgICAgdG8gZGVzdHJveSB0aGUgcHJveGllcyBmcm9tIFB5dGhvbiAob3IgZnJvbSBKYXZhU2NyaXB0IHlvdSBjYW4ganVzdCBpdGVyYXRlCiAgICAgICAgb3ZlciB0aGUgYGBBcnJheWBgIGFuZCBkZXN0cm95IHRoZSBwcm94aWVzKS4KCiAgICBjcmVhdGVfcHlwcm94aWVzOiBib29sLCBkZWZhdWx0PVRydWUKICAgICAgICBJZiB5b3Ugc2V0IHRoaXMgdG8gRmFsc2UsIDphbnk6YHRvX2pzYCB3aWxsIHJhaXNlIGFuIGVycm9yCgogICAgZGljdF9jb252ZXJ0ZXI6IENhbGxhYmxlW1tJdGVyYWJsZVtKc1Byb3h5XV0sIEpzUHJveHldLCBkZWZhdWlsdCA9IE5vbmUKICAgICAgICBUaGlzIGNvbnZlcnRlciBpZiBwcm92aWRlZCByZWNpZXZlcyBhIChKYXZhU2NyaXB0KSBpdGVyYWJsZSBvZgogICAgICAgIChKYXZhU2NyaXB0KSBwYWlycyBba2V5LCB2YWx1ZV0uIEl0IGlzIGV4cGVjdGVkIHRvIHJldHVybiB0aGUKICAgICAgICBkZXNpcmVkIHJlc3VsdCBvZiB0aGUgZGljdCBjb252ZXJzaW9uLiBTb21lIHN1Z2dlc3RlZCB2YWx1ZXMgZm9yCiAgICAgICAgdGhpcyBhcmd1bWVudDoKCiAgICAgICAgICAgIGpzLk1hcC5uZXcgLS0gc2ltaWxhciB0byB0aGUgZGVmYXVsdCBiZWhhdmlvcgogICAgICAgICAgICBqcy5BcnJheS5mcm9tIC0tIGNvbnZlcnQgdG8gYW4gYXJyYXkgb2YgZW50cmllcwogICAgICAgICAgICBqcy5PYmplY3QuZnJvbUVudHJpZXMgLS0gY29udmVydCB0byBhIEphdmFTY3JpcHQgb2JqZWN0CiAgICAiIiIKICAgIHJldHVybiBvYmoKCgpjbGFzcyBQcm9taXNlKEpzUHJveHkpOgogICAgcGFzcwoKCmRlZiBkZXN0cm95X3Byb3hpZXMocHlwcm94aWVzOiBKc1Byb3h5KToKICAgICIiIkRlc3Ryb3kgYWxsIFB5UHJveGllcyBpbiBhIEphdmFTY3JpcHQgYXJyYXkuCgogICAgcHlwcm94aWVzIG11c3QgYmUgYSBKc1Byb3h5IG9mIHR5cGUgUHlQcm94eVtdLiBJbnRlbmRlZCBmb3IgdXNlIHdpdGggdGhlCiAgICBhcnJheXMgY3JlYXRlZCBmcm9tIHRoZSAicHlwcm94aWVzIiBhcmd1bWVudCBvZiA6YW55OmBQeVByb3h5LnRvSnNgIGFuZAogICAgOmFueTpgdG9fanNgLiBUaGlzIG1ldGhvZCBpcyBuZWNlc3NhcnkgYmVjYXVzZSBpbmRleGluZyB0aGUgQXJyYXkgZnJvbQogICAgUHl0aG9uIGF1dG9tYXRpY2FsbHkgdW53cmFwcyB0aGUgUHlQcm94eSBpbnRvIHRoZSB3cmFwcGVkIFB5dGhvbiBvYmplY3QuCiAgICAiIiIKICAgIHBhc3MKCgpfX25hbWVfXyA9IF9zYXZlX25hbWUKZGVsIF9zYXZlX25hbWUKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABfcHlvZGlkZS9faW1wb3J0aG9vay5weQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDAwMDY0NAAwMDAwMDAwADAwMDAwMDAAMDAwMDAwMTAyMjQAMTQyMDUxNjY3NTAAMDE0MjYxACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGZyb20gaW1wb3J0bGliLmFiYyBpbXBvcnQgTWV0YVBhdGhGaW5kZXIsIExvYWRlcgpmcm9tIGltcG9ydGxpYi51dGlsIGltcG9ydCBzcGVjX2Zyb21fbG9hZGVyCmltcG9ydCBzeXMKCgpjbGFzcyBKc0ZpbmRlcihNZXRhUGF0aEZpbmRlcik6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5qc3Byb3hpZXMgPSB7fQoKICAgIGRlZiBmaW5kX3NwZWMoc2VsZiwgZnVsbG5hbWUsIHBhdGgsIHRhcmdldD1Ob25lKToKICAgICAgICBbcGFyZW50LCBfLCBjaGlsZF0gPSBmdWxsbmFtZS5ycGFydGl0aW9uKCIuIikKICAgICAgICBpZiBwYXJlbnQ6CiAgICAgICAgICAgIHBhcmVudF9tb2R1bGUgPSBzeXMubW9kdWxlc1twYXJlbnRdCiAgICAgICAgICAgIGlmIG5vdCBpc2luc3RhbmNlKHBhcmVudF9tb2R1bGUsIEpzUHJveHkpOgogICAgICAgICAgICAgICAgIyBOb3Qgb25lIG9mIHVzLgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAganNwcm94eSA9IGdldGF0dHIocGFyZW50X21vZHVsZSwgY2hpbGQpCiAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgIHJhaXNlIE1vZHVsZU5vdEZvdW5kRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgZiJObyBtb2R1bGUgbmFtZWQge2Z1bGxuYW1lIXJ9IiwgbmFtZT1mdWxsbmFtZQogICAgICAgICAgICAgICAgKSBmcm9tIE5vbmUKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoanNwcm94eSwgSnNQcm94eSk6CiAgICAgICAgICAgICAgICByYWlzZSBNb2R1bGVOb3RGb3VuZEVycm9yKAogICAgICAgICAgICAgICAgICAgIGYiTm8gbW9kdWxlIG5hbWVkIHtmdWxsbmFtZSFyfSIsIG5hbWU9ZnVsbG5hbWUKICAgICAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBqc3Byb3h5ID0gc2VsZi5qc3Byb3hpZXNbZnVsbG5hbWVdCiAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgbG9hZGVyID0gSnNMb2FkZXIoanNwcm94eSkKICAgICAgICByZXR1cm4gc3BlY19mcm9tX2xvYWRlcihmdWxsbmFtZSwgbG9hZGVyLCBvcmlnaW49ImphdmFzY3JpcHQiKQoKICAgIGRlZiByZWdpc3Rlcl9qc19tb2R1bGUoc2VsZiwgbmFtZTogc3RyLCBqc3Byb3h5KToKICAgICAgICAiIiIKICAgICAgICBSZWdpc3RlcnMgYGBqc3Byb3h5YGAgYXMgYSBKYXZhU2NyaXB0IG1vZHVsZSBuYW1lZCBgYG5hbWVgYC4gVGhlIG1vZHVsZQogICAgICAgIGNhbiB0aGVuIGJlIGltcG9ydGVkIGZyb20gUHl0aG9uIHVzaW5nIHRoZSBzdGFuZGFyZCBQeXRob24gaW1wb3J0CiAgICAgICAgc3lzdGVtLiBJZiBhbm90aGVyIG1vZHVsZSBieSB0aGUgc2FtZSBuYW1lIGhhcyBhbHJlYWR5IGJlZW4gaW1wb3J0ZWQsCiAgICAgICAgdGhpcyB3b24ndCBoYXZlIG11Y2ggZWZmZWN0IHVubGVzcyB5b3UgYWxzbyBkZWxldGUgdGhlIGltcG9ydGVkIG1vZHVsZQogICAgICAgIGZyb20gYGBzeXMubW9kdWxlc2BgLiBUaGlzIGlzIGNhbGxlZCBieSB0aGUgSmF2YVNjcmlwdCBBUEkKICAgICAgICA6YW55OmBweW9kaWRlLnJlZ2lzdGVySnNNb2R1bGVgLgoKICAgICAgICBQYXJhbWV0ZXJzCiAgICAgICAgLS0tLS0tLS0tLQogICAgICAgIG5hbWUgOiBzdHIKICAgICAgICAgICAgTmFtZSBvZiBqcyBtb2R1bGUKCiAgICAgICAganNwcm94eSA6IEpzUHJveHkKICAgICAgICAgICAgSmF2YVNjcmlwdCBvYmplY3QgYmFja2luZyB0aGUgbW9kdWxlCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UobmFtZSwgc3RyKToKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICAgICAgZiJBcmd1bWVudCAnbmFtZScgbXVzdCBiZSBhIHN0ciwgbm90IHt0eXBlKG5hbWUpLl9fbmFtZV9fIXJ9IgogICAgICAgICAgICApCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UoanNwcm94eSwgSnNQcm94eSk6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcigKICAgICAgICAgICAgICAgIGYiQXJndW1lbnQgJ2pzcHJveHknIG11c3QgYmUgYSBKc1Byb3h5LCBub3Qge3R5cGUoanNwcm94eSkuX19uYW1lX18hcn0iCiAgICAgICAgICAgICkKICAgICAgICBzZWxmLmpzcHJveGllc1tuYW1lXSA9IGpzcHJveHkKCiAgICBkZWYgdW5yZWdpc3Rlcl9qc19tb2R1bGUoc2VsZiwgbmFtZTogc3RyKToKICAgICAgICAiIiIKICAgICAgICBVbnJlZ2lzdGVycyBhIEphdmFTY3JpcHQgbW9kdWxlIHdpdGggZ2l2ZW4gbmFtZSB0aGF0IGhhcyBiZWVuIHByZXZpb3VzbHkKICAgICAgICByZWdpc3RlcmVkIHdpdGggOmFueTpgcHlvZGlkZS5yZWdpc3RlckpzTW9kdWxlYCBvcgogICAgICAgIDphbnk6YHB5b2RpZGUucmVnaXN0ZXJfanNfbW9kdWxlYC4gSWYgYSBKYXZhU2NyaXB0IG1vZHVsZSB3aXRoIHRoYXQgbmFtZQogICAgICAgIGRvZXMgbm90IGFscmVhZHkgZXhpc3QsIHdpbGwgcmFpc2UgYW4gZXJyb3IuIElmIHRoZSBtb2R1bGUgaGFzIGFscmVhZHkKICAgICAgICBiZWVuIGltcG9ydGVkLCB0aGlzIHdvbid0IGhhdmUgbXVjaCBlZmZlY3QgdW5sZXNzIHlvdSBhbHNvIGRlbGV0ZSB0aGUKICAgICAgICBpbXBvcnRlZCBtb2R1bGUgZnJvbSBgYHN5cy5tb2R1bGVzYGAuIFRoaXMgaXMgY2FsbGVkIGJ5IHRoZSBKYXZhU2NyaXB0CiAgICAgICAgQVBJIDphbnk6YHB5b2RpZGUudW5yZWdpc3RlckpzTW9kdWxlYC4KCiAgICAgICAgUGFyYW1ldGVycwogICAgICAgIC0tLS0tLS0tLS0KICAgICAgICBuYW1lIDogc3RyCiAgICAgICAgICAgIE5hbWUgb2YganMgbW9kdWxlCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBkZWwgc2VsZi5qc3Byb3hpZXNbbmFtZV0KICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoCiAgICAgICAgICAgICAgICBmIkNhbm5vdCB1bnJlZ2lzdGVyIHtuYW1lIXJ9OiBubyBKYXZhc2NyaXB0IG1vZHVsZSB3aXRoIHRoYXQgbmFtZSBpcyByZWdpc3RlcmVkIgogICAgICAgICAgICApIGZyb20gTm9uZQoKCmNsYXNzIEpzTG9hZGVyKExvYWRlcik6CiAgICBkZWYgX19pbml0X18oc2VsZiwganNwcm94eSk6CiAgICAgICAgc2VsZi5qc3Byb3h5ID0ganNwcm94eQoKICAgIGRlZiBjcmVhdGVfbW9kdWxlKHNlbGYsIHNwZWMpOgogICAgICAgIHJldHVybiBzZWxmLmpzcHJveHkKCiAgICBkZWYgZXhlY19tb2R1bGUoc2VsZiwgbW9kdWxlKToKICAgICAgICBwYXNzCgogICAgIyB1c2VkIGJ5IGltcG9ydGxpYi51dGlsLnNwZWNfZnJvbV9sb2FkZXIKICAgIGRlZiBpc19wYWNrYWdlKHNlbGYsIGZ1bGxuYW1lKToKICAgICAgICByZXR1cm4gVHJ1ZQoKCkpzUHJveHk6IHR5cGUgPSBOb25lICAjIHR5cGU6IGlnbm9yZQpqc2ZpbmRlcjogSnNGaW5kZXIgPSBKc0ZpbmRlcigpCnJlZ2lzdGVyX2pzX21vZHVsZSA9IGpzZmluZGVyLnJlZ2lzdGVyX2pzX21vZHVsZQp1bnJlZ2lzdGVyX2pzX21vZHVsZSA9IGpzZmluZGVyLnVucmVnaXN0ZXJfanNfbW9kdWxlCgoKZGVmIHJlZ2lzdGVyX2pzX2ZpbmRlcigpOgogICAgIiIiQSBib290c3RyYXAgZnVuY3Rpb24sIGNhbGxlZCBuZWFyIHRoZSBlbmQgb2YgUHlvZGlkZSBpbml0aWFsaXphdGlvbi4KCiAgICBJdCBpcyBjYWxsZWQgaW4gYGBsb2FkUHlvZGlkZWBgIGluIGBgcHlvZGlkZS5qc2BgIG9uY2UgYGBfcHlvZGlkZV9jb3JlYGAgaXMgcmVhZHkKICAgIHRvIHNldCB1cCB0aGUganMgaW1wb3J0IG1lY2hhbmlzbS4KCiAgICAgICAgMS4gUHV0IHRoZSByaWdodCB2YWx1ZSBpbnRvIHRoZSBnbG9iYWwgdmFyaWFibGUgYGBKc1Byb3h5YGAgc28gdGhhdAogICAgICAgICAgIGBgSnNGaW5kZXIuZmluZF9zcGVjYGAgY2FuIGRlY2lkZSB3aGV0aGVyIHBhcmVudCBtb2R1bGUgaXMgYSBKcyBtb2R1bGUuCiAgICAgICAgMi4gQWRkIGBganNmaW5kZXJgYCB0byBtZXRhcGF0aCB0byBhbGxvdyBqcyBpbXBvcnRzLgoKICAgIFRoaXMgbmVlZHMgdG8gYmUgYSBmdW5jdGlvbiB0byBhbGxvdyB0aGUgbGF0ZSBpbXBvcnQgZnJvbSBgYF9weW9kaWRlX2NvcmVgYC4KICAgICIiIgogICAgaW1wb3J0IF9weW9kaWRlX2NvcmUgICMgdHlwZTogaWdub3JlCgogICAgZ2xvYmFsIEpzUHJveHkKICAgIEpzUHJveHkgPSBfcHlvZGlkZV9jb3JlLkpzUHJveHkKICAgIHN5cy5tZXRhX3BhdGguYXBwZW5kKGpzZmluZGVyKSAgIyB0eXBlOiBpZ25vcmUKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF9weW9kaWRlL2NvbnNvbGUucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNjQ0ADAwMDAwMDAAMDAwMDAwMAAwMDAwMDA0MTM3MwAxNDIwNTE2Njc1MAAwMTM0MDIAIDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdXN0YXIgIAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaW1wb3J0IGFzdAppbXBvcnQgYXN5bmNpbwpmcm9tIGFzeW5jaW8gaW1wb3J0IGVuc3VyZV9mdXR1cmUsIEZ1dHVyZQpmcm9tIGNvZGVvcCBpbXBvcnQgQ29tcGlsZSwgQ29tbWFuZENvbXBpbGVyLCBfZmVhdHVyZXMgICMgdHlwZTogaWdub3JlCmZyb20gY29udGV4dGxpYiBpbXBvcnQgKAogICAgY29udGV4dG1hbmFnZXIsCiAgICByZWRpcmVjdF9zdGRvdXQsCiAgICByZWRpcmVjdF9zdGRlcnIsCiAgICBFeGl0U3RhY2ssCikKZnJvbSBjb250ZXh0bGliIGltcG9ydCBfUmVkaXJlY3RTdHJlYW0gICMgdHlwZTogaWdub3JlCmltcG9ydCBybGNvbXBsZXRlcgppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHN5cwpmcm9tIHRva2VuaXplIGltcG9ydCBUb2tlbkVycm9yCmltcG9ydCB0cmFjZWJhY2sKZnJvbSB0eXBpbmcgaW1wb3J0IExpdGVyYWwKZnJvbSB0eXBpbmcgaW1wb3J0ICgKICAgIE9wdGlvbmFsLAogICAgQ2FsbGFibGUsCiAgICBBbnksCiAgICBMaXN0LAogICAgVHVwbGUsCiAgICBVbmlvbiwKICAgIFR1cGxlLAopCgpmcm9tIF9weW9kaWRlLl9iYXNlIGltcG9ydCBzaG91bGRfcXVpZXQsIENvZGVSdW5uZXIKCl9fYWxsX18gPSBbInJlcHJfc2hvcnRlbiIsICJCQU5ORVIiLCAiQ29uc29sZSIsICJQeW9kaWRlQ29uc29sZSIsICJDb25zb2xlRnV0dXJlIl0KCgpkZWYgX2Jhbm5lcigpOgogICAgIiIiQSBiYW5uZXIgc2ltaWxhciB0byB0aGUgb25lIHByaW50ZWQgYnkgdGhlIHJlYWwgUHl0aG9uIGludGVycHJldGVyLiIiIgogICAgIyBjb3BpZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vcHl0aG9uL2NweXRob24vYmxvYi83OTlmODQ4OWQ0MThiN2Y5MjA3ZDMzM2VhYzM4MjE0OTMxYmQ3ZGNjL0xpYi9jb2RlLnB5I0wyMTQKICAgIGNwcnQgPSAnVHlwZSAiaGVscCIsICJjb3B5cmlnaHQiLCAiY3JlZGl0cyIgb3IgImxpY2Vuc2UiIGZvciBtb3JlIGluZm9ybWF0aW9uLicKICAgIHZlcnNpb24gPSBwbGF0Zm9ybS5weXRob25fdmVyc2lvbigpCiAgICBidWlsZCA9IGYiKHsnLCAnLmpvaW4ocGxhdGZvcm0ucHl0aG9uX2J1aWxkKCkpfSkiCiAgICByZXR1cm4gZiJQeXRob24ge3ZlcnNpb259IHtidWlsZH0gb24gV2ViQXNzZW1ibHkgVk1cbntjcHJ0fSIKCgpCQU5ORVIgPSBfYmFubmVyKCkKZGVsIF9iYW5uZXIKCgpjbGFzcyByZWRpcmVjdF9zdGRpbihfUmVkaXJlY3RTdHJlYW0pOgogICAgX3N0cmVhbSA9ICJzdGRpbiIKCgpjbGFzcyBfV3JpdGVTdHJlYW06CiAgICAiIiJBIHV0aWxpdHkgY2xhc3Mgc28gd2UgY2FuIHNwZWNpZnkgb3VyIG93biBoYW5kbGVycyBmb3Igd3JpdGVzIHRvIHNkb3V0LCBzdGRlcnIiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgd3JpdGVfaGFuZGxlciwgbmFtZT1Ob25lKToKICAgICAgICBzZWxmLndyaXRlX2hhbmRsZXIgPSB3cml0ZV9oYW5kbGVyCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQoKICAgIGRlZiB3cml0ZShzZWxmLCB0ZXh0KToKICAgICAgICBzZWxmLndyaXRlX2hhbmRsZXIodGV4dCkKCiAgICBkZWYgZmx1c2goc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBpc2F0dHkoc2VsZikgLT4gYm9vbDoKICAgICAgICByZXR1cm4gVHJ1ZQoKCmNsYXNzIF9SZWFkU3RyZWFtOgogICAgIiIiQSB1dGlsaXR5IGNsYXNzIHNvIHdlIGNhbiBzcGVjaWZ5IG91ciBvd24gaGFuZGxlciBmb3IgcmVhZGluZyBmcm9tIHN0ZGluIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHJlYWRfaGFuZGxlciwgbmFtZT1Ob25lKToKICAgICAgICBzZWxmLnJlYWRfaGFuZGxlciA9IHJlYWRfaGFuZGxlcgogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKCiAgICBkZWYgcmVhZGxpbmUoc2VsZiwgbj0tMSk6CiAgICAgICAgcmV0dXJuIHNlbGYucmVhZF9oYW5kbGVyKG4pCgogICAgZGVmIGZsdXNoKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgaXNhdHR5KHNlbGYpIC0+IGJvb2w6CiAgICAgICAgcmV0dXJuIFRydWUKCgpjbGFzcyBfQ29tcGlsZShDb21waWxlKToKICAgICIiIkNvbXBpbGUgY29kZSB3aXRoIENvZGVSdW5uZXIsIGFuZCByZW1lbWJlciBmdXR1cmUgaW1wb3J0cwoKICAgIEluc3RhbmNlcyBvZiB0aGlzIGNsYXNzIGJlaGF2ZSBtdWNoIGxpa2UgdGhlIGJ1aWx0LWluIGNvbXBpbGUgZnVuY3Rpb24sCiAgICBidXQgaWYgb25lIGlzIHVzZWQgdG8gY29tcGlsZSB0ZXh0IGNvbnRhaW5pbmcgYSBmdXR1cmUgc3RhdGVtZW50LCBpdAogICAgInJlbWVtYmVycyIgYW5kIGNvbXBpbGVzIGFsbCBzdWJzZXF1ZW50IHByb2dyYW0gdGV4dHMgd2l0aCB0aGUgc3RhdGVtZW50IGluCiAgICBmb3JjZS4gSXQgdXNlcyBDb2RlUnVubmVyIGluc3RlYWQgb2YgdGhlIGJ1aWx0LWluIGNvbXBpbGUuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgc2VsZiwKICAgICAgICAqLAogICAgICAgIHJldHVybl9tb2RlPSJsYXN0X2V4cHIiLAogICAgICAgIHF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbj1UcnVlLAogICAgICAgIGZsYWdzPTB4MCwKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5mbGFncyB8PSBmbGFncwogICAgICAgIHNlbGYucmV0dXJuX21vZGUgPSByZXR1cm5fbW9kZQogICAgICAgIHNlbGYucXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uID0gcXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIHNvdXJjZSwgZmlsZW5hbWUsIHN5bWJvbCkgLT4gQ29kZVJ1bm5lcjogICMgdHlwZTogaWdub3JlCiAgICAgICAgcmV0dXJuX21vZGUgPSBzZWxmLnJldHVybl9tb2RlCiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBzZWxmLnF1aWV0X3RyYWlsaW5nX3NlbWljb2xvbiBhbmQgc2hvdWxkX3F1aWV0KHNvdXJjZSk6CiAgICAgICAgICAgICAgICByZXR1cm5fbW9kZSA9IE5vbmUKICAgICAgICBleGNlcHQgKFRva2VuRXJyb3IsIFN5bnRheEVycm9yKToKICAgICAgICAgICAgIyBJbnZhbGlkIGNvZGUsIGxldCB0aGUgUHl0aG9uIHBhcnNlciB0aHJvdyB0aGUgZXJyb3IgbGF0ZXIuCiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY29kZV9ydW5uZXIgPSBDb2RlUnVubmVyKAogICAgICAgICAgICBzb3VyY2UsCiAgICAgICAgICAgIG1vZGU9c3ltYm9sLAogICAgICAgICAgICBmaWxlbmFtZT1maWxlbmFtZSwKICAgICAgICAgICAgcmV0dXJuX21vZGU9cmV0dXJuX21vZGUsCiAgICAgICAgICAgIGZsYWdzPXNlbGYuZmxhZ3MsCiAgICAgICAgKS5jb21waWxlKCkKICAgICAgICBmb3IgZmVhdHVyZSBpbiBfZmVhdHVyZXM6CiAgICAgICAgICAgIGlmIGNvZGVfcnVubmVyLmNvZGUuY29fZmxhZ3MgJiBmZWF0dXJlLmNvbXBpbGVyX2ZsYWc6CiAgICAgICAgICAgICAgICBzZWxmLmZsYWdzIHw9IGZlYXR1cmUuY29tcGlsZXJfZmxhZwogICAgICAgIHJldHVybiBjb2RlX3J1bm5lcgoKCmNsYXNzIF9Db21tYW5kQ29tcGlsZXIoQ29tbWFuZENvbXBpbGVyKToKICAgICIiIkNvbXBpbGUgY29kZSB3aXRoIENvZGVSdW5uZXIsIGFuZCByZW1lbWJlciBmdXR1cmUgaW1wb3J0cywgcmV0dXJuIE5vbmUgaWYKICAgIGNvZGUgaXMgaW5jb21wbGV0ZS4KCiAgICBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBoYXZlIF9fY2FsbF9fIG1ldGhvZHMgaWRlbnRpY2FsIGluIHNpZ25hdHVyZSB0bwogICAgY29tcGlsZTsgdGhlIGRpZmZlcmVuY2UgaXMgdGhhdCBpZiB0aGUgaW5zdGFuY2UgY29tcGlsZXMgcHJvZ3JhbSB0ZXh0CiAgICBjb250YWluaW5nIGEgX19mdXR1cmVfXyBzdGF0ZW1lbnQsIHRoZSBpbnN0YW5jZSAncmVtZW1iZXJzJyBhbmQgY29tcGlsZXMgYWxsCiAgICBzdWJzZXF1ZW50IHByb2dyYW0gdGV4dHMgd2l0aCB0aGUgc3RhdGVtZW50IGluIGZvcmNlLgoKICAgIElmIHRoZSBzb3VyY2UgaXMgZGV0ZXJtaW5lZCB0byBiZSBpbmNvbXBsZXRlLCB3aWxsIHN1cHByZXNzIHRoZSBTeW50YXhFcnJvcgogICAgYW5kIHJldHVybiBgYE5vbmVgYC4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgICosCiAgICAgICAgcmV0dXJuX21vZGU9Imxhc3RfZXhwciIsCiAgICAgICAgcXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uPVRydWUsCiAgICAgICAgZmxhZ3M9MHgwLAogICAgKToKICAgICAgICBzZWxmLmNvbXBpbGVyID0gX0NvbXBpbGUoCiAgICAgICAgICAgIHJldHVybl9tb2RlPXJldHVybl9tb2RlLAogICAgICAgICAgICBxdWlldF90cmFpbGluZ19zZW1pY29sb249cXVpZXRfdHJhaWxpbmdfc2VtaWNvbG9uLAogICAgICAgICAgICBmbGFncz1mbGFncywKICAgICAgICApCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIHNvdXJjZSwgZmlsZW5hbWU9Ijxjb25zb2xlPiIsIHN5bWJvbD0ic2luZ2xlIikgLT4gT3B0aW9uYWxbQ29kZVJ1bm5lcl06ICAjIHR5cGU6IGlnbm9yZQogICAgICAgIHJldHVybiBzdXBlcigpLl9fY2FsbF9fKHNvdXJjZSwgZmlsZW5hbWUsIHN5bWJvbCkgICMgdHlwZTogaWdub3JlCgoKSU5DT01QTEVURTogTGl0ZXJhbFsiaW5jb21wbGV0ZSJdID0gImluY29tcGxldGUiClNZTlRBWF9FUlJPUjogTGl0ZXJhbFsic3ludGF4LWVycm9yIl0gPSAic3ludGF4LWVycm9yIgpDT01QTEVURTogTGl0ZXJhbFsiY29tcGxldGUiXSA9ICJjb21wbGV0ZSIKCgpjbGFzcyBDb25zb2xlRnV0dXJlKEZ1dHVyZSk6CiAgICAiIiJBIGZ1dHVyZSB3aXRoIGV4dHJhIGZpZWxkcyB1c2VkIGFzIHRoZSByZXR1cm4gdmFsdWUgZm9yIDphbnk6YENvbnNvbGVgIGFwaXMuCgogICAgQXR0cmlidXRlcwogICAgLS0tLS0tLS0tLQogICAgc3ludGF4X2NoZWNrIDogc3RyCiAgICAgICAgT25lIG9mIGBgImluY29tcGxldGUiYGAsIGBgInN5bnRheC1lcnJvciJgYCwgb3IgYGAiY29tcGxldGUiYGAuIElmIHRoZSB2YWx1ZSBpcwogICAgICAgIGBgImluY29tcGxldGUiYGAgdGhlbiB0aGUgZnV0dXJlIGhhcyBhbHJlYWR5IGJlZW4gcmVzb2x2ZWQgd2l0aCByZXN1bHQgZXF1YWwgdG8KICAgICAgICBgYE5vbmVgYC4gSWYgdGhlIHZhbHVlIGlzIGBgInN5bnRheC1lcnJvciJgYCwgdGhlIGBgRnV0dXJlYGAgaGFzIGFscmVhZHkgYmVlbgogICAgICAgIHJlamVjdGVkIHdpdGggYSBgYFN5bnRheEVycm9yYGAuIElmIHRoZSB2YWx1ZSBpcyBgYCJjb21wbGV0ZSJgYCwgdGhlbiB0aGUgaW5wdXQKICAgICAgICBjb21wbGV0ZSBhbmQgc3ludGFjdGljYWxseSBjb3JyZWN0LgoKICAgIGZvcm1hdHRlZF9lcnJvciA6IHN0cgogICAgICAgIElmIHRoZSBgYEZ1dHVyZWBgIGlzIHJlamVjdGVkLCB0aGlzIHdpbGwgYmUgZmlsbGVkIHdpdGggYSBmb3JtYXR0ZWQgdmVyc2lvbiBvZgogICAgICAgIHRoZSBjb2RlLiBUaGlzIGlzIGEgY29udmVuaWVuY2UgdGhhdCBzaW1wbGlmaWVzIGNvZGUgYW5kIGhlbHBzIHRvIGF2b2lkIGxhcmdlCiAgICAgICAgbWVtb3J5IGxlYWtzIHdoZW4gdXNpbmcgZnJvbSBKYXZhU2NyaXB0LgoKICAgICIiIgoKICAgIGRlZiBfX2luaXRfXygKICAgICAgICBzZWxmLAogICAgICAgIHN5bnRheF9jaGVjazogVW5pb25bCiAgICAgICAgICAgIExpdGVyYWxbImluY29tcGxldGUiXSwgTGl0ZXJhbFsic3ludGF4LWVycm9yIl0sIExpdGVyYWxbImNvbXBsZXRlIl0KICAgICAgICBdLAogICAgKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnN5bnRheF9jaGVjazogVW5pb25bCiAgICAgICAgICAgIExpdGVyYWxbImluY29tcGxldGUiXSwgTGl0ZXJhbFsic3ludGF4LWVycm9yIl0sIExpdGVyYWxbImNvbXBsZXRlIl0KICAgICAgICBdID0gc3ludGF4X2NoZWNrCiAgICAgICAgc2VsZi5mb3JtYXR0ZWRfZXJyb3I6IE9wdGlvbmFsW3N0cl0gPSBOb25lCgoKY2xhc3MgQ29uc29sZToKICAgICIiIkludGVyYWN0aXZlIFB5b2RpZGUgY29uc29sZQoKICAgIEFuIGludGVyYWN0aXZlIGNvbnNvbGUgYmFzZWQgb24gdGhlIFB5dGhvbiBzdGFuZGFyZCBsaWJyYXJ5CiAgICBgY29kZS5JbnRlcmFjdGl2ZUNvbnNvbGVgIHRoYXQgbWFuYWdlcyBzdHJlYW0gcmVkaXJlY3Rpb25zIGFuZCBhc3luY2hyb25vdXMKICAgIGV4ZWN1dGlvbiBvZiB0aGUgY29kZS4KCiAgICBUaGUgc3RyZWFtIGNhbGxiYWNrcyBjYW4gYmUgbW9kaWZpZWQgZGlyZWN0bHkgYXMgbG9uZyBhcwogICAgYHBlcnNpc3RlbnRfc3RyZWFtX3JlZGlyZWN0aW9uYCBpc24ndCBpbiBlZmZlY3QuCgogICAgUGFyYW1ldGVycwogICAgLS0tLS0tLS0tLQogICAgZ2xvYmFscyA6IGBgZGljdGBgCiAgICAgICAgVGhlIGdsb2JhbCBuYW1lc3BhY2UgaW4gd2hpY2ggdG8gZXZhbHVhdGUgdGhlIGNvZGUuIERlZmF1bHRzIHRvIGEgbmV3IGVtcHR5IGRpY3Rpb25hcnkuCgogICAgc3RkaW5fY2FsbGJhY2sgOiBgYENhbGxhYmxlW1tzdHJdLCBOb25lXWBgCiAgICAgICAgRnVuY3Rpb24gdG8gY2FsbCBhdCBlYWNoIHJlYWQgZnJvbSBgYHN5cy5zdGRpbmBgLiBEZWZhdWx0cyB0byBgYE5vbmVgYC4KCiAgICBzdGRvdXRfY2FsbGJhY2sgOiBgYENhbGxhYmxlW1tzdHJdLCBOb25lXWBgCiAgICAgICAgRnVuY3Rpb24gdG8gY2FsbCBhdCBlYWNoIHdyaXRlIHRvIGBgc3lzLnN0ZG91dGBgLiBEZWZhdWx0cyB0byBgYE5vbmVgYC4KCiAgICBzdGRlcnJfY2FsbGJhY2sgOiBgYENhbGxhYmxlW1tzdHJdLCBOb25lXWBgCiAgICAgICAgRnVuY3Rpb24gdG8gY2FsbCBhdCBlYWNoIHdyaXRlIHRvIGBgc3lzLnN0ZGVycmBgLiBEZWZhdWx0cyB0byBgYE5vbmVgYC4KCiAgICBwZXJzaXN0ZW50X3N0cmVhbV9yZWRpcmVjdGlvbiA6IGBgYm9vbGBgCiAgICAgICAgU2hvdWxkIHJlZGlyZWN0aW9uIG9mIHN0YW5kYXJkIHN0cmVhbXMgYmUga2VwdCBiZXR3ZWVuIGNhbGxzIHRvIDphbnk6YHJ1bmNvZGUgPENvbnNvbGUucnVuY29kZT5gPwogICAgICAgIERlZmF1bHRzIHRvIGBgRmFsc2VgYC4KCiAgICBmaWxlbmFtZSA6IGBgc3RyYGAKICAgICAgICBUaGUgZmlsZSBuYW1lIHRvIHJlcG9ydCBpbiBlcnJvciBtZXNzYWdlcy4gRGVmYXVsdHMgdG8gYGA8Y29uc29sZT5gYC4KCiAgICBBdHRyaWJ1dGVzCiAgICAtLS0tLS0tLS0tCiAgICAgICAgZ2xvYmFscyA6IGBgRGljdFtzdHIsIEFueV1gYAogICAgICAgICAgICBUaGUgbmFtZXNwYWNlIHVzZWQgYXMgdGhlIGdsb2JhbAoKICAgICAgICBzdGRpbl9jYWxsYmFjayA6IGBgQ2FsbGJhY2tbW3N0cl0sIE5vbmVdYGAKICAgICAgICAgICAgRnVuY3Rpb24gdG8gY2FsbCBhdCBlYWNoIHJlYWQgZnJvbSBgYHN5cy5zdGRpbmBgLgoKICAgICAgICBzdGRvdXRfY2FsbGJhY2sgOiBgYENhbGxiYWNrW1tzdHJdLCBOb25lXWBgCiAgICAgICAgICAgIEZ1bmN0aW9uIHRvIGNhbGwgYXQgZWFjaCB3cml0ZSB0byBgYHN5cy5zdGRvdXRgYC4KCiAgICAgICAgc3RkZXJyX2NhbGxiYWNrIDogYGBDYWxsYmFja1tbc3RyXSwgTm9uZV1gYAogICAgICAgICAgICBGdW5jdGlvbiB0byBjYWxsIGF0IGVhY2ggd3JpdGUgdG8gYGBzeXMuc3RkZXJyYGAuCgogICAgICAgIGJ1ZmZlciA6IGBgTGlzdFtzdHJdYGAKICAgICAgICAgICAgVGhlIGxpc3Qgb2Ygc3RyaW5ncyB0aGF0IGhhdmUgYmVlbiA6YW55OmBwdXNoZWQgPENvbnNvbGUucHVzaD5gIHRvIHRoZSBjb25zb2xlLgoKICAgICAgICBjb21wbGV0ZXJfd29yZF9icmVha19jaGFyYWN0ZXJzIDogYGBzdHJgYAogICAgICAgICAgICBUaGUgc2V0IG9mIGNoYXJhY3RlcnMgY29uc2lkZXJlZCBieSA6YW55OmBjb21wbGV0ZSA8Q29uc29sZS5jb21wbGV0ZT5gIHRvIGJlIHdvcmQgYnJlYWtzLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKAogICAgICAgIHNlbGYsCiAgICAgICAgZ2xvYmFsczogT3B0aW9uYWxbZGljdF0gPSBOb25lLAogICAgICAgICosCiAgICAgICAgc3RkaW5fY2FsbGJhY2s6IE9wdGlvbmFsW0NhbGxhYmxlW1tzdHJdLCBOb25lXV0gPSBOb25lLAogICAgICAgIHN0ZG91dF9jYWxsYmFjazogT3B0aW9uYWxbQ2FsbGFibGVbW3N0cl0sIE5vbmVdXSA9IE5vbmUsCiAgICAgICAgc3RkZXJyX2NhbGxiYWNrOiBPcHRpb25hbFtDYWxsYWJsZVtbc3RyXSwgTm9uZV1dID0gTm9uZSwKICAgICAgICBwZXJzaXN0ZW50X3N0cmVhbV9yZWRpcmVjdGlvbjogYm9vbCA9IEZhbHNlLAogICAgICAgIGZpbGVuYW1lOiBzdHIgPSAiPGNvbnNvbGU+IiwKICAgICk6CiAgICAgICAgaWYgZ2xvYmFscyBpcyBOb25lOgogICAgICAgICAgICBnbG9iYWxzID0geyJfX25hbWVfXyI6ICJfX2NvbnNvbGVfXyIsICJfX2RvY19fIjogTm9uZX0KICAgICAgICBzZWxmLmdsb2JhbHMgPSBnbG9iYWxzCiAgICAgICAgc2VsZi5fc3Rkb3V0ID0gTm9uZQogICAgICAgIHNlbGYuX3N0ZGVyciA9IE5vbmUKICAgICAgICBzZWxmLnN0ZGluX2NhbGxiYWNrID0gc3RkaW5fY2FsbGJhY2sKICAgICAgICBzZWxmLnN0ZG91dF9jYWxsYmFjayA9IHN0ZG91dF9jYWxsYmFjawogICAgICAgIHNlbGYuc3RkZXJyX2NhbGxiYWNrID0gc3RkZXJyX2NhbGxiYWNrCiAgICAgICAgc2VsZi5maWxlbmFtZSA9IGZpbGVuYW1lCiAgICAgICAgc2VsZi5idWZmZXI6IExpc3Rbc3RyXSA9IFtdCiAgICAgICAgc2VsZi5fbG9jayA9IGFzeW5jaW8uTG9jaygpCiAgICAgICAgc2VsZi5fc3RyZWFtc19yZWRpcmVjdGVkID0gRmFsc2UKICAgICAgICBzZWxmLl9zdHJlYW1fZ2VuZXJhdG9yID0gTm9uZSAgIyB0cmFjayBwZXJzaXN0ZW50IHN0cmVhbSByZWRpcmVjdGlvbgogICAgICAgIGlmIHBlcnNpc3RlbnRfc3RyZWFtX3JlZGlyZWN0aW9uOgogICAgICAgICAgICBzZWxmLnBlcnNpc3RlbnRfcmVkaXJlY3Rfc3RyZWFtcygpCiAgICAgICAgc2VsZi5fY29tcGxldGVyID0gcmxjb21wbGV0ZXIuQ29tcGxldGVyKHNlbGYuZ2xvYmFscykgICMgdHlwZTogaWdub3JlCiAgICAgICAgIyBhbGwgbm9uYWxwaGFudW1zIGV4Y2VwdCAnLicKICAgICAgICAjIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcHl0aG9uL2NweXRob24vYmxvYi9hNDI1OGU4Y2Q3NzZiYTY1NWNjNTRiYTU0ZWFlZmZlZGRiMGEyNjdjL01vZHVsZXMvcmVhZGxpbmUuYyNMMTIxMQogICAgICAgIHNlbGYuY29tcGxldGVyX3dvcmRfYnJlYWtfY2hhcmFjdGVycyA9ICgKICAgICAgICAgICAgIiIiIFx0XG5gfiFAIyQlXiYqKCktPStbe119XFx8OzonXCIsPD4vPyIiIgogICAgICAgICkKICAgICAgICBzZWxmLl9jb21waWxlID0gX0NvbW1hbmRDb21waWxlcihmbGFncz1hc3QuUHlDRl9BTExPV19UT1BfTEVWRUxfQVdBSVQpICAjIHR5cGU6IGlnbm9yZQoKICAgIGRlZiBwZXJzaXN0ZW50X3JlZGlyZWN0X3N0cmVhbXMoc2VsZik6CiAgICAgICAgIiIiUmVkaXJlY3Qgc3RkaW4vc3Rkb3V0L3N0ZGVyciBwZXJzaXN0ZW50bHkiIiIKICAgICAgICBpZiBzZWxmLl9zdHJlYW1fZ2VuZXJhdG9yOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLl9zdHJlYW1fZ2VuZXJhdG9yID0gc2VsZi5fc3Rkc3RyZWFtc19yZWRpcmVjdGlvbnNfaW5uZXIoKQogICAgICAgIG5leHQoc2VsZi5fc3RyZWFtX2dlbmVyYXRvcikgICMgdHJpZ2dlciBzdHJlYW0gcmVkaXJlY3Rpb24KICAgICAgICAjIHN0cmVhbXMgd2lsbCBiZSByZXZlcnRlZCB0byBub3JtYWwgd2hlbiBzZWxmLl9zdHJlYW1fZ2VuZXJhdG9yIGlzIGRlc3Ryb3llZC4KCiAgICBkZWYgcGVyc2lzdGVudF9yZXN0b3JlX3N0cmVhbXMoc2VsZik6CiAgICAgICAgIiIiUmVzdG9yZSBzdGRpbi9zdGRvdXQvc3RkZXJyIGlmIHRoZXkgaGF2ZSBiZWVuIHBlcnNpc3RlbnRseSByZWRpcmVjdGVkIiIiCiAgICAgICAgIyBhbGxvd2luZyBfc3RyZWFtX2dlbmVyYXRvciB0byBiZSBnYXJiYWdlIGNvbGxlY3RlZCByZXN0b3JlcyB0aGUgc3RyZWFtcwogICAgICAgIHNlbGYuX3N0cmVhbV9nZW5lcmF0b3IgPSBOb25lCgogICAgQGNvbnRleHRtYW5hZ2VyCiAgICBkZWYgcmVkaXJlY3Rfc3RyZWFtcyhzZWxmKToKICAgICAgICAiIiJBIGNvbnRleHQgbWFuYWdlciB0byByZWRpcmVjdCBzdGFuZGFyZCBzdHJlYW1zLgoKICAgICAgICBUaGlzIHN1cHBvcnRzIG5lc3RpbmcuIiIiCiAgICAgICAgeWllbGQgZnJvbSBzZWxmLl9zdGRzdHJlYW1zX3JlZGlyZWN0aW9uc19pbm5lcigpCgogICAgZGVmIF9zdGRzdHJlYW1zX3JlZGlyZWN0aW9uc19pbm5lcihzZWxmKToKICAgICAgICAiIiJUaGlzIGlzIHRoZSBnZW5lcmF0b3Igd2hpY2ggaW1wbGVtZW50cyByZWRpcmVjdF9zdHJlYW1zIGFuZCB0aGUgc3Rkc3RyZWFtc19yZWRpcmVjdGlvbnMiIiIKICAgICAgICAjIGFscmVhZHkgcmVkaXJlY3RlZD8KICAgICAgICBpZiBzZWxmLl9zdHJlYW1zX3JlZGlyZWN0ZWQ6CiAgICAgICAgICAgIHlpZWxkCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHJlZGlyZWN0cyA9IFtdCiAgICAgICAgaWYgc2VsZi5zdGRpbl9jYWxsYmFjazoKICAgICAgICAgICAgc3RkaW5fbmFtZSA9IGdldGF0dHIoc3lzLnN0ZGluLCAibmFtZSIsICI8c3RkaW4+IikKICAgICAgICAgICAgc3RkaW5fc3RyZWFtID0gX1JlYWRTdHJlYW0oc2VsZi5zdGRpbl9jYWxsYmFjaywgbmFtZT1zdGRpbl9uYW1lKQogICAgICAgICAgICByZWRpcmVjdHMuYXBwZW5kKHJlZGlyZWN0X3N0ZGluKHN0ZGluX3N0cmVhbSkpCiAgICAgICAgaWYgc2VsZi5zdGRvdXRfY2FsbGJhY2s6CiAgICAgICAgICAgIHN0ZG91dF9uYW1lID0gZ2V0YXR0cihzeXMuc3Rkb3V0LCAibmFtZSIsICI8c3Rkb3V0PiIpCiAgICAgICAgICAgIHN0ZG91dF9zdHJlYW0gPSBfV3JpdGVTdHJlYW0oc2VsZi5zdGRvdXRfY2FsbGJhY2ssIG5hbWU9c3Rkb3V0X25hbWUpCiAgICAgICAgICAgIHJlZGlyZWN0cy5hcHBlbmQocmVkaXJlY3Rfc3Rkb3V0KHN0ZG91dF9zdHJlYW0pKQogICAgICAgIGlmIHNlbGYuc3RkZXJyX2NhbGxiYWNrOgogICAgICAgICAgICBzdGRlcnJfbmFtZSA9IGdldGF0dHIoc3lzLnN0ZGVyciwgIm5hbWUiLCAiPHN0ZGVycj4iKQogICAgICAgICAgICBzdGRlcnJfc3RyZWFtID0gX1dyaXRlU3RyZWFtKHNlbGYuc3RkZXJyX2NhbGxiYWNrLCBuYW1lPXN0ZGVycl9uYW1lKQogICAgICAgICAgICByZWRpcmVjdHMuYXBwZW5kKHJlZGlyZWN0X3N0ZGVycihzdGRlcnJfc3RyZWFtKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuX3N0cmVhbXNfcmVkaXJlY3RlZCA9IFRydWUKICAgICAgICAgICAgd2l0aCBFeGl0U3RhY2soKSBhcyBzdGFjazoKICAgICAgICAgICAgICAgIGZvciByZWRpcmVjdCBpbiByZWRpcmVjdHM6CiAgICAgICAgICAgICAgICAgICAgc3RhY2suZW50ZXJfY29udGV4dChyZWRpcmVjdCkKICAgICAgICAgICAgICAgIHlpZWxkCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgc2VsZi5fc3RyZWFtc19yZWRpcmVjdGVkID0gRmFsc2UKCiAgICBkZWYgcnVuc291cmNlKHNlbGYsIHNvdXJjZTogc3RyLCBmaWxlbmFtZTogc3RyID0gIjxjb25zb2xlPiIpIC0+IENvbnNvbGVGdXR1cmU6CiAgICAgICAgIiIiQ29tcGlsZSBhbmQgcnVuIHNvdXJjZSBjb2RlIGluIHRoZSBpbnRlcnByZXRlci4KCiAgICAgICAgUmV0dXJucwogICAgICAgIC0tLS0tLS0KICAgICAgICAgICAgOmFueTpgQ29uc29sZUZ1dHVyZWAKCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb2RlID0gc2VsZi5fY29tcGlsZShzb3VyY2UsIGZpbGVuYW1lLCAic2luZ2xlIikKICAgICAgICBleGNlcHQgKE92ZXJmbG93RXJyb3IsIFN5bnRheEVycm9yLCBWYWx1ZUVycm9yKSBhcyBlOgogICAgICAgICAgICAjIENhc2UgMQogICAgICAgICAgICBpZiBlLl9fdHJhY2ViYWNrX186CiAgICAgICAgICAgICAgICB0cmFjZWJhY2suY2xlYXJfZnJhbWVzKGUuX190cmFjZWJhY2tfXykKICAgICAgICAgICAgcmVzID0gQ29uc29sZUZ1dHVyZShTWU5UQVhfRVJST1IpCiAgICAgICAgICAgIHJlcy5zZXRfZXhjZXB0aW9uKGUpCiAgICAgICAgICAgIHJlcy5mb3JtYXR0ZWRfZXJyb3IgPSBzZWxmLmZvcm1hdHN5bnRheGVycm9yKGUpCiAgICAgICAgICAgIHJldHVybiByZXMKCiAgICAgICAgaWYgY29kZSBpcyBOb25lOgogICAgICAgICAgICByZXMgPSBDb25zb2xlRnV0dXJlKElOQ09NUExFVEUpCiAgICAgICAgICAgIHJlcy5zZXRfcmVzdWx0KE5vbmUpCiAgICAgICAgICAgIHJldHVybiByZXMKCiAgICAgICAgcmVzID0gQ29uc29sZUZ1dHVyZShDT01QTEVURSkKCiAgICAgICAgZGVmIGRvbmVfY2IoZnV0KToKICAgICAgICAgICAgbm9ubG9jYWwgcmVzCiAgICAgICAgICAgIGV4YyA9IGZ1dC5leGNlcHRpb24oKQogICAgICAgICAgICBpZiBleGM6CiAgICAgICAgICAgICAgICByZXMuZm9ybWF0dGVkX2Vycm9yID0gc2VsZi5mb3JtYXR0cmFjZWJhY2soZXhjKQogICAgICAgICAgICAgICAgcmVzLnNldF9leGNlcHRpb24oZXhjKQogICAgICAgICAgICAgICAgZXhjID0gTm9uZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmVzLnNldF9yZXN1bHQoZnV0LnJlc3VsdCgpKQogICAgICAgICAgICByZXMgPSBOb25lICAjIHR5cGU6IGlnbm9yZQoKICAgICAgICBlbnN1cmVfZnV0dXJlKHNlbGYucnVuY29kZShzb3VyY2UsIGNvZGUpKS5hZGRfZG9uZV9jYWxsYmFjayhkb25lX2NiKQogICAgICAgIHJldHVybiByZXMKCiAgICBhc3luYyBkZWYgcnVuY29kZShzZWxmLCBzb3VyY2U6IHN0ciwgY29kZTogQ29kZVJ1bm5lcikgLT4gQW55OgogICAgICAgICIiIkV4ZWN1dGUgYSBjb2RlIG9iamVjdCBhbmQgcmV0dXJuIHRoZSByZXN1bHQuIiIiCiAgICAgICAgYXN5bmMgd2l0aCBzZWxmLl9sb2NrOgogICAgICAgICAgICB3aXRoIHNlbGYucmVkaXJlY3Rfc3RyZWFtcygpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBjb2RlLnJ1bl9hc3luYyhzZWxmLmdsb2JhbHMpCiAgICAgICAgICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICAgICAgICAgICAgIHN5cy5zdGRlcnIuZmx1c2goKQoKICAgIGRlZiBmb3JtYXRzeW50YXhlcnJvcihzZWxmLCBlOiBFeGNlcHRpb24pIC0+IHN0cjoKICAgICAgICAiIiJGb3JtYXQgdGhlIHN5bnRheCBlcnJvciB0aGF0IGp1c3Qgb2NjdXJyZWQuCgogICAgICAgIFRoaXMgZG9lc24ndCBpbmNsdWRlIGEgc3RhY2sgdHJhY2UgYmVjYXVzZSB0aGVyZSBpc24ndCBvbmUuIFRoZSBhY3R1YWwKICAgICAgICBlcnJvciBvYmplY3QgaXMgc3RvcmVkIGludG8gYHN5cy5sYXN0X3ZhbHVlYC4KICAgICAgICAiIiIKICAgICAgICBzeXMubGFzdF90eXBlID0gdHlwZShlKQogICAgICAgIHN5cy5sYXN0X3ZhbHVlID0gZQogICAgICAgIHN5cy5sYXN0X3RyYWNlYmFjayA9IE5vbmUKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiAiIi5qb2luKHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uX29ubHkodHlwZShlKSwgZSkpCiAgICAgICAgZmluYWxseToKICAgICAgICAgICAgZSA9IE5vbmUgICMgdHlwZTogaWdub3JlCgogICAgZGVmIG51bV9mcmFtZXNfdG9fa2VlcChzZWxmLCB0Yik6CiAgICAgICAga2VlcF9mcmFtZXMgPSBGYWxzZQogICAgICAgIGtlcHRfZnJhbWVzID0gMAogICAgICAgICMgVHJ5IHRvIHRyaW0gb3V0IHN0YWNrIGZyYW1lcyBpbnNpZGUgb3VyIGNvZGUKICAgICAgICBmb3IgKGZyYW1lLCBfKSBpbiB0cmFjZWJhY2sud2Fsa190Yih0Yik6CiAgICAgICAgICAgIGtlZXBfZnJhbWVzID0ga2VlcF9mcmFtZXMgb3IgZnJhbWUuZl9jb2RlLmNvX2ZpbGVuYW1lID09ICI8Y29uc29sZT4iCiAgICAgICAgICAgIGtlZXBfZnJhbWVzID0ga2VlcF9mcmFtZXMgb3IgZnJhbWUuZl9jb2RlLmNvX2ZpbGVuYW1lID09ICI8ZXhlYz4iCiAgICAgICAgICAgIGlmIGtlZXBfZnJhbWVzOgogICAgICAgICAgICAgICAga2VwdF9mcmFtZXMgKz0gMQogICAgICAgIHJldHVybiBrZXB0X2ZyYW1lcwoKICAgIGRlZiBmb3JtYXR0cmFjZWJhY2soc2VsZiwgZTogRXhjZXB0aW9uKSAtPiBzdHI6CiAgICAgICAgIiIiRm9ybWF0IHRoZSBleGNlcHRpb24gdGhhdCBqdXN0IG9jY3VycmVkLgoKICAgICAgICBUaGUgYWN0dWFsIGVycm9yIG9iamVjdCBpcyBzdG9yZWQgaW50byBgc3lzLmxhc3RfdmFsdWVgLgogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgc3lzLmxhc3RfdHlwZSA9IHR5cGUoZSkKICAgICAgICAgICAgc3lzLmxhc3RfdmFsdWUgPSBlCiAgICAgICAgICAgIHN5cy5sYXN0X3RyYWNlYmFjayA9IGUuX190cmFjZWJhY2tfXwogICAgICAgICAgICBuZnJhbWVzID0gc2VsZi5udW1fZnJhbWVzX3RvX2tlZXAoZS5fX3RyYWNlYmFja19fKQogICAgICAgICAgICByZXR1cm4gIiIuam9pbigKICAgICAgICAgICAgICAgIHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uKHR5cGUoZSksIGUsIGUuX190cmFjZWJhY2tfXywgLW5mcmFtZXMpCiAgICAgICAgICAgICkKICAgICAgICBmaW5hbGx5OgogICAgICAgICAgICBlID0gTm9uZSAgIyB0eXBlOiBpZ25vcmUKCiAgICBkZWYgcHVzaChzZWxmLCBsaW5lOiBzdHIpIC0+IENvbnNvbGVGdXR1cmU6CiAgICAgICAgIiIiUHVzaCBhIGxpbmUgdG8gdGhlIGludGVycHJldGVyLgoKICAgICAgICBUaGUgbGluZSBzaG91bGQgbm90IGhhdmUgYSB0cmFpbGluZyBuZXdsaW5lOyBpdCBtYXkgaGF2ZSBpbnRlcm5hbAogICAgICAgIG5ld2xpbmVzLiAgVGhlIGxpbmUgaXMgYXBwZW5kZWQgdG8gYSBidWZmZXIgYW5kIHRoZSBpbnRlcnByZXRlcidzCiAgICAgICAgcnVuc291cmNlKCkgbWV0aG9kIGlzIGNhbGxlZCB3aXRoIHRoZSBjb25jYXRlbmF0ZWQgY29udGVudHMgb2YgdGhlCiAgICAgICAgYnVmZmVyIGFzIHNvdXJjZS4gIElmIHRoaXMgaW5kaWNhdGVzIHRoYXQgdGhlIGNvbW1hbmQgd2FzIGV4ZWN1dGVkIG9yCiAgICAgICAgaW52YWxpZCwgdGhlIGJ1ZmZlciBpcyByZXNldDsgb3RoZXJ3aXNlLCB0aGUgY29tbWFuZCBpcyBpbmNvbXBsZXRlLCBhbmQKICAgICAgICB0aGUgYnVmZmVyIGlzIGxlZnQgYXMgaXQgd2FzIGFmdGVyIHRoZSBsaW5lIHdhcyBhcHBlbmRlZC4KCiAgICAgICAgVGhlIHJldHVybiB2YWx1ZSBpcyB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgOmFueTpgQ29uc29sZS5ydW5zb3VyY2VgIG9uIHRoZSBjdXJyZW50IGJ1ZmZlcgogICAgICAgIGNvbnRlbnRzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYnVmZmVyLmFwcGVuZChsaW5lKQogICAgICAgIHNvdXJjZSA9ICJcbiIuam9pbihzZWxmLmJ1ZmZlcikKICAgICAgICByZXN1bHQgPSBzZWxmLnJ1bnNvdXJjZShzb3VyY2UsIHNlbGYuZmlsZW5hbWUpCiAgICAgICAgaWYgcmVzdWx0LnN5bnRheF9jaGVjayAhPSBJTkNPTVBMRVRFOgogICAgICAgICAgICBzZWxmLmJ1ZmZlciA9IFtdCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBjb21wbGV0ZShzZWxmLCBzb3VyY2U6IHN0cikgLT4gVHVwbGVbTGlzdFtzdHJdLCBpbnRdOgogICAgICAgICIiIlVzZSBQeXRob24ncyBybGNvbXBsZXRlciB0byBjb21wbGV0ZSB0aGUgc291cmNlIHN0cmluZyB1c2luZyB0aGUgOmFueTpgZ2xvYmFscyA8Q29uc29sZS5nbG9iYWxzPmAgbmFtZXNwYWNlLgoKICAgICAgICBGaW5kcyBsYXN0ICJ3b3JkIiBpbiB0aGUgc291cmNlIHN0cmluZyBhbmQgY29tcGxldGVzIGl0IHdpdGggcmxjb21wbGV0ZXIuIFdvcmQKICAgICAgICBicmVha3MgYXJlIGRldGVybWluZWQgYnkgdGhlIHNldCBvZiBjaGFyYWN0ZXJzIGluCiAgICAgICAgOmFueTpgY29tcGxldGVyX3dvcmRfYnJlYWtfY2hhcmFjdGVycyA8Q29uc29sZS5jb21wbGV0ZXJfd29yZF9icmVha19jaGFyYWN0ZXJzPmAuCgogICAgICAgIFBhcmFtZXRlcnMKICAgICAgICAtLS0tLS0tLS0tCiAgICAgICAgc291cmNlIDogc3RyCiAgICAgICAgICAgIFRoZSBzb3VyY2Ugc3RyaW5nIHRvIGNvbXBsZXRlIGF0IHRoZSBlbmQuCgogICAgICAgIFJldHVybnMKICAgICAgICAtLS0tLS0tCiAgICAgICAgY29tcGxldGlvbnMgOiBMaXN0W3N0cl0KICAgICAgICAgICAgQSBsaXN0IG9mIGNvbXBsZXRpb24gc3RyaW5ncy4KICAgICAgICBzdGFydCA6IGludAogICAgICAgICAgICBUaGUgaW5kZXggd2hlcmUgY29tcGxldGlvbiBzdGFydHMuCgogICAgICAgIEV4YW1wbGVzCiAgICAgICAgLS0tLS0tLS0KICAgICAgICA+Pj4gc2hlbGwgPSBDb25zb2xlKCkKICAgICAgICA+Pj4gc2hlbGwuY29tcGxldGUoInN0ci5pc2EiKQogICAgICAgIChbJ3N0ci5pc2FsbnVtKCcsICdzdHIuaXNhbHBoYSgnLCAnc3RyLmlzYXNjaWkoJ10sIDApCiAgICAgICAgPj4+IHNoZWxsLmNvbXBsZXRlKCJhID0gNSA7IHN0ci5pc2EiKQogICAgICAgIChbJ3N0ci5pc2FsbnVtKCcsICdzdHIuaXNhbHBoYSgnLCAnc3RyLmlzYXNjaWkoJ10sIDgpCiAgICAgICAgIiIiCiAgICAgICAgc3RhcnQgPSBtYXgobWFwKHNvdXJjZS5yZmluZCwgc2VsZi5jb21wbGV0ZXJfd29yZF9icmVha19jaGFyYWN0ZXJzKSkgKyAxCiAgICAgICAgc291cmNlID0gc291cmNlW3N0YXJ0Ol0KICAgICAgICBpZiAiLiIgaW4gc291cmNlOgogICAgICAgICAgICBjb21wbGV0aW9ucyA9IHNlbGYuX2NvbXBsZXRlci5hdHRyX21hdGNoZXMoc291cmNlKSAgIyB0eXBlOiBpZ25vcmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb21wbGV0aW9ucyA9IHNlbGYuX2NvbXBsZXRlci5nbG9iYWxfbWF0Y2hlcyhzb3VyY2UpICAjIHR5cGU6IGlnbm9yZQogICAgICAgIHJldHVybiBjb21wbGV0aW9ucywgc3RhcnQKCgpkZWYgcmVwcl9zaG9ydGVuKAogICAgdmFsdWU6IEFueSwgbGltaXQ6IGludCA9IDEwMDAsIHNwbGl0OiBPcHRpb25hbFtpbnRdID0gTm9uZSwgc2VwYXJhdG9yOiBzdHIgPSAiLi4uIgopIC0+IHN0cjoKICAgICIiIkNvbXB1dGUgdGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBgYHZhbHVlYGAgYW5kIHNob3J0ZW4gaXQKICAgIGlmIG5lY2Vzc2FyeS4KCiAgICBJZiBpdCBpcyBsb25nZXIgdGhhbiBgYGxpbWl0YGAgdGhlbiByZXR1cm4gdGhlIGZpcnN0cyBgYHNwbGl0YGAKICAgIGNoYXJhY3RlcnMgYW5kIHRoZSBsYXN0IGBgc3BsaXRgYCBjaGFyYWN0ZXJzIHNlcGVyYXRlZCBieSAnLi4uJy4KICAgIERlZmF1bHQgdmFsdWUgZm9yIGBgc3BsaXRgYCBpcyBgbGltaXQgLy8gMmAuCiAgICAiIiIKICAgIGlmIHNwbGl0IGlzIE5vbmU6CiAgICAgICAgc3BsaXQgPSBsaW1pdCAvLyAyCiAgICB0ZXh0ID0gcmVwcih2YWx1ZSkKICAgIGlmIGxlbih0ZXh0KSA+IGxpbWl0OgogICAgICAgIHRleHQgPSBmInt0ZXh0WzpzcGxpdF19e3NlcGFyYXRvcn17dGV4dFstc3BsaXQ6XX0iCiAgICByZXR1cm4gdGV4dAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABfcHlvZGlkZS9kb2NzdHJpbmcucHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDAwMDY0NAAwMDAwMDAwADAwMDAwMDAAMDAwMDAwMDMxNTYAMTQyMDUxNjY3NTAAMDEzNzMxACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAByb290AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGZyb20gdGV4dHdyYXAgaW1wb3J0IGRlZGVudAoKCmRlZiBkZWRlbnRfZG9jc3RyaW5nKGRvY3N0cmluZyk6CiAgICAiIiJUaGlzIHJlbW92ZXMgaW5pdGlhbCBzcGFjZXMgZnJvbSB0aGUgbGluZXMgb2YgdGhlIGRvY3N0cmluZy4KCiAgICBBZnRlciB0aGUgZmlyc3QgbGluZSBvZiB0aGUgZG9jc3RyaW5nLCBhbGwgb3RoZXIgbGluZXMgd2lsbCBpbmNsdWRlIHNvbWUKICAgIHNwYWNlcy4gVGhpcyByZW1vdmVzIHRoZW0uCgogICAgRXhhbXBsZXMKICAgIC0tLS0tLS0tCiAgICA+Pj4gZnJvbSBfcHlvZGlkZS5kb2NzdHJpbmcgaW1wb3J0IGRlZGVudF9kb2NzdHJpbmcKICAgID4+PiBkZWRlbnRfZG9jc3RyaW5nKGRlZGVudF9kb2NzdHJpbmcuX19kb2NfXykuc3BsaXQoIlxcbiIpWzJdCiAgICAnQWZ0ZXIgdGhlIGZpcnN0IGxpbmUgb2YgdGhlIGRvY3N0cmluZywgYWxsIG90aGVyIGxpbmVzIHdpbGwgaW5jbHVkZSBzb21lJwogICAgIiIiCiAgICBmaXJzdF9uZXdsaW5lID0gZG9jc3RyaW5nLmZpbmQoIlxuIikKICAgIGlmIGZpcnN0X25ld2xpbmUgPT0gLTE6CiAgICAgICAgcmV0dXJuIGRvY3N0cmluZwogICAgZG9jc3RyaW5nID0gZG9jc3RyaW5nWzpmaXJzdF9uZXdsaW5lXSArIGRlZGVudChkb2NzdHJpbmdbZmlyc3RfbmV3bGluZTpdKQogICAgcmV0dXJuIGRvY3N0cmluZwoKCmRlZiBnZXRfY21ldGhfZG9jc3RyaW5nKGZ1bmMpOgogICAgIiIiR2V0IHRoZSB2YWx1ZSB0byB1c2UgZm9yIHRoZSBQeU1ldGhvZERlZi5tbF9kb2MgYXR0cmlidXRlIGZvciBhIGJ1aWx0aW4KICAgIGZ1bmN0aW9uLiBUaGlzIGlzIHVzZWQgaW4gZG9jc3RyaW5nLmMuCgogICAgVGhlIG1sX2RvYyBzaG91bGQgc3RhcnQgd2l0aCBhIHNpZ25hdHVyZSB3aGljaCBjYW5ub3QgaGF2ZSBhbnkgdHlwZQogICAgYW5ub3RhdGlvbnMuIFRoZSBzaWduYXR1cmUgbXVzdCBlbmQgd2l0aCB0aGUgZXhhY3QgY2hhcmFjdGVycyAiKVxuLS1cblxuIi4KICAgIEZvciBleGFtcGxlOiAiZnVuY25hbWUoYXJnMSwgYXJnMilcbi0tXG5cbiIKCiAgICBTZWU6CiAgICBodHRwczovL2dpdGh1Yi5jb20vcHl0aG9uL2NweXRob24vYmxvYi92My44LjIvT2JqZWN0cy90eXBlb2JqZWN0LmMjTDg0CgogICAgRXhhbXBsZXMKICAgIC0tLS0tLS0tCiAgICA+Pj4gZnJvbSBfcHlvZGlkZS5kb2NzdHJpbmcgaW1wb3J0IGdldF9jbWV0aF9kb2NzdHJpbmcKICAgID4+PiBnZXRfY21ldGhfZG9jc3RyaW5nKHN1bSlbOjgwXQogICAgInN1bShpdGVyYWJsZSwgLywgc3RhcnQ9MClcXG4tLVxcblxcblJldHVybiB0aGUgc3VtIG9mIGEgJ3N0YXJ0JyB2YWx1ZSAoZGVmYXVsdDogMCkgcGx1IgogICAgIiIiCiAgICBmcm9tIGluc3BlY3QgaW1wb3J0IHNpZ25hdHVyZSwgX2VtcHR5CgogICAgc2lnID0gc2lnbmF0dXJlKGZ1bmMpCiAgICAjIHJlbW92ZSBwYXJhbSBhbmQgcmV0dXJuIGFubm90YXRpb25zIGFuZAogICAgZm9yIHBhcmFtIGluIHNpZy5wYXJhbWV0ZXJzLnZhbHVlcygpOgogICAgICAgIHBhcmFtLl9hbm5vdGF0aW9uID0gX2VtcHR5CiAgICBzaWcuX3JldHVybl9hbm5vdGF0aW9uID0gX2VtcHR5CgogICAgcmV0dXJuIGZ1bmMuX19uYW1lX18gKyBzdHIoc2lnKSArICJcbi0tXG5cbiIgKyBkZWRlbnRfZG9jc3RyaW5nKGZ1bmMuX19kb2NfXykKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=='),c=>c.charCodeAt(0));
